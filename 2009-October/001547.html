<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 95dd57d2907a442b9dfe51ffae681ce8d33abae5
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2009-October/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%2095dd57d2907a442b9dfe51ffae681ce8d33abae5&In-Reply-To=%3C200910270830.n9R8UC2T006442%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001548.html">
   <LINK REL="Next"  HREF="001549.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 95dd57d2907a442b9dfe51ffae681ce8d33abae5</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%2095dd57d2907a442b9dfe51ffae681ce8d33abae5&In-Reply-To=%3C200910270830.n9R8UC2T006442%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 95dd57d2907a442b9dfe51ffae681ce8d33abae5">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Tue Oct 27 09:30:12 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001548.html">[Kiwi-devel] Patch for example demonstrating the use of GNOME
</A></li>
        <LI>Next message: <A HREF="001549.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. a3d6672821fa2401cd57b29a8e2a4522f20b71f4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1547">[ date ]</a>
              <a href="thread.html#1547">[ thread ]</a>
              <a href="subject.html#1547">[ subject ]</a>
              <a href="author.html#1547">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  95dd57d2907a442b9dfe51ffae681ce8d33abae5 (commit)
       via  bf0250f11ec92f376fa7084ac8837f9bd26a2246 (commit)
       via  563a6d370709e87b50b4dc27d08d054be5a51f61 (commit)
       via  6130a366ff1f78dd7b1372c4861931d1dad3fead (commit)
       via  de3ec6cbc7a453c7ff3487fa815812a7128b1e41 (commit)
       via  09c92823568a1ea7bb73fe44025de74112dc1fe3 (commit)
       via  bfd0429f1cfb88b4e40ee6179160092602a3dad4 (commit)
       via  993ad21dbc1b23b1a77b9ff93eb8fb6db029fd25 (commit)
       via  13851707e0c586c11a75443cc7ac5e38d72589ff (commit)
      from  957d004939ce80af596b1d4bdb0e8bb9385b86d0 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 95dd57d2907a442b9dfe51ffae681ce8d33abae5
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Tue Oct 27 09:29:56 2009 +0100

    - kiwi-instsource changes done by <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at novell.com</A>
      * fixed logging
      * fixed several uninitialized variables
      * fixed debuginfo handling

commit bf0250f11ec92f376fa7084ac8837f9bd26a2246
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 21:18:07 2009 +0100

    add all debuginfo packages

commit 563a6d370709e87b50b4dc27d08d054be5a51f61
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 20:59:08 2009 +0100

    little cleanup

commit 6130a366ff1f78dd7b1372c4861931d1dad3fead
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 14:39:33 2009 +0100

    have defaults for product variables

commit de3ec6cbc7a453c7ff3487fa815812a7128b1e41
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 13:58:57 2009 +0100

    more fixes for logging

commit 09c92823568a1ea7bb73fe44025de74112dc1fe3
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 13:53:16 2009 +0100

    one less unintialized variable

commit bfd0429f1cfb88b4e40ee6179160092602a3dad4
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 13:49:08 2009 +0100

    more cleanup in the logging of products

commit 993ad21dbc1b23b1a77b9ff93eb8fb6db029fd25
Merge: 13851707e0c586c11a75443cc7ac5e38d72589ff 957d004939ce80af596b1d4bdb0e8bb9385b86d0
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 13:31:53 2009 +0100

    Merge branch 'master' into collect

commit 13851707e0c586c11a75443cc7ac5e38d72589ff
Author: Stephan Kulow &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at suse.de</A>&gt;
Date:   Mon Oct 26 13:30:57 2009 +0100

    trying to fix logging

-----------------------------------------------------------------------

Summary of changes:
diff --git a/modules/KIWICollect.pm b/modules/KIWICollect.pm
index ba0d5ff..f8bc67b 100644
--- a/modules/KIWICollect.pm
+++ b/modules/KIWICollect.pm
@@ -47,7 +47,7 @@ use Data::Dumper;
 #==========================================
 # Members
 #------------------------------------------
-# m_kiwi:
+# m_logger:
 #   Instance of KIWILog for feedback
 # m_xml:
 #   Instance of KIWIXML for retrieving the data contained
@@ -94,7 +94,7 @@ sub new {
     m_repos	    =&gt; undef,
     m_xml	    =&gt; undef,
     m_util	    =&gt; undef,
-    m_kiwi	    =&gt; undef,
+    m_logger        =&gt; undef,
     m_packagePool   =&gt; undef,
     m_repoPacks	    =&gt; undef,
     m_sourcePacks   =&gt; undef,
@@ -102,9 +102,8 @@ sub new {
     m_metaPacks     =&gt; undef,
     m_metafiles	    =&gt; undef,
     m_browser	    =&gt; undef,
-    m_logger	    =&gt; undef,
-    m_srcmedium	    =&gt; undef,
-    m_debugmedium   =&gt; undef,
+    m_srcmedium	    =&gt; -1,
+    m_debugmedium   =&gt; -1,
     m_logStdOut     =&gt; undef,
     m_startUpTime   =&gt; undef,
     m_fpacks	    =&gt; [],
@@ -120,14 +119,14 @@ sub new {
   #==========================================
   # Module Parameters
   #------------------------------------------
-  $this-&gt;{m_kiwi}     = shift;
+  $this-&gt;{m_logger}   = shift;
   $this-&gt;{m_xml}      = shift;
   $this-&gt;{m_basedir}  = shift;
   $this-&gt;{m_debug}    = shift || 0;
 
   if( !(defined($this-&gt;{m_xml})
 	and defined($this-&gt;{m_basedir})
-	and defined($this-&gt;{m_kiwi})))
+	and defined($this-&gt;{m_logger})))
   {
     return undef;
   }
@@ -144,19 +143,14 @@ sub new {
   
   # create second logger object to log only the data relevant
   # for repository creation:
-  $this-&gt;{m_logger} = new KIWILog(&quot;tiny&quot;);
-  $this-&gt;{m_logger}-&gt;setLogHumanReadable();
-  $this-&gt;{m_logger}-&gt;setLogFile(&quot;$this-&gt;{m_basedir}/collect.log&quot;);
-  $this-&gt;{m_kiwi}-&gt;info(&quot;Logging repository specific data to file $this-&gt;{m_basedir}/collect.log&quot;);
 
-  $this-&gt;{m_util} = new KIWIUtil($this-&gt;{m_logger});
+  $this-&gt;{m_util} = new KIWIUtil($this);
   if(!$this-&gt;{m_util}) {
     $this-&gt;logMsg(&quot;E&quot;, &quot;Can't create KIWIUtil object!&quot;);
     return undef;
   }
   else {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;Created new KIWIUtil object&quot;);
-    $this-&gt;{m_kiwi}-&gt;info(&quot;[I] Created new KIWIUtil object\n&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;Created new KIWIUtil object&quot;);
   }
 
   $this-&gt;{m_urlparser} = new KIWIURL($this-&gt;{m_logger});
@@ -165,8 +159,7 @@ sub new {
     return undef;
   }
   else {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;Created new KIWIURL object&quot;);
-    $this-&gt;{m_kiwi}-&gt;info(&quot;[I] Created new KIWIURL object\n&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;Created new KIWIURL object&quot;);
   }
 
 
@@ -178,8 +171,7 @@ sub new {
     return undef;
   }
   else {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;Created new KIWIProductData object&quot;);
-    $this-&gt;{m_kiwi}-&gt;info(&quot;[I] Created new KIWIProductData object\n&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;Created new KIWIProductData object&quot;);
   }
 
   $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect2 object initialisation finished&quot;);
@@ -203,53 +195,20 @@ sub logMsg
   if ($this-&gt;{m_logStdOut} == 1) {
     # significant speed up in production mode
     print $out;
-    exit 1 if ( $mode == &quot;E&quot; );
+    exit 1 if ( $mode eq &quot;E&quot; );
   } else {
-    if ( $mode == &quot;E&quot; ) {
-      $this-&gt;{m_kiwi}-&gt;error($out);
-    }elsif ( $mode == &quot;W&quot; ) {
-      $this-&gt;{m_kiwi}-&gt;warn($out);
-    }elsif ( $mode == &quot;I&quot; ) {
-      $this-&gt;{m_kiwi}-&gt;info($out);
-    }else{
-      $this-&gt;{m_kiwi}-&gt;info($out);
+    if ( $mode eq &quot;E&quot; ) {
+      $this-&gt;{m_logger}-&gt;error($out);
+    }elsif ( $mode eq &quot;W&quot; ) {
+      $this-&gt;{m_logger}-&gt;warn($out);
+    }elsif ( $mode eq &quot;I&quot; ) {
+      $this-&gt;{m_logger}-&gt;info($out);
+    }elsif ($this-&gt;{m_debug}){
+      $this-&gt;{m_logger}-&gt;info($out);
     }
   }
 }
 
-#=================
-# access methods:
-#-----------------
-sub logger
-{
-  my $this = shift;
-  if(not ref($this)) {
-    return undef;
-  }
-  my $oldlog = $this-&gt;{m_logger};
-  if(@_) {
-    $this-&gt;{m_logger} = shift;
-  }
-  return $oldlog;
-}
-
-
-
-sub debugflag
-{
-  my $this = shift;
-  if(not ref($this)) {
-    return undef;
-  }
-  my $olddeb = $this-&gt;{m_debug};
-  if(@_) {
-    $this-&gt;{m_debug} = shift;
-  }
-  return $olddeb;
-}
-
-
-
 sub unitedDir
 {
   my $this = shift;
@@ -263,8 +222,6 @@ sub unitedDir
   return $oldunited;
 }
 
-
-
 sub archlist
 {
   my $this = shift;
@@ -335,12 +292,12 @@ sub Init
 
   # retrieve data from xml file:
   ## packages list (regular packages)
-  $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: querying instsource package list&quot;);
+  $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: querying instsource package list&quot;);
   %{$this-&gt;{m_repoPacks}}      = $this-&gt;{m_xml}-&gt;getInstSourcePackageList();
   # this list may be empty!
-  $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: queried package list.&quot;);
+  $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: queried package list.&quot;);
   if($this-&gt;{m_debug}) {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;See packages.dump.pl&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;See packages.dump.pl&quot;);
     open(DUMP, &quot;&gt;&quot;, &quot;$this-&gt;{m_basedir}/packages.dump.pl&quot;);
     print DUMP Dumper($this-&gt;{m_repoPacks});
     close(DUMP);
@@ -348,18 +305,18 @@ sub Init
 
   ## architectures information (hash with name|desrc|next, next may be 0 which means &quot;no fallback&quot;)
   # this element is mandatory. Empty = Error
-  $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: querying instsource architecture list&quot;);
+  $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: querying instsource architecture list&quot;);
   $this-&gt;{m_archlist} = new KIWIArchList($this);
   my $archadd = $this-&gt;{m_archlist}-&gt;addArchs( { $this-&gt;{m_xml}-&gt;getInstSourceArchList() } );
   if(not defined($archadd)) {
-    $this-&gt;{m_kiwi}-&gt;error(&quot;KIWICollect::Init: addArchs returned undef&quot;);
-    $this-&gt;{m_kiwi}-&gt;info( Dumper($this-&gt;{m_xml}-&gt;getInstSourceArchList()));
+    $this-&gt;logMsg(&quot;I&quot;, Dumper($this-&gt;{m_xml}-&gt;getInstSourceArchList()));
+    $this-&gt;logMsg(&quot;E&quot;, &quot;KIWICollect::Init: addArchs returned undef&quot;);
     return undef;
   }
   else {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: queried archlist.&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: queried archlist.&quot;);
     if($this-&gt;{m_debug}) {
-      $this-&gt;{m_kiwi}-&gt;info(&quot;See archlist.dump.pl&quot;);
+      $this-&gt;logMsg(&quot;I&quot;, &quot;See archlist.dump.pl&quot;);
       open(DUMP, &quot;&gt;&quot;, &quot;$this-&gt;{m_basedir}/archlist.dump.pl&quot;);
       print DUMP $this-&gt;{m_archlist}-&gt;dumpList();
       close(DUMP);
@@ -373,13 +330,13 @@ sub Init
   # mandatory. Missing = Error
   %{$this-&gt;{m_repos}}	      = $this-&gt;{m_xml}-&gt;getInstSourceRepository();
   if(!$this-&gt;{m_repos}) {
-    $this-&gt;{m_kiwi}-&gt;error(&quot;KIWICollect::Init: getInstSourceRepository returned empty hash&quot;);
+    $this-&gt;logMsg(&quot;E&quot;, &quot;KIWICollect::Init: getInstSourceRepository returned empty hash&quot;);
     return undef;
   }
   else {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: retrieved repository list.&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: retrieved repository list.&quot;);
     if($this-&gt;{m_debug}) {
-      $this-&gt;{m_kiwi}-&gt;info(&quot;See repos.dump.pl&quot;);
+      $this-&gt;logMsg(&quot;I&quot;, &quot;See repos.dump.pl&quot;);
       open(DUMP, &quot;&gt;&quot;, &quot;$this-&gt;{m_basedir}/repos.dump.pl&quot;);
       print DUMP Dumper($this-&gt;{m_repos});
       close(DUMP);
@@ -390,13 +347,13 @@ sub Init
   # mandatory. Empty = Error
   %{$this-&gt;{m_metaPacks}}  = $this-&gt;{m_xml}-&gt;getInstSourceMetaPackageList();
   if(!$this-&gt;{m_metaPacks}) {
-    $this-&gt;{m_kiwi}-&gt;error(&quot;KIWICollect::Init: getInstSourceMetaPackageList returned empty hash&quot;);
+    $this-&gt;logMsg(&quot;E&quot;, &quot;KIWICollect::Init: getInstSourceMetaPackageList returned empty hash&quot;);
     return undef;
   }
   else {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: retrieved metapackage list.&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: retrieved metapackage list.&quot;);
     if($this-&gt;{m_debug}) {
-      $this-&gt;{m_kiwi}-&gt;info(&quot;See metaPacks.dump.pl&quot;);
+      $this-&gt;logMsg(&quot;I&quot;, &quot;See metaPacks.dump.pl&quot;);
       open(DUMP, &quot;&gt;&quot;, &quot;$this-&gt;{m_basedir}/metaPacks.dump.pl&quot;);
       print DUMP Dumper($this-&gt;{m_metaPacks});
       close(DUMP);
@@ -407,12 +364,12 @@ sub Init
   # may be omitted
   %{$this-&gt;{m_metafiles}}     = $this-&gt;{m_xml}-&gt;getInstSourceMetaFiles();
   if(!$this-&gt;{m_metaPacks}) {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: getInstSourceMetaPackageList returned empty hash, no metafiles specified.&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: getInstSourceMetaPackageList returned empty hash, no metafiles specified.&quot;);
   }
   else {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: retrieved metafile list.&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: retrieved metafile list.&quot;);
     if($this-&gt;{m_debug}) {
-      $this-&gt;{m_kiwi}-&gt;info(&quot;See metafiles.dump.pl&quot;);
+      $this-&gt;logMsg(&quot;I&quot;, &quot;See metafiles.dump.pl&quot;);
       open(DUMP, &quot;&gt;&quot;, &quot;$this-&gt;{m_basedir}/metafiles.dump.pl&quot;);
       print DUMP Dumper($this-&gt;{m_metafiles});
       close(DUMP);
@@ -423,12 +380,12 @@ sub Init
   # may be empty
   @{$this-&gt;{m_chroot}}	      = $this-&gt;{m_xml}-&gt;getInstSourceChrootList();
   if(!$this-&gt;{m_chroot}) {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: chroot list is empty hash, no chroot requirements specified&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: chroot list is empty hash, no chroot requirements specified&quot;);
   }
   else {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: retrieved chroot list.&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: retrieved chroot list.&quot;);
     if($this-&gt;{m_debug}) {
-      $this-&gt;{m_kiwi}-&gt;info(&quot;See chroot.dump.pl&quot;);
+      $this-&gt;logMsg(&quot;I&quot;, &quot;See chroot.dump.pl&quot;);
       open(DUMP, &quot;&gt;&quot;, &quot;$this-&gt;{m_basedir}/chroot.dump.pl&quot;);
       print DUMP Dumper($this-&gt;{m_chroot});
       close(DUMP);
@@ -440,7 +397,7 @@ sub Init
   $vadded = $this-&gt;{m_proddata}-&gt;addSet(&quot;ProductVar stuff&quot;, {$this-&gt;{m_xml}-&gt;getInstSourceProductVar()}, &quot;prodvars&quot;);
   $oadded = $this-&gt;{m_proddata}-&gt;addSet(&quot;ProductOption stuff&quot;, {$this-&gt;{m_xml}-&gt;getInstSourceProductOption()}, &quot;prodopts&quot;);
   if(not defined($iadded) or not defined($vadded) or not defined($oadded)) {
-    $this-&gt;{m_kiwi}-&gt;error(&quot;KIWICollect::Init: something wrong in the productoptions section&quot;); 
+    $this-&gt;logMsg(&quot;E&quot;, &quot;KIWICollect::Init: something wrong in the productoptions section&quot;); 
     return undef;
   }
   $this-&gt;{m_proddata}-&gt;_expand(); #once should be it, now--
@@ -458,8 +415,8 @@ sub Init
 
   ## Set possible defined source or debugmediums
   #
-  $this-&gt;{m_srcmedium}   = $this-&gt;{m_proddata}-&gt;getOpt(&quot;SOURCEMEDIUM&quot;);
-  $this-&gt;{m_debugmedium} = $this-&gt;{m_proddata}-&gt;getOpt(&quot;DEBUGMEDIUM&quot;);
+  $this-&gt;{m_srcmedium}   = $this-&gt;{m_proddata}-&gt;getOpt(&quot;SOURCEMEDIUM&quot;) || -1;
+  $this-&gt;{m_debugmedium} = $this-&gt;{m_proddata}-&gt;getOpt(&quot;DEBUGMEDIUM&quot;) || -1;
 
   $this-&gt;{m_united} = &quot;$this-&gt;{m_basedir}/main&quot;;
   $this-&gt;{m_dirlist}-&gt;{&quot;$this-&gt;{m_united}&quot;} = 1;
@@ -476,7 +433,7 @@ sub Init
 
 
   my @media = $this-&gt;getMediaNumbers();
-  my $mult = $this-&gt;{m_proddata}-&gt;getVar(&quot;MULTIPLE_MEDIA&quot;);
+  my $mult = $this-&gt;{m_proddata}-&gt;getVar(&quot;MULTIPLE_MEDIA&quot;, &quot;yes&quot;);
   my $dirext = undef;
   if($mult eq &quot;no&quot;) {
     if(scalar(@media) == 1) { 
@@ -525,23 +482,23 @@ sub Init
   
   my $dircreate = $this-&gt;createDirectoryStructure();
   if($dircreate != 0) {
-    $this-&gt;{m_kiwi}-&gt;error(&quot;KIWICollect::Init: calling createDirectoryStructure failed&quot;);
+    $this-&gt;logMsg(&quot;E&quot;, &quot;KIWICollect::Init: calling createDirectoryStructure failed&quot;);
     return undef;
   }
 
   # for debugging:
   if($this-&gt;{m_debug}) {
-    $this-&gt;{m_kiwi}-&gt;info(&quot;Debug: dumping packages list to &lt;packagelist.txt&gt;&quot;);
+    $this-&gt;logMsg(&quot;I&quot;, &quot;Debug: dumping packages list to &lt;packagelist.txt&gt;&quot;);
     $this-&gt;dumpPackageList(&quot;$this-&gt;{m_basedir}/packagelist.txt&quot;);
   }
 
-  $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: create LWP module&quot;);
+  $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: create LWP module&quot;);
   $this-&gt;{m_browser} = new LWP::UserAgent;
 
   ## create the metadata handler and load (+verify) all available plugins:
   # the required variables are MEDIUM_NAME, PLUGIN_DIR, INI_DIR
   # should be set by now.
-  $this-&gt;{m_kiwi}-&gt;info(&quot;KIWICollect::Init: create KIWIRepoMetaHandler module&quot;);
+  $this-&gt;logMsg(&quot;I&quot;, &quot;KIWICollect::Init: create KIWIRepoMetaHandler module&quot;);
   $this-&gt;{m_metacreator} = new KIWIRepoMetaHandler($this);
   $this-&gt;{m_metacreator}-&gt;baseurl($this-&gt;{m_united});
   $this-&gt;{m_metacreator}-&gt;mediaName($this-&gt;{m_proddata}-&gt;getVar('MEDIUM_NAME'));
@@ -635,16 +592,16 @@ sub mainTask
   $this-&gt;createMetadata();
 
   ## We create iso files by default, but keep this for manual override
-  if(!$ENV{'KIWI_NO_ISO'}) {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;Skipping ISO generation&quot;);
+  if(defined $ENV{'KIWI_NO_ISO'}) {
+    $this-&gt;logMsg(&quot;W&quot;, &quot;Skipping ISO generation because of \$KIWI_NO_ISO&quot;);
     return 0;
   }
   if($this-&gt;{m_proddata}-&gt;getVar(&quot;FLAVOR&quot;) eq &quot;ftp&quot;) {
     $this-&gt;logMsg(&quot;I&quot;, &quot;Skipping ISO generation for FLAVOR ftp&quot;);
     return 0;
   }
-  if($this-&gt;{m_proddata}-&gt;getVar(&quot;REPO_ONLY&quot;) eq &quot;1&quot;) {
-    $this-&gt;logMsg(&quot;I&quot;, &quot;Skipping ISO generation&quot;);
+  if($this-&gt;{m_proddata}-&gt;getVar(&quot;REPO_ONLY&quot;, &quot;0&quot;) eq &quot;1&quot;) {
+    $this-&gt;logMsg(&quot;I&quot;, &quot;Skipping ISO generation because of repo_only&quot;);
     return 0;
   }
 
@@ -663,7 +620,7 @@ sub mainTask
       my $attr = &quot;-R -J -f -pad -joliet-long&quot;;
       $cdname =~ s{.*/(.*)/*$}{$1};
       my $checkmedia;
-      $checkmedia = &quot;checkmedia&quot; if ( defined($this-&gt;{m_proddata}-&gt;getVar(&quot;RUN_MEDIA_CHECK&quot;)) and $this-&gt;{m_proddata}-&gt;getVar(&quot;RUN_MEDIA_CHECK&quot;) != &quot;0&quot; );
+      $checkmedia = &quot;checkmedia&quot; if ( $this-&gt;{m_proddata}-&gt;getVar(&quot;RUN_MEDIA_CHECK&quot;, &quot;0&quot;) ne &quot;0&quot; );
       $iso = new KIWIIsoLinux($this-&gt;{m_logger}, $this-&gt;{m_basesubdir}-&gt;{$cd}, $this-&gt;{m_united}.&quot;/$cdname.iso&quot;,$attr,$checkmedia);
       if(!$iso-&gt;callBootMethods()) {
         $this-&gt;logMsg(&quot;W&quot;, &quot;Creating boot methods failed, medium maybe not be bootable&quot;);
@@ -726,6 +683,29 @@ sub getMetafileList
 } # getMetafileList
 
 
+sub addDebugPackage($$$$)
+{
+   my $this = shift;
+   my $packname = shift;
+   my $arch = shift;
+   my $packPointer = shift;
+
+   if ( $this-&gt;{m_debugPacks}-&gt;{$packname} ){
+        $this-&gt;{m_debugPacks}-&gt;{$packname}-&gt;{'onlyarch'} .= &quot;,$arch&quot;;
+        $this-&gt;{m_debugPacks}-&gt;{$packname}-&gt;{'onlyarch'} .= &quot;,$arch&quot;;
+   } else {
+        $this-&gt;{m_debugPacks}-&gt;{$packname} = {
+          'medium' =&gt; $this-&gt;{m_debugmedium},
+          'onlyarch' =&gt; $arch
+        };
+        $this-&gt;{m_debugPacks}-&gt;{$packname} = {
+          'medium' =&gt; $this-&gt;{m_debugmedium},
+          'onlyarch' =&gt; $arch
+        };
+   };
+   $this-&gt;{m_debugPacks}-&gt;{$packname}-&gt;{'requireVersion'}-&gt;{ $packPointer-&gt;{'version'}.&quot;-&quot;.$packPointer-&gt;{'release'} } = 1;
+   $this-&gt;{m_debugPacks}-&gt;{$packname}-&gt;{'requireVersion'}-&gt;{ $packPointer-&gt;{'version'}.&quot;-&quot;.$packPointer-&gt;{'release'} } = 1;
+}
 
 #==========================================
 # setupPackageFiles
@@ -761,7 +741,7 @@ sub setupPackageFiles
     my $nofallback = 0;
     my @archs;
     $count_packs++;
-    if ( $mode eq 2 ) {
+    if ( $mode == 2 ) {
       push @archs, 'src', 'nosrc';
     }else{
       @archs = $this-&gt;getArchList($packOptions, $packName, \$nofallback);
@@ -780,7 +760,7 @@ sub setupPackageFiles
       $this-&gt;logMsg(&quot;W&quot;, &quot;  Evaluate package $packName for requested arch $requestedArch&quot;) if $this-&gt;{m_debug} &gt;= 5;
 
       my @fallbacklist;
-      if($nofallback==0 &amp;&amp; $mode ne 2) {
+      if($nofallback==0 &amp;&amp; $mode != 2) {
 	@fallbacklist = $this-&gt;{m_archlist}-&gt;fallbacks($requestedArch);
         $this-&gt;logMsg(&quot;W&quot;, &quot; Look for fallbacks fallbacks&quot;) if $this-&gt;{m_debug} &gt;= 6;
       }
@@ -802,7 +782,7 @@ sub setupPackageFiles
 	    $this-&gt;logMsg(&quot;I&quot;, &quot;     =&gt; package $packName not available for arch $arch in repo $packKey&quot;) if $this-&gt;{m_debug} &gt;= 4;
             next PACKKEY;
           }
-          if($nofallback==0 &amp;&amp; $mode ne 2) {
+          if($nofallback==0 &amp;&amp; $mode != 2) {
 	    my $follow = $this-&gt;{m_archlist}-&gt;arch($arch)-&gt;follower();
 	    if(defined($follow)) { 
 	      $this-&gt;logMsg(&quot;I&quot;, &quot;     =&gt; falling back to $follow from $packKey instead&quot;) if $this-&gt;{m_debug} &gt;= 4;
@@ -815,8 +795,7 @@ sub setupPackageFiles
             next PACKKEY;
           }
           # Success, found a package !
-          my $medium = 1;
-          $medium = $packOptions-&gt;{'medium'} if( $packOptions-&gt;{'medium'});
+          my $medium = $packOptions-&gt;{'medium'} || 1;
           
           $packOptions-&gt;{'newfile'}  = &quot;$packName-$packPointer-&gt;{'version'}-$packPointer-&gt;{'release'}.$packPointer-&gt;{'arch'}.rpm&quot;;
           $packOptions-&gt;{'newpath'} = &quot;$this-&gt;{m_basesubdir}-&gt;{$medium}/$base_on_cd/$packPointer-&gt;{'arch'}&quot;;
@@ -833,16 +812,16 @@ sub setupPackageFiles
             $this-&gt;logMsg(&quot;I&quot;, &quot;  linked file $packPointer-&gt;{'localfile'} to $packOptions-&gt;{'newpath'}/$packOptions-&gt;{'newfile'}&quot;) if $this-&gt;{m_debug} &gt;= 4;
             if ($this-&gt;{m_debug} &gt;= 2) {
               if ($arch eq $requestedArch) {
-                $this-&gt;logMsg(&quot;W&quot;, &quot;  package $packName found for architecture $arch as $packKey&quot;);
+                $this-&gt;logMsg(&quot;D&quot;, &quot;  package $packName found for architecture $arch as $packKey&quot;);
               }else{
-                $this-&gt;logMsg(&quot;W&quot;, &quot;  package $packName found for architecture $arch (fallback of $requestedArch) as $packKey&quot;);
+                $this-&gt;logMsg(&quot;D&quot;, &quot;  package $packName found for architecture $arch (fallback of $requestedArch) as $packKey&quot;);
               }
             }
             if ( $mode == 1 &amp;&amp; $packPointer-&gt;{sourcepackage} ) {
               my $srcname = $packPointer-&gt;{sourcepackage};
               $srcname =~ s/-[^-]*-[^-]*\.rpm$//; # this strips everything, except main name
               # 
-              if ( defined($this-&gt;{m_srcmedium}) &amp;&amp; $this-&gt;{m_srcmedium} &gt; 0 ) {
+              if ( $this-&gt;{m_srcmedium} &gt; 0 ) {
                 if (!$this-&gt;{m_sourcePacks}-&gt;{$srcname}) {
                   # FIXME: add forcerepo here
                   $this-&gt;{m_sourcePacks}-&gt;{$srcname} = {
@@ -853,27 +832,15 @@ sub setupPackageFiles
                 $packPointer-&gt;{sourcepackage} =~ m/.*-([^-]*-[^-]*)\.[^\.]*\.rpm/; # get version-release string
                 $this-&gt;{m_sourcePacks}-&gt;{$srcname}-&gt;{'requireVersion'}-&gt;{ $1 } = 1;
               }
-              if ( defined($this-&gt;{m_debugmedium}) &amp;&amp; $this-&gt;{m_debugmedium} &gt; 0 ) {
+              if ( $this-&gt;{m_debugmedium} &gt; 0 ) {
                 # Add debug packages, we do not know, if they exist at all
                 my $suffix = &quot;&quot;;
                 $suffix = &quot;-32bit&quot; if ( $packName =~ /-32bit$/ );
                 $suffix = &quot;-64bit&quot; if ( $packName =~ /-64bit$/ );
                 $suffix = &quot;-x86&quot;   if ( $packName =~ /-x86$/ );
-                if ( $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debuginfo&quot;.$suffix} ){
-                  $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debuginfo&quot;.$suffix}-&gt;{'onlyarch'} .= &quot;,$arch&quot;;
-                  $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debugsource&quot;.$suffix}-&gt;{'onlyarch'} .= &quot;,$arch&quot;;
-                } else {
-                  $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debuginfo&quot;.$suffix} = {
-                    'medium' =&gt; $this-&gt;{m_debugmedium},
-                    'onlyarch' =&gt; $arch
-                  };
-                  $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debugsource&quot;.$suffix} = {
-                    'medium' =&gt; $this-&gt;{m_debugmedium},
-                    'onlyarch' =&gt; $arch
-                  };
-                };
-                $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debuginfo&quot;.$suffix}-&gt;{'requireVersion'}-&gt;{ $packPointer-&gt;{'version'}.&quot;-&quot;.$packPointer-&gt;{'release'} } = 1;
-                $this-&gt;{m_debugPacks}-&gt;{$srcname.&quot;-debugsource&quot;.$suffix}-&gt;{'requireVersion'}-&gt;{ $packPointer-&gt;{'version'}.&quot;-&quot;.$packPointer-&gt;{'release'} } = 1;
+                $this-&gt;addDebugPackage($srcname.&quot;-debuginfo&quot;.$suffix, $arch, $packPointer);
+                $this-&gt;addDebugPackage($srcname.&quot;-debugsource&quot;, $arch, $packPointer);
+                $this-&gt;addDebugPackage($packName.&quot;-debuginfo&quot;, $arch, $packPointer);
               };
             }
           }
@@ -915,7 +882,6 @@ sub collectPackages
   ### step 1
   # expand dir lists (setup in constructor for each repo) to filenames
   if($this-&gt;{m_debug}) {
-    $this-&gt;{m_logger}-&gt;info(&quot;&quot;);
     $this-&gt;logMsg(&quot;I&quot;, &quot;STEP 1 [collectPackages]&quot; );
     $this-&gt;logMsg(&quot;I&quot;, &quot;expand dir lists for all repositories&quot;);
   }
@@ -944,7 +910,6 @@ sub collectPackages
 
   ### step 2:
   if($this-&gt;{m_debug}) {
-    $this-&gt;{m_logger}-&gt;info(&quot;&quot;);
     $this-&gt;logMsg(&quot;I&quot;, &quot;STEP 2 [collectPackages]&quot; );
     $this-&gt;logMsg(&quot;I&quot;, &quot;Select packages and create links&quot;);
   }
@@ -955,14 +920,14 @@ sub collectPackages
     $this-&gt;logMsg(&quot;E&quot;, &quot;[collectPackages] $setupFiles RPM packages could not be setup&quot;);
     return 1;
   }
-  if ( defined($this-&gt;{m_srcmedium}) &amp;&amp; $this-&gt;{m_srcmedium} &gt; 0 ) {
+  if ( $this-&gt;{m_srcmedium} &gt; 0 ) {
     $setupFiles = $this-&gt;setupPackageFiles(2, $this-&gt;{m_sourcePacks});
     if($setupFiles &gt; 0) {
       $this-&gt;logMsg(&quot;E&quot;, &quot;[collectPackages] $setupFiles SOURCE RPM packages could not be setup&quot;);
       return 1;
     }
   }
-  if ( defined($this-&gt;{m_debugmedium}) &amp;&amp; $this-&gt;{m_debugmedium} &gt; 0 ) {
+  if ( $this-&gt;{m_debugmedium} &gt; 0 ) {
     $setupFiles = $this-&gt;setupPackageFiles(0, $this-&gt;{m_debugPacks});
     if($setupFiles &gt; 0) {
       $this-&gt;logMsg(&quot;E&quot;, &quot;[collectPackages] $setupFiles DEBUG RPM packages could not be setup&quot;);
@@ -972,7 +937,6 @@ sub collectPackages
 
   ### step 3: NOW I know where you live...
   if($this-&gt;{m_debug}) {
-    $this-&gt;{m_logger}-&gt;info(&quot;&quot;);
     $this-&gt;logMsg(&quot;I&quot;, &quot;STEP 3 [collectPackages]&quot; );
     $this-&gt;logMsg(&quot;I&quot;, &quot;Handle scripts for metafiles and metapackages&quot;);
   }
@@ -990,7 +954,7 @@ sub collectPackages
   }
 
   my @metafiles = keys(%{$this-&gt;{m_metafiles}});
-  if(!$this-&gt;executeMetafileScripts(@metafiles)) {
+  if($this-&gt;executeMetafileScripts(@metafiles) != 0) {
     $this-&gt;logMsg(&quot;E&quot;, &quot;[collectPackages] executing metafile scripts failed!&quot;);
     return 1;
   }
@@ -1188,7 +1152,7 @@ sub unpackMetapackages
 #              }
 #              else {
 #                $this-&gt;logMsg(&quot;W&quot;, &quot;Undefined values in hash for package $metapack&quot;);
-#                #$this-&gt;{m_logger}-&gt;warning( Dumper($this-&gt;{$metapack}));
+#                #$this-&gt;logMsg(&quot;W&quot;, Dumper($this-&gt;{$metapack}));
 #              }
 #            }
 #          }
@@ -1222,6 +1186,7 @@ sub unpackMetapackages
 sub executeMetafileScripts
 {
   my $this = shift;
+  my $ret = 0;
 
   # the second (first explicit) parameter is a list of either packages or files
   # for which scripts shall be executed.
@@ -1252,6 +1217,9 @@ sub executeMetafileScripts
 	my $retcode = $? &gt;&gt; 8;
 	print &quot;STATUS:\n$status\n&quot;;
 	print &quot;RETURNED:\n$retcode\n&quot;;
+        if ($retcode) {
+		$ret = 1;
+        }
       }
       else {
 	$this-&gt;logMsg(&quot;W&quot;, &quot;[executeScripts] script $this-&gt;{m_scriptbase}/$scriptfile for metafile $metafile could not be executed successfully!&quot;);
@@ -1262,6 +1230,7 @@ sub executeMetafileScripts
       
     }
   }
+  return $ret;
 }
 # /executeScripts
 
@@ -1388,15 +1357,14 @@ sub dumpRepoData
 {
   # dumps data collected in $this-&gt; ... for debugging purpose.
   # receives a file name as parameter.
-  # If file can't be openend, a warning is issued through $this-&gt;{m_kiwi}
+  # If file can't be openend, a warning is issued through $this-&gt;{m_logger}
   # and nothing else happens.
   # Successful completion provides a list of content in the file.
   my $this    = shift;
   my $target  = shift;
 
   if(!open(DUMP, &quot;&gt;&quot;, $target)) {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;[dumpRepoData] Dumping data to file $target failed: file could not be created!&quot;);
-    $this-&gt;{m_logger}-&gt;failed();
+    $this-&gt;logMsg(&quot;E&quot;, &quot;[dumpRepoData] Dumping data to file $target failed: file could not be created!&quot;);
   }
   else {
     print DUMP &quot;Dumped data from KIWICollect object\n\n&quot;;
@@ -1430,15 +1398,14 @@ sub dumpPackageList
 {
   # dumps data collected in $this-&gt;{m_repoPacks} for debugging purpose.
   # receives a file name as parameter.
-  # If file can't be openend, a warning is issued through $this-&gt;{m_kiwi}
+  # If file can't be openend, a warning is issued through $this-&gt;{m_logger}
   # and nothing else happens.
   # Successful completion provides a list of content in the file.
   my $this    = shift;
   my $target  = shift;
 
   if(!open(DUMP, &quot;&gt;&quot;, $target)) {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;[dumpPackageList] Dumping data to file $target failed: file could not be created!&quot;);
-    $this-&gt;{m_kiwi}-&gt;failed();
+    $this-&gt;logMsg(&quot;E&quot;, &quot;[dumpPackageList] Dumping data to file $target failed: file could not be created!&quot;);
   }
 
   print DUMP &quot;Dumped data from KIWICollect object\n\n&quot;;
@@ -1649,7 +1616,7 @@ sub createMetadata
 	$this-&gt;logMsg(&quot;E&quot;, &quot;Cannot create file &lt;$bfile&gt;!&quot;);
 	return undef;
       }
-      print BUILD $this-&gt;{m_proddata}-&gt;getVar(&quot;BUILD_ID&quot;).&quot;\n&quot;;
+      print BUILD $this-&gt;{m_proddata}-&gt;getVar(&quot;BUILD_ID&quot;, &quot;0&quot;).&quot;\n&quot;;
       close(BUILD);
     }
   }
@@ -1740,11 +1707,14 @@ sub createMetadata
     $s1sum_opts = &quot;&quot;;
   }
   if(! (-f $csha1sum or -x $csha1sum)) {
-    $this-&gt;logMsg(&quot;W&quot;, &quot;[createMetadata] excutable `$csha1sum` not found. Maybe package `inst-source-utils` is not installed?&quot;);
+    $this-&gt;logMsg(&quot;E&quot;, &quot;[createMetadata] excutable `$csha1sum` not found. Maybe package `inst-source-utils` is not installed?&quot;);
     return;
   }
   for my $sd($this-&gt;getMediaNumbers()) {
     my @data = qx($csha1sum $s1sum_opts $this-&gt;{m_basesubdir}-&gt;{$sd});
+    if ($? &gt;&gt; 8 != 0) {
+	$this-&gt;logMsg(&quot;E&quot;, &quot;[createMetadata] $csha1sum failed&quot;);
+    }
     $this-&gt;logMsg(&quot;W&quot;, &quot;[createMetadata] $csha1sum output:&quot;);
     foreach(@data) {
       chomp $_;
@@ -1772,7 +1742,7 @@ sub createMetadata
   #$this-&gt;logMsg(&quot;W&quot;, &quot;[createMetadata] $md5sums output:&quot;);
   #foreach(@data) {
   #  chomp $_;
-  #  $this-&gt;{m_logger}-&gt;info(&quot;\t$_\n&quot;);
+  #  $this-&gt;logMsg(&quot;I&quot;, &quot;\t$_\n&quot;);
   #}
   #@data = (); # clear list
 
@@ -1980,11 +1950,11 @@ sub getMediaNumbers
   return undef if not defined $this;
   
   my @media = (1);	# default medium is 1 (always)
-  if ( defined($this-&gt;{m_srcmedium}) &amp;&amp; $this-&gt;{m_srcmedium} &gt; 1 ) {
+  if ( $this-&gt;{m_srcmedium} &gt; 1 ) {
     push @media, $this-&gt;{m_srcmedium};
   }
 
-  if ( defined($this-&gt;{m_debugmedium}) &amp;&amp; $this-&gt;{m_debugmedium} &gt; 1 ) {
+  if ( $this-&gt;{m_debugmedium} &gt; 1 ) {
     push @media, $this-&gt;{m_debugmedium};
   }
 
diff --git a/modules/KIWIProductData.pm b/modules/KIWIProductData.pm
index ce6144b..e0afff8 100644
--- a/modules/KIWIProductData.pm
+++ b/modules/KIWIProductData.pm
@@ -88,7 +88,7 @@ sub addSet
   my $num_added = 0;
 
   if(not(defined($name) and defined($hashref))) {
-    $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;Name and hashref must be defined!&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;Name and hashref must be defined!&quot;);
     return undef;
   }
   else {
@@ -104,7 +104,7 @@ sub addSet
 	  $num_added++;
 	}
 	else {
-	  $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;ProductData::addSet(): element with index $index already exists in m_inforef hash!&quot;);
+	  $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;ProductData::addSet(): element with index $index already exists in m_inforef hash!&quot;);
 	}
       }
       #%{$this-&gt;{$what.&quot;-hash&quot;}} = map { $_-&gt;[0], $_-&gt;[1] } values %{$this-&gt;{$what}};
@@ -118,13 +118,13 @@ sub addSet
 	  $num_added++;
 	}
 	else {
-	  $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;ProductData::addSet(): element with index $name already exists in $what hash!&quot;);
+	  $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;ProductData::addSet(): element with index $name already exists in $what hash!&quot;);
 	}
       }
     }
     else {
       # error
-	  $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;ProductData::addSet(): $what is not a valid element!&quot;);
+	  $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;ProductData::addSet(): $what is not a valid element!&quot;);
     }
   }
   return $num_added;
@@ -168,7 +168,11 @@ sub getVar
     return undef;
   }
   my $var = shift;
+  my $mydefault = undef;
+  eval { $mydefault = shift; };
+
   if(not defined($var)) {
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;ProductData:getVar() \$var is not set&quot;);
     return undef;
   }
   else {
@@ -176,10 +180,11 @@ sub getVar
       return $this-&gt;{prodvars}-&gt;{$var};
     }
     else {
-      $this-&gt;{m_collect}-&gt;logger()-&gt;warning(&quot;ProductData:getVar($var) is not set&quot;);
-      return undef;
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;ProductData:getVar($var) is not set&quot;);
+      return $mydefault;
     }
   }
+  return $mydefault;
 }
 # /getVar
 
@@ -230,7 +235,7 @@ sub getInfo
       return $this-&gt;{'prodinfo'}-&gt;{$this-&gt;{'prodinfo-indices'}-&gt;{$info}}-&gt;[1];
     }
     else {
-      $this-&gt;{m_collect}-&gt;logger()-&gt;warning(&quot;ProductData:getInfo($info) is not set&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;W&quot;, &quot;ProductData:getInfo($info) is not set&quot;);
       return undef;
     }
   }
@@ -284,7 +289,7 @@ sub getOpt
       return $this-&gt;{prodopts}-&gt;{$opt};
     }
     else {
-      $this-&gt;{m_collect}-&gt;logger()-&gt;warning(&quot;ProductData:getOpt($opt) is not set&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;W&quot;, &quot;ProductData:getOpt($opt) is not set&quot;);
       return undef;
     }
   }
@@ -428,7 +433,7 @@ sub _substitute
       $string =~ s{\$$2}{$repl};
     }
     else {
-      $this-&gt;{m_collect}-&gt;logger()-&gt;warning(&quot;ProductData::_substitute: pattern $1 is not in the translation hash!\n&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;W&quot;, &quot;ProductData::_substitute: pattern $1 is not in the translation hash!\n&quot;);
       $string =~ s{\$$2}{NOTSET};
       next;
     }
diff --git a/modules/KIWIRepoMetaHandler.pm b/modules/KIWIRepoMetaHandler.pm
index f0eb27f..997207f 100644
--- a/modules/KIWIRepoMetaHandler.pm
+++ b/modules/KIWIRepoMetaHandler.pm
@@ -45,7 +45,6 @@ sub new
     return undef; # rock hard get outta here: caller must check retval anyway
   }
   #$this-&gt;{m_unitedir}	= $this-&gt;{m_collect}-&gt;unitedDir();
-  #$this-&gt;{m_logger}	= $this-&gt;{m_collect}-&gt;logger();
 
   $this-&gt;gossip(&quot;Created $class object successfully.&quot;);
 
@@ -120,16 +119,14 @@ sub baseurl
 #==================
 # gossip
 #------------------
-# report a message back through collect-&gt;logger
+# report a message back through collect-&gt;logMsg
 # if the debug flag was set
 #------------------
 sub gossip
 {
   my $this = shift;
   my $message = shift;
-  if(defined($message) and $this-&gt;{m_collect}-&gt;debugflag()) {
-    $this-&gt;{m_collect}-&gt;logger()-&gt;info(&quot;$message&quot;);
-  }
+  $this-&gt;{m_collect}-&gt;logMsg(&quot;D&quot;, $message);
 }
 
 
@@ -149,7 +146,7 @@ sub loadPlugins
   if(not defined($dir)) {
     $dir = $this-&gt;collect()-&gt;productData()-&gt;getOpt(&quot;PLUGIN_DIR&quot;);
     if(not defined($dir)) {
-      return $loaded;
+      return ($loaded, $avail);
     }
   }
 
@@ -157,7 +154,7 @@ sub loadPlugins
   unshift @INC, $dir;
   if(not opendir(PLUGINDIR, &quot;$dir&quot;)) {
     $this-&gt;gossip(&quot;loadPlugins: cannot open directory $dir&quot;);
-    return $loaded;
+    return ($loaded, $avail);
   }
 
   my @plugins = readdir(PLUGINDIR);
@@ -180,7 +177,7 @@ sub loadPlugins
 	$plugins{$1} = &quot;$prefix$1.ini&quot;;
       }
       else {
-	$this-&gt;collect()-&gt;logger()-&gt;warning(&quot;[W] loadPlugins: no ini file found for plugin &lt;$1&gt;, skipping\n&quot;);
+	$this-&gt;collect()-&gt;logMsg(&quot;W&quot;, &quot;loadPlugins: no ini file found for plugin &lt;$1&gt;, skipping\n&quot;);
       }
     }
   }
@@ -193,7 +190,7 @@ sub loadPlugins
       $loaded++;
     }
     else {
-      $this-&gt;collect()-&gt;logger()-&gt;error(&quot;[E] loadPlugins: failed to load plugin &lt;$p&gt; from url &lt;$dir&gt;: $@&quot;);
+      $this-&gt;collect()-&gt;logMsg(&quot;E&quot;, &quot;loadPlugins: failed to load plugin &lt;$p&gt; from url &lt;$dir&gt;: $@&quot;);
     }
   }
 
@@ -218,30 +215,30 @@ sub loadPlugin
     $file .= &quot;.pm&quot;;
   }
   if(not(defined($file) and -f $file)) {
-    $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;[E] loadPlugin: file=&lt;$file&gt; maybe not readable&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;loadPlugin: file=&lt;$file&gt; maybe not readable&quot;);
     return $retval;
   }
 
   $file =~ m{(.*)/(.*)([.]pm)$};
   my $plugin = $2;
   if(not defined($plugin)) {
-    $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;[E] loadPlugin: something in regexp broken: $file =~ m{(.*)/(.*)([.]pm)$}...?&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;loadPlugin: something in regexp broken: $file =~ m{(.*)/(.*)([.]pm)$}...?&quot;);
     return $retval;
   }
 
   eval &quot;require $plugin&quot;;
   if($@) {
-    $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;[E] loadPlugin: loading &lt;$plugin&gt; failed&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;loadPlugin: loading &lt;$plugin&gt; failed&quot;);
   }
   else {
     my $inifile = shift;
     if(!$inifile) {
-      $this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;[E] can't load inifile &lt;$inifile&gt; for plugin &lt;$plugin&gt;&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;can't load inifile &lt;$inifile&gt; for plugin &lt;$plugin&gt;&quot;);
     }
     else {
       my $object = ($plugin)-&gt;new($this, $inifile);
       if(not defined($object)) {
-	$this-&gt;{m_collect}-&gt;logger()-&gt;error(&quot;[E] Unable to create object of &lt;$plugin&gt;: constructor failed!&quot;);
+	$this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;Unable to create object of &lt;$plugin&gt;: constructor failed!&quot;);
       }
       else {
 	my $addsuccess = $this-&gt;_addPlugin($object);
@@ -272,12 +269,12 @@ sub _addPlugin
     if(not defined($n)) {
       $n = &quot;Name not set&quot;;
     }
-    $this-&gt;{m_collect}-&gt;logger()-&gt;info(&quot;[I] Undefined order of plugin &lt;$n&gt;&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Undefined order of plugin &lt;$n&gt;&quot;);
   }
   else {
     if(defined($this-&gt;{m_handlers}-&gt;{$order})) {
       # we have a problem: (TODO in the future)
-      $this-&gt;collect()-&gt;logger()-&gt;error(&quot;[E] Can't handle multiple occurance of order!&quot;);
+      $this-&gt;collect()-&gt;logMsg(&quot;E&quot;, &quot;Can't handle multiple occurance of order!&quot;);
       return $retval;
       #die &quot;Can't handle mutliple occurences of ordernumbers yet!&quot;;
     }
@@ -304,7 +301,7 @@ sub getPlugin
   }
   else {
     if(not defined($this-&gt;{m_handlers}-&gt;{$index})) {
-      $this-&gt;collect()-&gt;logger()-&gt;warning(&quot;[W] no plugin defined with index &lt;$index&gt;\n&quot;);
+      $this-&gt;collect()-&gt;logMsg(&quot;W&quot;, &quot;no plugin defined with index &lt;$index&gt;\n&quot;);
       return undef;
     }
     else {
diff --git a/modules/KIWIUtil.pm b/modules/KIWIUtil.pm
index 2f6392d..1dfa7d2 100644
--- a/modules/KIWIUtil.pm
+++ b/modules/KIWIUtil.pm
@@ -36,7 +36,7 @@ sub new
   my $class = shift;
   my $this =
   {
-    m_logger  =&gt; undef,
+    m_collect  =&gt; undef,
     m_url     =&gt; undef,
   };
   bless ($this, $class);
@@ -44,9 +44,9 @@ sub new
   #==========================================
   # Module Parameters
   #------------------------------------------
-  $this-&gt;{m_logger} = shift;
-  if(not defined $this-&gt;{m_logger}) {
-    print &quot;No logger defined!&quot;;
+  $this-&gt;{m_collect} = shift;
+  if(not defined $this-&gt;{m_collect}) {
+    print &quot;No parent defined!&quot;;
     return undef;
   }
 
@@ -84,11 +84,9 @@ sub splitPath
   #==========================================
   # cancel on missing parameters:
   #------------------------------------------
-  my $kiwi = $this-&gt;{m_logger};
   if(!defined($browser) or !defined($targets) or !defined($path))
   {
-    $kiwi-&gt;info(&quot;Can't proceed request due to missing parameters!&quot;);
-    $kiwi-&gt;failed();
+    $this-&gt;{m_collect}-&gt;error(&quot;E&quot;, &quot;Can't proceed request due to missing parameters!&quot;);
     return undef;
   }
 
@@ -112,19 +110,19 @@ sub splitPath
     my $pattern = $4;
     $pattern =~ s{(.*)[/]{2,}(.*)}{$1/$2};
     # remove double slashes
-    $this-&gt;{m_logger}-&gt;info(&quot;Examining HTTP path $basepath&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Examining HTTP path $basepath&quot;);
     return $this-&gt;splitPathHTTP($targets, $browser, $basepath, $pattern, $leafonly);
   }
   elsif($path =~ m{^(<A HREF="ftp://">ftp://</A>)}) {
     # warn and go, return undef
-    $kiwi-&gt;{m_logger}-&gt;warning(&quot;Protocol not yet supported. Stay tuned...&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;W&quot;, &quot;Protocol not yet supported. Stay tuned...&quot;);
     return undef;
   }
   elsif($path =~ m{^(/|<A HREF="file://">file://</A>)(.*)}) {
     # we deal with local files (including nfs)
     my $basepath = &quot;/$2&quot;;
     #my $pattern = $2;
-    $this-&gt;{m_logger}-&gt;info(&quot;Examining local path $basepath&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Examining local path $basepath&quot;);
     return $this-&gt;splitPathLocal($targets, $basepath, $pat, $leafonly);
   }
 }
@@ -170,9 +168,9 @@ sub splitPathHTTP
   # catch 3xx error codes from HTTP server
   # is_error handles 400-599 http replies (according to &quot;PERL in a nutshell&quot;)
   if($response-&gt;is_error()) {
-    $this-&gt;{m_logger}-&gt;error(&quot;[E] HTTP request failed! Server down?&quot;);
-    $this-&gt;{m_logger}-&gt;error(&quot;\tThis repository can not be resolved at present.&quot;);
-    $this-&gt;{m_logger}-&gt;error(&quot;\tI recommend you try again later unless you know what you're doing.&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;[E] HTTP request failed! Server down?&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;\tThis repository can not be resolved at present.&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;\tI recommend you try again later unless you know what you're doing.&quot;);
     return undef;
   }
 
@@ -183,7 +181,7 @@ sub splitPathHTTP
   # (works for now, but...)
   if($response-&gt;title !~ m{(index of|repoview)}i) {
     # this means that no dir listing is done here, try one descend.
-    $this-&gt;{m_logger}-&gt;info(&quot;Directory $basepath has no listings, descencding&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Directory $basepath has no listings, descencding&quot;);
     return $this-&gt;splitPathHTTP($targets, $browser, $basepath.&quot;/&quot;.$prefix, $rest, $leafonly);
   }
 
@@ -193,7 +191,7 @@ sub splitPathHTTP
     return undef;
   }
 
-  $this-&gt;{m_logger}-&gt;info(&quot;Current remote directory is $basepath&quot;);
+  $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Current remote directory is $basepath&quot;);
 
   #==========================================
   # Evaluate LWP content
@@ -224,13 +222,13 @@ sub splitPathHTTP
 	  # list directory even if the path is not finished
 	  push @{$targets}, $basepath.&quot;/&quot;.$link;
 	}
-	$this-&gt;{m_logger}-&gt;info(&quot;Descending into subdirectory $basepath/$link&quot;);
+	$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Descending into subdirectory $basepath/$link&quot;);
 	$this-&gt;splitPathHTTP($targets, $browser, $basepath.&quot;/&quot;.$link, $rest, $leafonly);
       }
       else {
 	# if the path is finished the leaves are stored
 	push @{$targets}, $basepath.&quot;/&quot;.$link;
-	$this-&gt;{m_logger}-&gt;info(&quot;Storing directory $basepath/$link&quot;);
+	$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing directory $basepath/$link&quot;);
       }
     }
   }
@@ -239,7 +237,7 @@ sub splitPathHTTP
     # we're in a dir where no subdirs are found but:
     # $rest may be non-zero
     push @{$targets}, $basepath;
-    $this-&gt;{m_logger}-&gt;info(&quot;Storing directory $basepath&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing directory $basepath&quot;);
   }
 
   return $this;
@@ -280,7 +278,7 @@ sub splitPathLocal
   my @dirlist = readdir(DIR);
   closedir(DIR);
 
-  $this-&gt;{m_logger}-&gt;info(&quot;Current local directory is $basepath&quot;);
+  $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Current local directory is $basepath&quot;);
   my $atleastonce = 0;
 
   foreach my $entry(@dirlist) {
@@ -293,15 +291,15 @@ sub splitPathLocal
       #	pattern contains subdirs -&gt; descent necessary
       if($leafonly == 1) {
 	# list directory even if the path is not finished
-	$this-&gt;{m_logger}-&gt;info(&quot;Storing directory $basepath/$entry&quot;);
+	$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing directory $basepath/$entry&quot;);
 	push @{$targets}, &quot;$basepath/$entry&quot;;
       }
-      #$this-&gt;{m_logger}-&gt;info(&quot;Descending into subdirectory $basepath/$entry&quot;);
+      #$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Descending into subdirectory $basepath/$entry&quot;);
       $this-&gt;splitPathLocal($targets, &quot;$basepath/$entry&quot;, $rest, $leafonly);
     }
     else {
       push @{$targets}, &quot;$basepath/$entry&quot;;
-      #$this-&gt;{m_logger}-&gt;info(&quot;Storing directory $basepath/$entry&quot;);
+      #$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing directory $basepath/$entry&quot;);
     }
 
   }
@@ -311,7 +309,7 @@ sub splitPathLocal
     # but the regexp isn't used up yet; store last found dir
     # ignoring the rest
     push @{$targets}, $basepath;
-    #$this-&gt;{m_logger}-&gt;info(&quot;Storing directory $basepath&quot;);
+    #$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing directory $basepath&quot;);
   }
 
   return $this;
@@ -340,25 +338,23 @@ sub expandFilename
   #------------------------------------------
   # saves the checks in the resp. specialised method
   #------------------------------------------
-  my $kiwi = $this-&gt;{m_logger};
   if(!defined($browser)
       or !defined($basepath)
       or !defined($filename))
   {
-    $kiwi-&gt;error(&quot;Can't proceed request due to missing parameters!&quot;);
-    $kiwi-&gt;failed();
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;Can't proceed request due to missing parameters!&quot;);
     return undef;
   }
 
   $basepath =~ s{(.*)\/$}{$1}; # remove trailing slash
   if($basepath =~ m{^(http|ftp|https)}) {
     # we deal with a web request
-    $this-&gt;{m_logger}-&gt;info(&quot;Expanding remote filenames for $basepath&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Expanding remote filenames for $basepath&quot;);
     return $this-&gt;expandFilenameHTTP($browser, $basepath, $filename);
   }
   elsif($basepath =~ m{^(/|<A HREF="file://">file://</A>)(.*)}) {
     # we deal with a local directory
-    $this-&gt;{m_logger}-&gt;info(&quot;Expanding local filenames for $2&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Expanding local filenames for $2&quot;);
     return $this-&gt;expandFilenameLocal($browser, $2, $filename);
   }
 }
@@ -415,7 +411,7 @@ sub expandFilenameHTTP
     $link =~ s{.*/}{}g;
     if($link =~ m{$filename}) {
       push @filelist, $basepath.&quot;/&quot;.$link;}
-      #$this-&gt;{m_logger}-&gt;info(&quot;Storing path $basepath/$link&quot;);
+      #$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing path $basepath/$link&quot;);
   }
   return @filelist;
 }
@@ -461,7 +457,7 @@ sub findCallback
   if($_ =~ m{$filename}) {
     push @{$listref}, $File::Find::name;
     # uncomment for gigatons of output if program runs too fast ;)
-    #$this-&gt;{m_logger}-&gt;info(&quot;Storing path $File::Find::name&quot;);
+    #$this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;Storing path $File::Find::name&quot;);
   }
 }
 
@@ -540,7 +536,7 @@ sub unpac_package
 
   if(! -d $dir) {
     if(!mkpath(&quot;$dir&quot;, { mode =&gt; 0755 })) {
-      $this-&gt;{m_logger}-&gt;error(&quot;[E] unpac_package: cannot create directory &lt;$dir&gt;&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;[E] unpac_package: cannot create directory &lt;$dir&gt;&quot;);
       $retval = 2;
       goto up_failed;
     }
@@ -550,20 +546,20 @@ sub unpac_package
     my $out = qx(cd $dir &amp;&amp; tar -zxvfp $p_uri);
     my $status = $?&gt;&gt;8;
     if($status != 0) {
-      $this-&gt;{m_logger}-&gt;error(&quot;[E] command cp $dir &amp;&amp; tar xvzfp $p_uri failed!\n&quot;);
-      $this-&gt;{m_logger}-&gt;error(&quot;\t$out\n&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;[E] command cp $dir &amp;&amp; tar xvzfp $p_uri failed!\n&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;\t$out\n&quot;);
       $retval = 5;
       goto up_failed;
     }
     else {
-      $this-&gt;{m_logger}-&gt;info(&quot;[I] unpacked $p_uri in directory $dir\n&quot;);
+      $this-&gt;{m_collect}-&gt;logMsg(&quot;I&quot;, &quot;[I] unpacked $p_uri in directory $dir\n&quot;);
     }
   }
   elsif($p_uri =~ m{.*\.rpm}i) {
     my $out = qx(cd $dir &amp;&amp; unrpm -q $p_uri);
   }
   else {
-    $this-&gt;{m_logger}-&gt;error(&quot;[E] cannot process file $p_uri\n&quot;);
+    $this-&gt;{m_collect}-&gt;logMsg(&quot;E&quot;, &quot;[E] cannot process file $p_uri\n&quot;);
     $retval = 4;
     goto up_failed;
   }
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index 7a18963..3443061 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -1,4 +1,12 @@
 -------------------------------------------------------------------
+Tue Oct 27 09:28:36 CET 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
+
+- kiwi-instsource changes done by <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">coolo at novell.com</A>
+  * fixed logging
+  * fixed several uninitialized variables
+  * fixed debuginfo handling
+
+-------------------------------------------------------------------
 Mon Oct 26 12:12:04 CET 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 
 - don't call ldconfig when loading KIWILinuxRC functions (bnc #549904)


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001548.html">[Kiwi-devel] Patch for example demonstrating the use of GNOME
</A></li>
	<LI>Next message: <A HREF="001549.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. a3d6672821fa2401cd57b29a8e2a4522f20b71f4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1547">[ date ]</a>
              <a href="thread.html#1547">[ thread ]</a>
              <a href="subject.html#1547">[ subject ]</a>
              <a href="author.html#1547">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
