<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 9a92da51b2fa4770afb51738d0d4a164b91dc895
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2010-January/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%209a92da51b2fa4770afb51738d0d4a164b91dc895&In-Reply-To=%3C201001050954.o059sFZm025304%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001733.html">
   <LINK REL="Next"  HREF="001735.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 9a92da51b2fa4770afb51738d0d4a164b91dc895</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%209a92da51b2fa4770afb51738d0d4a164b91dc895&In-Reply-To=%3C201001050954.o059sFZm025304%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 9a92da51b2fa4770afb51738d0d4a164b91dc895">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Tue Jan  5 10:54:15 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001733.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 2dc5d8b116d6a4a877c7e942804772456837b7e2
</A></li>
        <LI>Next message: <A HREF="001735.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 9dcb28debf24169288ae3ba3de14eed3f976afe4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1734">[ date ]</a>
              <a href="thread.html#1734">[ thread ]</a>
              <a href="subject.html#1734">[ subject ]</a>
              <a href="author.html#1734">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  9a92da51b2fa4770afb51738d0d4a164b91dc895 (commit)
      from  2dc5d8b116d6a4a877c7e942804772456837b7e2 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 9a92da51b2fa4770afb51738d0d4a164b91dc895
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Tue Jan 5 10:53:38 2010 +0100

    - some work on the migration front [still WIP]:
      * changed to report -&gt; perform system, fixed solvable
        creation and provide better information about package
        and pattern conflicts. Changed system to use the zypper
        defined repos and product information for the migration

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/LaTex/Revision.txt b/doc/LaTex/Revision.txt
index d49d1fa..c71beb6 100644
--- a/doc/LaTex/Revision.txt
+++ b/doc/LaTex/Revision.txt
@@ -1 +1 @@
-3.86
\ No newline at end of file
+3.89
\ No newline at end of file
diff --git a/doc/kiwi-man/KIWI::config.sh.1 b/doc/kiwi-man/KIWI::config.sh.1
index eb60e08..b6a23bf 100644
--- a/doc/kiwi-man/KIWI::config.sh.1
+++ b/doc/kiwi-man/KIWI::config.sh.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::config.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 12/15/2009
+.\&quot;      Date: Created: 01/04/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 12/15/2009&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 01/04/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/KIWI::images.sh.1 b/doc/kiwi-man/KIWI::images.sh.1
index 6e0ea75..6038132 100644
--- a/doc/kiwi-man/KIWI::images.sh.1
+++ b/doc/kiwi-man/KIWI::images.sh.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::images.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 12/15/2009
+.\&quot;      Date: Created: 01/04/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 12/15/2009&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 01/04/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/kiwi-man.xml b/doc/kiwi-man/kiwi-man.xml
index 4a8d1af..9073d72 100644
--- a/doc/kiwi-man/kiwi-man.xml
+++ b/doc/kiwi-man/kiwi-man.xml
@@ -169,12 +169,22 @@
     &lt;para&gt;
       The migration module allows you to migrate your currently running
       system into an image description. The module will check for files
-      not managed by a package manager and it will suggest a repository from
-      which this operating system could be rebuild. 
-      The result is quite useful but in most cases a manual fine
+      not managed by a package manager and also inspects your system for
+      package pattern and file consistency according to the currently active
+      repositories. The system requires the zypper backend in order to
+      work properly. By default a HTML based report file is created which
+      contains important information about the system. You are free to
+      ignore that information but with the risk that the migrated image
+      does not represent the same system which is running at the moment.
+      If the perform option is set an image description is created
+      with the collected information. The less issues left in the report
+      the better is the result. In most cases a manual fine
       tuning is required. This includes the repository selection and the
       unmanaged files along with the configuration details of your
-      currently running operating system.
+      currently running operating system. You should understand the module
+      as a helper to migrate running servers into images. The implementation
+      is still under construction so expect better migration results 
+      in future releases :)
     &lt;/para&gt;    
     &lt;cmdsynopsis&gt;&lt;command&gt;kiwi&lt;/command&gt; 
       &lt;group choice=&quot;req&quot;&gt;
@@ -184,7 +194,7 @@
       &lt;arg choice=&quot;plain&quot;&gt;&lt;replaceable&gt;name&lt;/replaceable&gt;&lt;/arg&gt;
       &lt;arg choice=&quot;plain&quot;&gt;--destdir &lt;replaceable&gt;destination-path&lt;/replaceable&gt;&lt;/arg&gt;
       &lt;arg choice=&quot;opt&quot; rep=&quot;repeat&quot;&gt;--exclude &lt;replaceable&gt;directory&lt;/replaceable&gt;&lt;/arg&gt;
-      &lt;arg choice=&quot;opt&quot;&gt;--report&lt;/arg&gt;
+      &lt;arg choice=&quot;opt&quot;&gt;--perform&lt;/arg&gt;
     &lt;/cmdsynopsis&gt;
   &lt;/refsect1&gt;
   
diff --git a/doc/kiwi-man/kiwi.1 b/doc/kiwi-man/kiwi.1
index 2e7c2ad..a25b1a8 100644
--- a/doc/kiwi-man/kiwi.1
+++ b/doc/kiwi-man/kiwi.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Schaefer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 12/15/2009
+.\&quot;      Date: Created: 01/04/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 12/15/2009&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 01/04/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
@@ -217,10 +217,10 @@ includes this update channel as repository, it is useful to store the image root
 .fam
 .SH &quot;System to Image Migration&quot;
 .PP
-The migration module allows you to migrate your currently running system into an image description\&amp;. The module will check for files not managed by a package manager and it will suggest a repository from which this operating system could be rebuild\&amp;. The result is quite useful but in most cases a manual fine tuning is required\&amp;. This includes the repository selection and the unmanaged files along with the configuration details of your currently running operating system\&amp;.
+The migration module allows you to migrate your currently running system into an image description\&amp;. The module will check for files not managed by a package manager and also inspects your system for package pattern and file consistency according to the currently active repositories\&amp;. The system requires the zypper backend in order to work properly\&amp;. By default a HTML based report file is created which contains important information about the system\&amp;. You are free to ignore that information but with the risk that the migrated image does not represent the same system which is running at the moment\&amp;. If the perform option is set an image description is created with the collected information\&amp;. The less issues left in the report the better is the result\&amp;. In most cases a manual fine tuning is required\&amp;. This includes the repository selection and the unmanaged files along with the configuration details of your currently running operating system\&amp;. You should understand t!
 he module as a helper to migrate running servers into images\&amp;. The implementation is still under construction so expect better migration results in future releases :)
 .fam C
 .HP \w'\fBkiwi\fR\ 'u
-\fBkiwi\fR {\-m | \-\-migrate} \fIname\fR \-\-destdir\ \fIdestination\-path\fR [\-\-exclude\ \fIdirectory\fR...] [\-\-report]
+\fBkiwi\fR {\-m | \-\-migrate} \fIname\fR \-\-destdir\ \fIdestination\-path\fR [\-\-exclude\ \fIdirectory\fR...] [\-\-perform]
 .fam
 .SH &quot;Image Postprocessing Modes&quot;
 .PP
diff --git a/doc/kiwi.pdf b/doc/kiwi.pdf
index 16c81a2..0dee7f0 100644
Binary files a/doc/kiwi.pdf and b/doc/kiwi.pdf differ
diff --git a/kiwi.pl b/kiwi.pl
index a2bfbec..f2beba0 100755
--- a/kiwi.pl
+++ b/kiwi.pl
@@ -176,8 +176,8 @@ our $SetRepositoryPriority; # priority for the repository
 our $SetImageType;          # set image type to use, default is primary type
 our $Migrate;               # migrate running system to image description
 our @Exclude;               # exclude directories in migrate search
-our $Report;                # create report on root/ tree migration only
-our $ReportPacklist;        # just report the package/pattern list on migration
+our @Skip;                  # skip this package in migration mode
+our $Perform;               # perform migration
 our @Profiles;              # list of profiles to include in image
 our @ProfilesOrig;          # copy of original Profiles option value 
 our $ForceNewRoot;          # force creation of new root directory
@@ -1067,23 +1067,36 @@ sub main {
 	if (defined $Migrate) {
 		$kiwi -&gt; info (&quot;Starting system to image migration&quot;);
 		$migrate = new KIWIMigrate (
-			$kiwi,$Destination,$Migrate,\@Exclude,$Report,
+			$kiwi,$Destination,$Migrate,\@Exclude,\@Skip,
 			\@AddRepository,\@AddRepositoryType,
-			\@AddRepositoryAlias,\@AddRepositoryPriority,
-			$SetRepository,$SetRepositoryType,
-			$SetRepositoryAlias,$SetRepositoryPriority
+			\@AddRepositoryAlias,\@AddRepositoryPriority
 		);
+		#==========================================
+		# Check object and repo setup, mandatory
+		#------------------------------------------
 		if (! defined $migrate) {
 			my $code = kiwiExit (1); return $code;
 		}
-		if (! $migrate -&gt; setTemplate()) {
+		if (! $migrate -&gt; getRepos()) {
 			my $code = kiwiExit (1); return $code;
 		}
-		if (! $ReportPacklist) {
+		#==========================================
+		# Create report HTML file, errors allowed
+		#------------------------------------------
+		$migrate -&gt; getPackageList();
+		$migrate -&gt; getSystemFileChanges();
+		$migrate -&gt; createReport();
+		#==========================================
+		# Perform migration based on report
+		#------------------------------------------
+		if (defined $Perform) {
+			if (! $migrate -&gt; setTemplate()) {
+				my $code = kiwiExit (1); return $code;
+			}
 			if (! $migrate -&gt; setServiceList()) {
 				my $code = kiwiExit (1); return $code;
 			}
-			if (! $migrate -&gt; setSystemConfiguration()) {
+			if (! $migrate -&gt; setSystemOverlayFiles()) {
 				my $code = kiwiExit (1); return $code;
 			}
 		}
@@ -1261,8 +1274,8 @@ sub init {
 		&quot;add-profile=s&quot;         =&gt; \@Profiles,
 		&quot;migrate|m=s&quot;           =&gt; \$Migrate,
 		&quot;exclude|e=s&quot;           =&gt; \@Exclude,
-		&quot;report&quot;                =&gt; \$Report,
-		&quot;report-packlist&quot;       =&gt; \$ReportPacklist,
+		&quot;skip=s&quot;                =&gt; \@Skip,
+		&quot;perform&quot;               =&gt; \$Perform,
 		&quot;list|l&quot;                =&gt; \&amp;listImage,
 		&quot;create|c=s&quot;            =&gt; \$Create,
 		&quot;testsuite=s&quot;           =&gt; \$RunTestSuite,
@@ -1511,7 +1524,8 @@ sub usage {
 	print &quot;System to Image migration:\n&quot;;
 	print &quot;    kiwi -m | --migrate &lt;name&gt; --destdir &lt;destination-path&gt;\n&quot;;
 	print &quot;       [ --exclude &lt;directory&gt; --exclude &lt;...&gt; ]\n&quot;;
-	print &quot;       [ --report ] [ --report-packlist ]\n&quot;;
+	print &quot;       [ --skip &lt;package&gt; --skip &lt;...&gt; ]\n&quot;;
+	print &quot;       [ --perform ]\n&quot;;
 	print &quot;Image postprocessing modes:\n&quot;;
 	print &quot;    kiwi --bootstick &lt;initrd&gt; --bootstick-system &lt;systemImage&gt;\n&quot;;
 	print &quot;       [ --bootstick-device &lt;device&gt; ]\n&quot;;
diff --git a/modules/KIWIMigrate.pm b/modules/KIWIMigrate.pm
index 5f1732b..954008a 100644
--- a/modules/KIWIMigrate.pm
+++ b/modules/KIWIMigrate.pm
@@ -48,18 +48,16 @@ sub new {
 	my $dest = shift;
 	my $name = shift;
 	my $excl = shift;
-	my $demo = shift;
+	my $skip = shift;
 	my $addr = shift;
 	my $addt = shift;
 	my $adda = shift;
 	my $addp = shift;
-	my $setr = shift;
-	my $sett = shift;
-	my $seta = shift;
-	my $setp = shift;
 	#==========================================
 	# Constructor setup
 	#------------------------------------------
+	my $code;
+	my $data;
 	if (! defined $kiwi) {
 		$kiwi = new KIWILog();
 	}
@@ -69,7 +67,17 @@ sub new {
 		$kiwi -&gt; failed ();
 		return undef;
 	}
-	my $code;
+	my $product = $this -&gt; getOperatingSystemVersion();
+	if (! defined $product) {
+		$kiwi -&gt; failed ();
+		$kiwi -&gt; error  (&quot;Couldn't find system version information&quot;);
+		$kiwi -&gt; failed ();
+		return undef;
+	}
+	$kiwi -&gt; note (&quot; [$product]...&quot;);
+	if (defined $main::ForceNewRoot) {
+		qxx (&quot;rm -rf $dest&quot;);
+	}
 	if (! defined $dest) {
 		$dest = qxx (&quot; mktemp -q -d /tmp/kiwi-migrate.XXXXXX &quot;);
 		$code = $? &gt;&gt; 8;
@@ -81,9 +89,11 @@ sub new {
 		}
 		chomp $dest;
 	} else {
-		if (! mkdir $dest) {
+		$data = qxx (&quot;mkdir $dest 2&gt;&amp;1&quot;);
+		$code = $? &gt;&gt; 8;
+		if ($code != 0) {
 			$kiwi -&gt; failed ();
-			$kiwi -&gt; error  (&quot;Couldn't create destination dir: $!&quot;);
+			$kiwi -&gt; error  (&quot;Couldn't create destination dir: $data&quot;);
 			$kiwi -&gt; failed ();
 			return undef;
 		}
@@ -99,59 +109,27 @@ sub new {
 		return undef;
 	}
 	#==========================================
-	# Store object data
+	# Store addon repo information if specified
 	#------------------------------------------
 	my %OSSource;
-	if (! open (FD,$main::KMigrate)) {
-		$kiwi -&gt; failed ();
-		$kiwi -&gt; error  (&quot;Failed to open migration table&quot;);
-		$kiwi -&gt; failed ();
-		return undef;
-	}
-	while (my $line = &lt;FD&gt;) {
-		next if $line =~ /^#/;
-		if ($line =~ /(.*)\s*=\s*(.*),(.*)/) {
-			my @source = split (/;/,$3);
-			my $product= $1;
-			my $boot   = $2;
-			my $type   = &quot;yast2&quot;;
-			my $alias;
-			my $prio;
-			if ((defined $setr) &amp;&amp; (defined $sett)) {
-				@source = ($setr);
-				$type   = $sett;
-			}
-			if (defined $seta) {
-				$alias = $seta;
-			}
-			if (defined $setp) {
-				$prio = $setp;
-			}
-			foreach my $source (@source) {
-				$OSSource{$product}{$source}{boot} = $boot;
-				$OSSource{$product}{$source}{type} = $type;
-				$OSSource{$product}{$source}{alias}= $alias;
-				$OSSource{$product}{$source}{prio} = $prio;
-			}
-			if ((defined $addr) &amp;&amp; (defined $addt)) {
-				my @addrepo     = @{$addr};
-				my @addrepotype = @{$addt};
-				my @addrepoalias= @{$adda};
-				my @addrepoprio = @{$addp};
-				foreach (my $count=0;$count &lt;@addrepo; $count++) {
-					my $source= $addrepo[$count];
-					my $type  = $addrepotype[$count];
-					my $alias = $addrepoalias[$count];
-					my $prio  = $addrepoprio[$count];
-					$OSSource{$product}{$source}{boot} = &quot;none&quot;;
-					$OSSource{$product}{$source}{type} = $type;
-					$OSSource{$product}{$source}{alias}= $alias;
-					$OSSource{$product}{$source}{prio} = $prio;
-				}
-			}
+	if ((defined $addr) &amp;&amp; (defined $addt)) {
+		my @addrepo     = @{$addr};
+		my @addrepotype = @{$addt};
+		my @addrepoalias= @{$adda};
+		my @addrepoprio = @{$addp};
+		foreach (my $count=0;$count &lt;@addrepo; $count++) {
+			my $source= $addrepo[$count];
+			my $type  = $addrepotype[$count];
+			my $alias = $addrepoalias[$count];
+			my $prio  = $addrepoprio[$count];
+			$OSSource{$product}{$source}{type} = $type;
+			$OSSource{$product}{$source}{alias}= $alias;
+			$OSSource{$product}{$source}{prio} = $prio;
 		}
 	}
-	close FD;
+	#==========================================
+	# Store default files not used for inspect
+	#------------------------------------------
 	my @denyFiles = (
 		'\.rpmnew',                  # no RPM backup files
 		'\.rpmsave',                 # []
@@ -193,57 +171,161 @@ sub new {
 	#==========================================
 	# Store object data
 	#------------------------------------------
-	$this-&gt;{kiwi}   = $kiwi;
-	$this-&gt;{deny}   = \@denyFiles;
-	$this-&gt;{dest}   = $dest;
-	$this-&gt;{name}   = $name;
-	$this-&gt;{source} = \%OSSource;
-	$this-&gt;{demo}   = $demo;
+	$this-&gt;{kiwi}    = $kiwi;
+	$this-&gt;{deny}    = \@denyFiles;
+	$this-&gt;{skip}    = $skip;
+	$this-&gt;{dest}    = $dest;
+	$this-&gt;{name}    = $name;
+	$this-&gt;{source}  = \%OSSource;
+	$this-&gt;{product} = $product;
 	return $this;
 }
 
 #==========================================
-# setTemplate
+# createReport
 #------------------------------------------
-sub setTemplate {
+sub createReport {
 	# ...
-	# create basic image description structure and files
+	# create html page report including action items for the
+	# user to solve outstanding problems in order to allow a
+	# clean migration of the system into an image description
 	# ---
-	my $this = shift;
-	my $dest = $this-&gt;{dest};
-	my $name = $this-&gt;{name};
-	my $kiwi = $this-&gt;{kiwi};
-	my %osc  = %{$this-&gt;{source}};
+	# TODO... make it nice as html page
+	my $this       = shift;
+	my $kiwi       = $this-&gt;{kiwi};
+	my $dest       = $this-&gt;{dest};
+	my $problem1   = $this-&gt;{solverProblem1};
+	my $problem2   = $this-&gt;{solverProblem2};
+	my $failedJob1 = $this-&gt;{solverFailedJobs1};
+	my $failedJob2 = $this-&gt;{solverFailedJobs2};
+	my $filechanges= $this-&gt;{filechanges};
 	#==========================================
-	# get operating system version
+	# start report
 	#------------------------------------------
-	my $product = $this -&gt; getOperatingSystemVersion();
-	if (! defined $product) {
-		$kiwi -&gt; error  (&quot;Couldn't find system version information&quot;);
-		$kiwi -&gt; failed ();
-		return undef;
+	# package report...
+	$kiwi -&gt; info (&quot;Migration Report\n&quot;);
+	$kiwi -&gt; info (&quot;----------------\n&quot;);
+	if ($problem1) {
+		$kiwi -&gt; info (&quot;Following patterns couldn't be solved due to\n&quot;);
+		$kiwi -&gt; info (&quot;dependency conflicts. Please check if your\n&quot;);
+		$kiwi -&gt; info (&quot;repository setup contains a system repository\n&quot;);
+		$kiwi -&gt; info (&quot;which matches the system you are about to migrate\n&quot;);
+		$kiwi -&gt; note (&quot;$problem1&quot;);
 	}
-	if (! defined $osc{$product}) {
-		$kiwi -&gt; error  (&quot;Couldn't find OS version: $product in migrate list&quot;);
-		$kiwi -&gt; failed ();
-		return undef;
+	if ($problem2) {
+		$kiwi -&gt; info (&quot;Following packages couldn't be solved due to\n&quot;);
+		$kiwi -&gt; info (&quot;dependency conflicts. Please check the conflicts\n&quot;);
+		$kiwi -&gt; info (&quot;and solve them by either uninstalling the\n&quot;);
+		$kiwi -&gt; info (&quot;package(s) from your system or skip them by using\n&quot;);
+		$kiwi -&gt; info (&quot;the --skip option\n&quot;); 
+		$kiwi -&gt; note (&quot;$problem2&quot;);
 	}
-	#==========================================
-	# find boot attribute value in OSSource
-	#------------------------------------------
-	my $boot;
-	foreach my $source (keys %{$osc{$product}} ) {
-		if ($osc{$product}{$source}{boot} ne &quot;none&quot;) {
-			$boot = $osc{$product}{$source}{boot};
+	if (@{$failedJob1}) {
+		$kiwi -&gt; info (&quot;Following patterns couldn't be found in your\n&quot;);
+		$kiwi -&gt; info (&quot;repository list but are marked as installed.\n&quot;);
+		$kiwi -&gt; info (&quot;You can either ignore it or add a repository which\n&quot;);
+		$kiwi -&gt; info (&quot;contains the mentioned patterns\n&quot;);
+		foreach my $job (@{$failedJob1}) {
+			$kiwi -&gt; note (&quot;$job\n&quot;);
 		}
 	}
-	my @pacs = $this -&gt; getPackageList ($product);
-	my $pats = $this -&gt; {patterns};
-	if (! @pacs) {
-		$kiwi -&gt; error  (&quot;Couldn't find installed packages&quot;);
-		$kiwi -&gt; failed ();
+	if (@{$failedJob2}) {
+		$kiwi -&gt; info (&quot;Following packages couldn't be found in your\n&quot;);
+		$kiwi -&gt; info (&quot;repository list but are installed on your system.\n&quot;);
+		$kiwi -&gt; info (&quot;You can either ignore it or add a repository which\n&quot;);
+		$kiwi -&gt; info (&quot;contains the mentioned packages\n&quot;);
+		my @pacs = @{$failedJob2};
+		my @list = qxx (&quot;rpm -q @pacs --last&quot;); chomp @list;
+		foreach my $job (@list) {
+			if ($job =~ /([^\s]+)\s+([^\s].*)/) {
+				my $pac  = $1;
+				my $date = $2;
+				$kiwi -&gt; note (&quot;--&gt; $pac\n\t$date\n&quot;);
+			}
+		}
+	}
+	# files report...
+	if ($filechanges) {
+		my %result = %{$filechanges};
+		my @rpmcheck = sort keys %result;
+		$kiwi -&gt; info (&quot;Creating files report\n&quot;);
+		if (! open (FD,&quot;&gt;$dest/report-files&quot;)) {
+			$kiwi -&gt; failed ();
+			$kiwi -&gt; error  (&quot;Couldn't create report file: $!&quot;);
+			$kiwi -&gt; failed ();
+			return undef;
+		}
+		my @list = ();
+		foreach my $file (@rpmcheck) {
+			print FD $file.&quot;\0&quot;;
+		}
+		close FD;
+		my $file = &quot;$dest/report-files&quot;;
+		my $prog = &quot;du -ch --time --files0-from&quot;;
+		my @data = qxx (&quot;$prog $file 2&gt;$dest/report-lost&quot;); chomp @data;
+		my $code = $? &gt;&gt; 8;
+		if ($code == 0) {
+			unlink &quot;$dest/report-lost&quot;;
+		}
+		unlink $file;
+		foreach my $line (@data) {
+			$kiwi -&gt; info (&quot;$line\n&quot;);
+		}
+	}
+	return $this;
+}
+
+#==========================================
+# getRepos
+#------------------------------------------
+sub getRepos {
+	# ...
+	# use zypper defined repositories as setup for the
+	# migration
+	# ---
+	my $this    = shift;
+	my $kiwi    = $this-&gt;{kiwi};
+	my %osc     = %{$this-&gt;{source}};
+	my $product = $this-&gt;{product};
+	my @list    = qxx (&quot;zypper lr --details 2&gt;&amp;1&quot;);	chomp @list;
+	my $code    = $? &gt;&gt; 8;
+	if ($code != 0) {
 		return undef;
 	}
+	foreach my $repo (@list) {
+		$repo =~ s/ +//g;
+		if ($repo =~ /^\d.*\|(.*)\|.*\|(.*)\|.*\|(.*)\|(.*)\|(.*)\|/) {
+			my $enabled = $2;
+			my $source  = $5;
+			my $type    = $4;
+			my $alias   = $1;
+			my $prio    = $3;
+			if ($enabled eq &quot;Yes&quot;) {
+				$osc{$product}{$source}{type} = $type;
+				$osc{$product}{$source}{alias}= $alias;
+				$osc{$product}{$source}{prio} = $prio;
+			}
+		}
+	}
+	$this-&gt;{source} = \%osc;
+	return $this;
+}
+
+#==========================================
+# setTemplate
+#------------------------------------------
+sub setTemplate {
+	# ...
+	# create basic image description structure and files
+	# ---
+	my $this    = shift;
+	my $dest    = $this-&gt;{dest};
+	my $name    = $this-&gt;{name};
+	my $kiwi    = $this-&gt;{kiwi};
+	my $product = $this-&gt;{product};
+	my $pats    = $this-&gt;{patterns};
+	my $pacs    = $this-&gt;{packages};
+	my %osc     = %{$this-&gt;{source}};
 	#==========================================
 	# create root directory
 	#------------------------------------------
@@ -257,7 +339,8 @@ sub setTemplate {
 	#==========================================
     # &lt;description&gt;
     #------------------------------------------
-	print FD '&lt;image schemaversion=&quot;3.8&quot; name=&quot;'.$name.'&quot;&gt;'.&quot;\n&quot;;
+	print FD '&lt;image schemaversion=&quot;3.8&quot; ';
+	print FD 'name=suse-migration&quot;'.$product.'&quot;&gt;'.&quot;\n&quot;;
 	print FD &quot;\t&quot;.'&lt;description type=&quot;system&quot;&gt;'.&quot;\n&quot;;
 	print FD &quot;\t\t&quot;.'&lt;author&gt;***AUTHOR***&lt;/author&gt;'.&quot;\n&quot;;
 	print FD &quot;\t\t&quot;.'&lt;contact&gt;***MAIL***&lt;/contact&gt;'.&quot;\n&quot;;
@@ -267,15 +350,9 @@ sub setTemplate {
 	# &lt;preferences&gt;
 	#------------------------------------------
 	print FD &quot;\t&quot;.'&lt;preferences&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;type primary=&quot;true&quot; boot=&quot;isoboot/'.$boot.'&quot;';
-	print FD ' flags=&quot;compressed&quot;&gt;iso&lt;/type&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;type boot=&quot;vmxboot/'.$boot.'&quot; filesystem=&quot;ext3&quot;';
+	print FD &quot;\t\t&quot;.'&lt;type boot=&quot;vmxboot/suse-'.$product.'&quot; filesystem=&quot;ext3&quot;';
 	print FD ' format=&quot;vmdk&quot;&gt;vmx&lt;/type&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;type boot=&quot;xenboot/'.$boot.'&quot;';
-	print FD ' filesystem=&quot;ext3&quot;&gt;xen&lt;/type&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;type boot=&quot;netboot/'.$boot.'&quot;';
-	print FD ' filesystem=&quot;ext3&quot;&gt;pxe&lt;/type&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;version&gt;1.1.2&lt;/version&gt;'.&quot;\n&quot;;
+	print FD &quot;\t\t&quot;.'&lt;version&gt;1.1.1&lt;/version&gt;'.&quot;\n&quot;;
 	print FD &quot;\t\t&quot;.'&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;'.&quot;\n&quot;;
 	print FD &quot;\t\t&quot;.'&lt;locale&gt;en_US&lt;/locale&gt;'.&quot;\n&quot;;
 	print FD &quot;\t\t&quot;.'&lt;keytable&gt;us.map.gz&lt;/keytable&gt;'.&quot;\n&quot;;
@@ -310,38 +387,13 @@ sub setTemplate {
 			print FD &quot;\t\t&quot;.'&lt;opensusePattern name=&quot;'.$pattern.'&quot;/&gt;'.&quot;\n&quot;;
 		}
 	}
-	foreach my $pac (@pacs) {
-		print FD &quot;\t\t&quot;.'&lt;package name=&quot;'.$pac.'&quot;/&gt;'.&quot;\n&quot;;
+	if (defined $pacs) {
+		foreach my $package (@{$pacs}) {
+			print FD &quot;\t\t&quot;.'&lt;package name=&quot;'.$package.'&quot;/&gt;'.&quot;\n&quot;;
+		}
 	}
 	print FD &quot;\t&quot;.'&lt;/packages&gt;'.&quot;\n&quot;;
 	#==========================================
-	# &lt;packages type=&quot;xen&quot;&gt;
-	#------------------------------------------
-	print FD &quot;\t&quot;.'&lt;packages type=&quot;xen&quot;&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;package name=&quot;kernel-xen&quot;/&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;package name=&quot;xen&quot;/&gt;'.&quot;\n&quot;;
-	print FD &quot;\t&quot;.'&lt;/packages&gt;'.&quot;\n&quot;;
-	#==========================================
-	# &lt;xenconfig&gt;
-	#------------------------------------------
-	print FD &quot;\t&quot;.'&lt;xenconfig memory=&quot;512&quot;&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;xendisk device=&quot;/dev/xvda&quot;/&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;xenbridge name=&quot;&quot;/&gt;'.&quot;\n&quot;;
-	print FD &quot;\t&quot;.'&lt;/xenconfig&gt;'.&quot;\n&quot;;
-	#==========================================
-	# &lt;packages type=&quot;vmware&quot;&gt;
-	#------------------------------------------
-	print FD &quot;\t&quot;.'&lt;packages type=&quot;vmware&quot;&gt;'.&quot;\n&quot;;
-	print FD &quot;\t&quot;.'&lt;/packages&gt;'.&quot;\n&quot;;
-	#==========================================
-	# &lt;vmwareconfig&gt;
-	#------------------------------------------
-	print FD &quot;\t&quot;.'&lt;vmwareconfig memory=&quot;512&quot;&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;vmwaredisk controller=&quot;scsi&quot; id=&quot;0&quot;/&gt;'.&quot;\n&quot;;
-	print FD &quot;\t\t&quot;.'&lt;vmwarenic driver=&quot;e1000&quot; interface=&quot;0&quot; mode=&quot;bridged&quot;/&gt;';
-	print FD &quot;\n&quot;;
-	print FD &quot;\t&quot;.'&lt;/vmwareconfig&gt;'.&quot;\n&quot;;
-	#==========================================
 	# &lt;packages type=&quot;bootstrap&quot;&gt;
 	#------------------------------------------
 	print FD &quot;\t&quot;.'&lt;packages type=&quot;bootstrap&quot;&gt;'.&quot;\n&quot;;
@@ -365,20 +417,15 @@ sub getOperatingSystemVersion {
 	# correct installation source
 	# ---
 	my $this = shift;
-	if (! open (FD,&quot;/etc/SuSE-release&quot;)) {
+	my @data = qxx (&quot;zypper --no-refresh products --installed 2&gt;&amp;1&quot;);
+	my $code = $? &gt;&gt; 8;
+	if ($code != 0) {
 		return undef;
 	}
-	my $name = &lt;FD&gt;; chomp $name;
-	my $vers = &lt;FD&gt;; chomp $vers;
-	my $plvl = &lt;FD&gt;; chomp $plvl;
-	$name =~ s/\s+/-/g;
-	$name =~ s/\-\(.*\)//g;
-	if ((defined $plvl) &amp;&amp; ($plvl =~ /PATCHLEVEL = (.*)/)) {
-		$plvl = $1;
-		$name = $name.&quot;-SP&quot;.$plvl;
+	if ($data[4] =~ /.*(\d\d\.\d)-.*/) {
+		return $1;
 	}
-	close FD;
-	return $name;
+	return undef
 }
 
 #==========================================
@@ -434,15 +481,30 @@ sub getPackageList {
 	# correctly
 	# ---
 	my $this    = shift;
-	my $product = shift;
+	my $product = $this-&gt;{product};
 	my $kiwi    = $this-&gt;{kiwi};
+	my $skip    = $this-&gt;{skip};
 	my %osc     = %{$this-&gt;{source}};
 	my @urllist = ();
+	my @patlist = ();
+	my %problem = ();
+	my $code;
+	my @ilist;
 	#==========================================
 	# find all rpm's installed
 	#------------------------------------------
 	undef $this-&gt;{patterns};
-	my @list = qxx ('rpm -qa --qf &quot;%{NAME}\n&quot;'); chomp @list;
+	undef $this-&gt;{packages};
+	$kiwi -&gt; info (&quot;Searching installed packages...&quot;);
+	@ilist = qxx ('rpm -qa --qf &quot;%{NAME}\n&quot; | sort | uniq'); chomp @ilist;
+	$code = $? &gt;&gt; 8;
+	if ($code != 0) {
+		$kiwi -&gt; failed ();
+		$kiwi -&gt; error  (&quot;Failed to obtain installed packages&quot;);
+		$kiwi -&gt; failed ();
+		return undef;
+	}
+	$kiwi -&gt; done();
 	#==========================================
 	# create URL list to lookup solvables
 	#------------------------------------------
@@ -453,31 +515,56 @@ sub getPackageList {
 	# find all patterns and packs of patterns 
 	#------------------------------------------
 	if (@urllist) {
-		my @patlist = qxx (&quot;zypper patterns|grep ^i|cut -f2 -d'|'| tr -d ' '&quot;);
+		$kiwi -&gt; info (&quot;Creating System solvable from active repos...&quot;);
+		my @list = qxx (&quot;zypper --no-refresh patterns --installed 2&gt;&amp;1&quot;);
 		my $code = $? &gt;&gt; 8;
 		if ($code != 0) {
-			# /.../
-			# no installed patterns found, use at least the base
-			# pattern for the migration
-			# ----
-			push (@patlist,&quot;base&quot;);
+			$kiwi -&gt; failed ();
+			$kiwi -&gt; error  (&quot;Failed to obtain installed patterns&quot;);
+			$kiwi -&gt; failed ();
+			return undef;
+		} else {
+			my %pathash = ();
+			foreach my $line (@list) {
+				if ($line =~ /^i.*\|(.*)\|.*\|.*\|/) {
+					my $name = $1;
+					$name =~ s/^ +//g;
+					$name =~ s/ +$//g;
+					$pathash{&quot;$name&quot;} = &quot;$name&quot;;
+				}
+			}
+			@patlist = keys %pathash;
 		}
-		chomp @patlist;
+		$this-&gt;{patterns} = \@patlist;
 		my $psolve = new KIWISatSolver (
-			$kiwi,\@patlist,\@urllist
+			$kiwi,\@patlist,\@urllist,undef,undef,undef,&quot;silent&quot;
 		);
 		my @result = ();
 		if (! defined $psolve) {
-			return sort @list;
+			$kiwi -&gt; failed ();
+			$kiwi -&gt; error  (&quot;Failed to solve patterns&quot;);
+			$kiwi -&gt; failed ();
+			return undef;
 		}
 		# /.../
 		# solve the zypper pattern list into a package list and
 		# create a package list with packages _not_ part of the
-		# pattern list. patterns which does not exist in the base
-		# repository will be ignored.
+		# pattern list.
 		# ----
+		$kiwi-&gt;done();
+		$this-&gt;{solverProblem1}    = $psolve -&gt; getProblemInfo();
+		$this-&gt;{solverFailedJobs1} = $psolve -&gt; getFailedJobs();
+		if ($psolve -&gt; getProblemsCount()) {
+			$kiwi -&gt; warning (&quot;Pattern problems found check in report !\n&quot;);
+		}
+		if (defined $skip) {
+			foreach my $s (@{$skip}) {
+				$problem{$s} = $s;
+			}
+		}
 		my @packageList = $psolve -&gt; getPackages();
-		foreach my $installed (@list) {
+		foreach my $installed (@ilist) {
+			next if ($problem{$installed});
 			my $inpattern = 0;
 			foreach my $p (@packageList) {
 				if ($installed eq $p) {
@@ -489,10 +576,6 @@ sub getPackageList {
 			}
 		}
 		# /.../
-		# store the pattern names for the later config.xml
-		# ----
-		$this-&gt;{patterns} = \@patlist;
-		# /.../
 		# walk through the non pattern based packages and solve
 		# them again. packages which are not part of the base
 		# repository will be ignored. This might be a problem
@@ -500,27 +583,39 @@ sub getPackageList {
 		# The solved list is again checked with the pattern
 		# package list and the result is returned
 		# ----
-		my @rest = ();
-		my $repo = $psolve -&gt; getRepo();
-		my $pool = $psolve -&gt; getPool();
-		my $xsolve = new KIWISatSolver (
-			$kiwi,\@result,\@urllist,&quot;solve-packages&quot;,$repo,$pool
-		);
-		@result = $xsolve -&gt; getPackages();
-		foreach my $p (@result) {
-			my $inpattern = 0;
-			foreach my $tobeinstalled (@packageList) {
-				if ($tobeinstalled eq $p) {
-					$inpattern = 1; last;
-				}
+		if (@result) {
+			my @rest = ();
+			my $repo = $psolve -&gt; getRepo();
+			my $pool = $psolve -&gt; getPool();
+			my $xsolve = new KIWISatSolver (
+				$kiwi,\@result,\@urllist,&quot;solve-packages&quot;,$repo,$pool,&quot;silent&quot;
+			);
+			if (! defined $xsolve) {
+				$kiwi -&gt; error  (&quot;Failed to solve packages&quot;);
+				$kiwi -&gt; failed ();
+				return undef;
 			}
-			if (! $inpattern) {
-				push (@rest,$p);
+			$this-&gt;{solverProblem2}    = $xsolve -&gt; getProblemInfo();
+			$this-&gt;{solverFailedJobs2} = $xsolve -&gt; getFailedJobs();
+			if ($xsolve -&gt; getProblemsCount()) {
+				$kiwi -&gt; warning (&quot;Package problems found check in report !\n&quot;);
 			}
+			@result = $xsolve -&gt; getPackages();
+			foreach my $p (@result) {
+				my $inpattern = 0;
+				foreach my $tobeinstalled (@packageList) {
+					if ($tobeinstalled eq $p) {
+						$inpattern = 1; last;
+					}
+				}
+				if (! $inpattern) {
+					push (@rest,$p);
+				}
+			}
+			$this-&gt;{packages} = \@rest;
 		}
-		return sort @rest;
 	}
-	return sort @list;
+	return $this;
 }
 
 #==========================================
@@ -565,15 +660,14 @@ sub getRootDevice {
 }
 
 #==========================================
-# setSystemConfiguration
+# getSystemFileChanges
 #------------------------------------------
-sub setSystemConfiguration {
+sub getSystemFileChanges {
 	# ...
 	# 1) Find all files not owned by any package
 	# 2) Find all files changed according to the package manager
 	# ---
 	my $this = shift;
-	my $demo = $this-&gt;{demo};
 	my $dest = $this-&gt;{dest};
 	my $kiwi = $this-&gt;{kiwi};
 	my $rdev = $this-&gt;{rdev};
@@ -614,8 +708,8 @@ sub setSystemConfiguration {
 	#==========================================
 	# Find files not packaged
 	#------------------------------------------
+	$kiwi -&gt; info (&quot;Inspecting root file system...\n&quot;);
 	my $wref = generateWanted (\%result,$mount);
-	$kiwi -&gt; info (&quot;Inspecting root file system...&quot;);
 	find ({ wanted =&gt; $wref, follow =&gt; 0 }, $mount );
 	$this -&gt; cleanMount();
 	$kiwi -&gt; done ();
@@ -687,66 +781,60 @@ sub setSystemConfiguration {
 	$kiwi -&gt; note (&quot;\n&quot;);
 	$kiwi -&gt; doNorm ();
 	$kiwi -&gt; cursorON();
-	#==========================================
-	# Create report or custom root tree
-	#------------------------------------------
-	@rpmcheck = sort keys %result;
-	if (defined $demo) {
-		$kiwi -&gt; info (&quot;Creating report for root tree: $dest/report&quot;);
-		if (! open (FD,&quot;&gt;$dest/report-files&quot;)) {
-			$kiwi -&gt; failed ();
-			$kiwi -&gt; error  (&quot;Couldn't create report file: $!&quot;);
-			$kiwi -&gt; failed ();
-			return undef;
-		}
-		my @list = ();
-		foreach my $file (@rpmcheck) {
-			print FD $file.&quot;\0&quot;;
-		}
-		close FD;
-		my $file = &quot;$dest/report-files&quot;;
-		my $prog = &quot;du -ch --time --files0-from&quot;;
-		my $data = qxx (&quot;$prog $file 2&gt;$dest/report-lost &gt; $dest/report&quot;);
-		my $code = $? &gt;&gt; 8;
-		if ($code == 0) {
-			unlink &quot;$dest/report-lost&quot;;
-		}
-		unlink $file;
-		$kiwi -&gt; done ();
-	} else {
-		$kiwi -&gt; info (&quot;Setting up custom root tree...&quot;);
-		$kiwi -&gt; cursorOFF();
-		$rpmsize  = @rpmcheck;
-		$spart = 100 / $rpmsize;
-		$count = 1;
-		foreach my $file (@rpmcheck) {
-			if (-e $file) {
-				my $dir = $result{$file};
-				if (! -d &quot;$dest/root/$dir&quot;) {
-					qxx (&quot;mkdir -p $dest/root/$dir&quot;);
-				}
-				qxx (&quot;cp -a \&quot;$file\&quot; \&quot;$dest/root/$file\&quot;&quot;);
-			}
-			$done = int ($count * $spart);
-			if ($done != $done_old) {
-				$kiwi -&gt; step ($done);
+	$this-&gt;{filechanges} = \%result;
+	$this-&gt;{filecheck}   = \@rpmcheck;
+	return $this;
+}
+
+#==========================================
+# setSystemOverlayFiles
+#------------------------------------------
+sub setSystemOverlayFiles {
+	# ...
+	# write file changes as overlay files for the
+	# image description. The input data for this function
+	# is created by the getSystemFileChanges() function
+	# which has to be called first !
+	# ---
+	my $this    = shift;
+	my $kiwi    = $this-&gt;{kiwi};
+	my $dest    = $this-&gt;{dest};
+	my %result  = %{$this-&gt;{filechanges}};
+	my @rpmcheck= @{$this-&gt;{filecheck}};
+	my $rpmsize = @rpmcheck;
+	my $spart   = 100 / $rpmsize;
+	my $count   = 1;
+	my $done;
+	my $done_old;
+	$kiwi -&gt; info (&quot;Setting up custom root tree...&quot;);
+	$kiwi -&gt; cursorOFF();
+	foreach my $file (@rpmcheck) {
+		if (-e $file) {
+			my $dir = $result{$file};
+			if (! -d &quot;$dest/root/$dir&quot;) {
+				qxx (&quot;mkdir -p $dest/root/$dir&quot;);
 			}
-			$done_old = $done;
-			$count++;
-		}
-		$kiwi -&gt; note (&quot;\n&quot;);
-		$kiwi -&gt; doNorm ();
-		$kiwi -&gt; cursorON();
-		$kiwi -&gt; info (&quot;Checking for broken links in custom root tree...&quot;);
-		$this -&gt; checkBrokenLinks();
-		$kiwi -&gt; done();
-		$kiwi -&gt; info (&quot;Setting up initial deployment workflow...&quot;);
-		if (! $this -&gt; setInitialSetup()) {
-			return undef;
+			qxx (&quot;cp -a \&quot;$file\&quot; \&quot;$dest/root/$file\&quot;&quot;);
 		}
-		$kiwi -&gt; done();
+		$done = int ($count * $spart);
+		if ($done != $done_old) {
+			$kiwi -&gt; step ($done);
+		}
+		$done_old = $done;
+		$count++;
 	}
-	return %result;
+	$kiwi -&gt; note (&quot;\n&quot;);
+	$kiwi -&gt; doNorm ();
+	$kiwi -&gt; cursorON();
+	$kiwi -&gt; info (&quot;Checking for broken links in custom root tree...&quot;);
+	$this -&gt; checkBrokenLinks();
+	$kiwi -&gt; done();
+	$kiwi -&gt; info (&quot;Setting up initial deployment workflow...&quot;);
+	if (! $this -&gt; setInitialSetup()) {
+		return undef;
+	}
+	$kiwi -&gt; done();
+	return $this;
 }
 
 #==========================================
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index c87347d..9cdd831 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -5,6 +5,11 @@ Mon Jan  4 10:03:14 CET 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 - fixed dirPath() function, related to (bnc #561855)
 - fixed KIWIURL::quote() for special '$' char (bnc #561855)
 - use default inode count for lvmparts (bnc #567580)
+- some work on the migration front [still WIP]:
+  * changed to report -&gt; perform system, fixed solvable
+    creation and provide better information about package
+    and pattern conflicts. Changed system to use the zypper
+    defined repos and product information for the migration
 
 -------------------------------------------------------------------
 Thu Dec 17 11:59:03 CET 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001733.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 2dc5d8b116d6a4a877c7e942804772456837b7e2
</A></li>
	<LI>Next message: <A HREF="001735.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 9dcb28debf24169288ae3ba3de14eed3f976afe4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1734">[ date ]</a>
              <a href="thread.html#1734">[ thread ]</a>
              <a href="subject.html#1734">[ subject ]</a>
              <a href="author.html#1734">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
