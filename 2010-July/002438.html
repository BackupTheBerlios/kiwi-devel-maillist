<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-443-SuSE-11-3-Devel,	updated. 3389dfd43e54ff972c0cf8ac534317fcb89211f5
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2010-July/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%0A%09KIWI-443-SuSE-11-3-Devel%2C%0A%09updated.%203389dfd43e54ff972c0cf8ac534317fcb89211f5&In-Reply-To=%3C20100722081607.EC34B480BE7%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002437.html">
   <LINK REL="Next"  HREF="002439.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-443-SuSE-11-3-Devel,	updated. 3389dfd43e54ff972c0cf8ac534317fcb89211f5</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%0A%09KIWI-443-SuSE-11-3-Devel%2C%0A%09updated.%203389dfd43e54ff972c0cf8ac534317fcb89211f5&In-Reply-To=%3C20100722081607.EC34B480BE7%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-443-SuSE-11-3-Devel,	updated. 3389dfd43e54ff972c0cf8ac534317fcb89211f5">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Thu Jul 22 10:16:07 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002437.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-374-SuSE-11-1-SLE-SP-Devel,	updated. 4530e855d0892e4c2d5f0cf407909f6797293c80
</A></li>
        <LI>Next message: <A HREF="002439.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. b3d0a7fdac2fcda5c26c5eb6a85de1cbd3e76d05
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2438">[ date ]</a>
              <a href="thread.html#2438">[ thread ]</a>
              <a href="subject.html#2438">[ subject ]</a>
              <a href="author.html#2438">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, KIWI-443-SuSE-11-3-Devel has been updated
       via  3389dfd43e54ff972c0cf8ac534317fcb89211f5 (commit)
       via  86d1d9eb75d490815611a73c198ac957a0f63e50 (commit)
       via  d66a54b4cd072a95782165c190b43374ffb3326e (commit)
       via  79a8fd0015b48f084c76262ee2bb7657dc412c79 (commit)
       via  d2ce7422ca734c2d8fc8efdd918a0d2ba3769a7c (commit)
       via  79b73d712a84b9c5739c22ca70d8dcc66e618a39 (commit)
       via  f5b3c98ee0245f2d3fa89715a29c512a7d6a4e2d (commit)
       via  aeca986f1133b794c87e78cced5f7e6d4b518376 (commit)
      from  221f43c739ae1bcbc0bca1df6cbc972f3c032d9b (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 3389dfd43e54ff972c0cf8ac534317fcb89211f5
Merge: 221f43c 86d1d9e
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Thu Jul 22 10:15:46 2010 +0200

    Merge remote branch 'origin/master' into KIWI-443-SuSE-11-3-Devel
    
    Conflicts:
    	doc/kiwi-man/KIWI::config.sh.1
    	doc/kiwi-man/KIWI::images.sh.1
    	doc/kiwi-man/KIWI::kiwirc.1
    	doc/kiwi-man/kiwi.1
    	doc/kiwi.pdf

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/LaTex/description.tex b/doc/LaTex/description.tex
index 3975777..1b4b316 100644
--- a/doc/LaTex/description.tex
+++ b/doc/LaTex/description.tex
@@ -394,9 +394,15 @@ attributes:
       /usr/share/zoneinfo/Europe/Berlin. KIWI uses this value to configure
       the timezone in /etc/localtime for the image
 \item \textbf{locale}\\
-      Specifies the name of the locale to use, which defines the
+      Specifies the name of the UTF-8 locale to use, which defines the
       contents of the RC\_LANG system environment variable in
-      /etc/sysconfig/language
+      /etc/sysconfig/language. Please note only UTF-8 locales are supported
+      here which also means that the encoding must \textbf{not} be part of
+      the locale information. The kiwi schema validates the locale string
+      according to the following pattern:\\
+      \verb+[a-z]{2}_[A-Z]{2}(,[a-z]{2}_[A-Z]{2})*+.
+      This means you have to specifiy the locale like the following example:
+      en\_US or en\_US,de\_DE
 \item \textbf{boot-theme}\\
       Specifies the name of the gfxboot and bootsplash theme to use
 \item \textbf{defaultdestination}\\
diff --git a/doc/examples/suse-11.1/suse-live-iso/config.xml b/doc/examples/suse-11.1/suse-live-iso/config.xml
index fcc3e99..cae1e87 100644
--- a/doc/examples/suse-11.1/suse-live-iso/config.xml
+++ b/doc/examples/suse-11.1/suse-live-iso/config.xml
@@ -12,7 +12,7 @@
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
-		&lt;locale&gt;en_US.UTF-8&lt;/locale&gt;
+		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
diff --git a/doc/examples/suse-11.1/suse-live-stick/config.xml b/doc/examples/suse-11.1/suse-live-stick/config.xml
index e4bafc1..6bb900e 100644
--- a/doc/examples/suse-11.1/suse-live-stick/config.xml
+++ b/doc/examples/suse-11.1/suse-live-stick/config.xml
@@ -21,7 +21,7 @@
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;rpm-excludedocs&gt;true&lt;/rpm-excludedocs&gt;
-		&lt;locale&gt;en_US.UTF-8&lt;/locale&gt;
+		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
 		&lt;timezone&gt;Europe/Berlin&lt;/timezone&gt;
 	&lt;/preferences&gt;
diff --git a/doc/examples/suse-11.2/suse-live-iso/config.xml b/doc/examples/suse-11.2/suse-live-iso/config.xml
index c288c2a..0ec2868 100644
--- a/doc/examples/suse-11.2/suse-live-iso/config.xml
+++ b/doc/examples/suse-11.2/suse-live-iso/config.xml
@@ -12,7 +12,7 @@
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
-		&lt;locale&gt;en_US.UTF-8&lt;/locale&gt;
+		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
diff --git a/doc/examples/suse-11.2/suse-live-stick/config.xml b/doc/examples/suse-11.2/suse-live-stick/config.xml
index 742ab5d..2ac5ba3 100644
--- a/doc/examples/suse-11.2/suse-live-stick/config.xml
+++ b/doc/examples/suse-11.2/suse-live-stick/config.xml
@@ -21,7 +21,7 @@
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;rpm-excludedocs&gt;true&lt;/rpm-excludedocs&gt;
-		&lt;locale&gt;en_US.UTF-8&lt;/locale&gt;
+		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
 		&lt;timezone&gt;Europe/Berlin&lt;/timezone&gt;
 	&lt;/preferences&gt;
diff --git a/doc/examples/suse-11.3/suse-live-iso/config.xml b/doc/examples/suse-11.3/suse-live-iso/config.xml
index 9265311..b4f1f5e 100644
--- a/doc/examples/suse-11.3/suse-live-iso/config.xml
+++ b/doc/examples/suse-11.3/suse-live-iso/config.xml
@@ -12,7 +12,7 @@
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
-		&lt;locale&gt;en_US.UTF-8&lt;/locale&gt;
+		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
diff --git a/doc/examples/suse-11.3/suse-pxe-client/config.xml b/doc/examples/suse-11.3/suse-pxe-client/config.xml
index 09167bf..f14d7e5 100644
--- a/doc/examples/suse-11.3/suse-pxe-client/config.xml
+++ b/doc/examples/suse-11.3/suse-pxe-client/config.xml
@@ -45,13 +45,11 @@
 		&lt;package name=&quot;sysconfig&quot;/&gt;
 		&lt;package name=&quot;syslinux&quot;/&gt;
 		&lt;package name=&quot;sysfsutils&quot;/&gt;
-		&lt;package name=&quot;syslog-ng&quot;/&gt;
 		&lt;package name=&quot;kbd&quot;/&gt;
 		&lt;package name=&quot;ksymoops&quot;/&gt;
 		&lt;package name=&quot;less&quot;/&gt;
 		&lt;package name=&quot;initviocons&quot;/&gt;
 		&lt;package name=&quot;iputils&quot;/&gt;
-		&lt;package name=&quot;portmap&quot;/&gt;
 		&lt;package name=&quot;dhcpcd&quot;/&gt;
 		&lt;package name=&quot;dbus-1&quot;/&gt;
 		&lt;package name=&quot;grub&quot;/&gt;
@@ -62,12 +60,10 @@
 		&lt;package name=&quot;xorg-x11&quot;/&gt;
 		&lt;package name=&quot;xorg-x11-server&quot;/&gt;
 		&lt;package name=&quot;xorg-x11-driver-video&quot;/&gt;
-		&lt;package name=&quot;xorg-x11-fonts-scalable&quot;/&gt;
 		&lt;package name=&quot;xterm&quot;/&gt;
 		&lt;package name=&quot;xdmbgrd&quot;/&gt;
 		&lt;package name=&quot;xkeyboard-config&quot;/&gt;
 		&lt;package name=&quot;icewm-lite&quot;/&gt;
-		&lt;package name=&quot;firefox&quot;/&gt;
 	&lt;/packages&gt;
 	&lt;packages type=&quot;bootstrap&quot;&gt;
 		&lt;package name=&quot;filesystem&quot;/&gt;
diff --git a/doc/kiwi-man/KIWI::config.sh.1 b/doc/kiwi-man/KIWI::config.sh.1
index 462a51a..3491c78 100644
--- a/doc/kiwi-man/KIWI::config.sh.1
+++ b/doc/kiwi-man/KIWI::config.sh.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::config.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 07/19/2010
+.\&quot;      Date: Created: 07/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI 4.43
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 07/19/2010&quot; &quot;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 07/22/2010&quot; &quot;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/KIWI::images.sh.1 b/doc/kiwi-man/KIWI::images.sh.1
index 7e874ed..e9d554f 100644
--- a/doc/kiwi-man/KIWI::images.sh.1
+++ b/doc/kiwi-man/KIWI::images.sh.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::images.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 07/19/2010
+.\&quot;      Date: Created: 07/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI 4.43
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 07/19/2010&quot; &quot;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 07/22/2010&quot; &quot;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/KIWI::kiwirc.1 b/doc/kiwi-man/KIWI::kiwirc.1
index b0f2b06..0eedca0 100644
--- a/doc/kiwi-man/KIWI::kiwirc.1
+++ b/doc/kiwi-man/KIWI::kiwirc.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::kiwirc
 .\&quot;    Author: Robert Schweikert &lt;rschweikert (AT) novell.com&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 07/19/2010
+.\&quot;      Date: Created: 07/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: &gt;KIWI 4.43
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::KIWIRC&quot; &quot;1&quot; &quot;Created: 07/19/2010&quot; &quot;&gt;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::KIWIRC&quot; &quot;1&quot; &quot;Created: 07/22/2010&quot; &quot;&gt;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/kiwi.1 b/doc/kiwi-man/kiwi.1
index 213821c..c809bc0 100644
--- a/doc/kiwi-man/kiwi.1
+++ b/doc/kiwi-man/kiwi.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Schaefer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 07/19/2010
+.\&quot;      Date: Created: 07/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI 4.43
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 07/19/2010&quot; &quot;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 07/22/2010&quot; &quot;KIWI 4\&amp;.43&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi.pdf b/doc/kiwi.pdf
index 4097eef..c2a1281 100644
Binary files a/doc/kiwi.pdf and b/doc/kiwi.pdf differ
diff --git a/modules/KIWIConfig.sh b/modules/KIWIConfig.sh
index 268b65a..3e10fb2 100644
--- a/modules/KIWIConfig.sh
+++ b/modules/KIWIConfig.sh
@@ -970,7 +970,7 @@ function suseStripInitrd {
 		lvchange lvresize lvextend lvcreate grub dcounter tty
 		dmsetup dialog awk gawk clicfs cryptsetup clear blkid fbiterm
 		gettext diff bc utimer cmp busybox kexec pam_console_apply
-		setterm kpartx
+		setterm kpartx vgcfgbackup vgcfgrestore
 	&quot;
 	tools=&quot;$tools $@&quot;
 	for path in /sbin /usr/sbin /usr/bin /bin;do
diff --git a/modules/KIWILinuxRC.sh b/modules/KIWILinuxRC.sh
index aa1dae9..3b9a2dc 100644
--- a/modules/KIWILinuxRC.sh
+++ b/modules/KIWILinuxRC.sh
@@ -5651,6 +5651,32 @@ function createFilesystem {
 	fi
 }
 #======================================
+# restoreLVMMetadata
+#--------------------------------------
+function restoreLVMPhysicalVolumes {
+	# /.../
+	# restore the pysical volumes by the given restore file
+	# created from vgcfgbackup. It's important to create them
+	# with the same uuid's compared to the restore file
+	# ----
+	local restorefile=$1
+	cat $restorefile | grep -A2 -E 'pv[0-9] {' | while read line;do
+		if [ -z &quot;$uuid&quot; ];then
+			uuid=$(echo $line | grep 'id =' |\
+				cut -f2 -d= | tr -d \&quot;)
+		fi
+		if [ -z &quot;$pdev&quot; ];then
+			pdev=$(echo $line|grep 'device =' |\
+				cut -f2 -d\&quot; | cut -f1 -d\&quot;)
+		fi
+		if [ ! -z &quot;$pdev&quot; ];then
+			pvcreate -u $uuid $pdev
+			unset uuid
+			unset pdev
+		fi
+	done
+}
+#======================================
 # pxeSizeToMB
 #--------------------------------------
 function pxeSizeToMB {
diff --git a/modules/KIWIMigrate.txt b/modules/KIWIMigrate.txt
index 02a76a5..45231f9 100644
--- a/modules/KIWIMigrate.txt
+++ b/modules/KIWIMigrate.txt
@@ -10,3 +10,4 @@ openSUSE-10.3=suse-10.3
 openSUSE-11.0=suse-11.0
 openSUSE-11.1=suse-11.1
 openSUSE-11.2=suse-11.2
+openSUSE-11.3=suse-11.3
diff --git a/modules/KIWISchema.rnc b/modules/KIWISchema.rnc
index e625d8c..849545a 100644
--- a/modules/KIWISchema.rnc
+++ b/modules/KIWISchema.rnc
@@ -34,6 +34,7 @@ db:info [
 size-type = xsd:token {pattern = &quot;\d*|image&quot;}
 volume-size-type = xsd:token {pattern = &quot;\d+|\d+M|\d+G&quot;}
 image-name = xsd:token {pattern = &quot;[^\s/]+&quot;}
+locale-name = xsd:token {pattern = &quot;[a-z]{2}_[A-Z]{2}(,[a-z]{2}_[A-Z]{2})*&quot;}
 
 #==========================================
 # start with image description
@@ -453,7 +454,7 @@ div { # locale
 		]
 		element locale {
 			k.locale.attlist,
-			text
+			locale-name
 		}
 }
 
diff --git a/modules/KIWISchema.rng b/modules/KIWISchema.rng
index dbc8ec0..2ec7d7f 100644
--- a/modules/KIWISchema.rng
+++ b/modules/KIWISchema.rng
@@ -42,6 +42,11 @@
       &lt;param name=&quot;pattern&quot;&gt;[^\s/]+&lt;/param&gt;
     &lt;/data&gt;
   &lt;/define&gt;
+  &lt;define name=&quot;locale-name&quot;&gt;
+    &lt;data type=&quot;token&quot;&gt;
+      &lt;param name=&quot;pattern&quot;&gt;[a-z]{2}_[A-Z]{2}(,[a-z]{2}_[A-Z]{2})*&lt;/param&gt;
+    &lt;/data&gt;
+  &lt;/define&gt;
   &lt;!--
     ==========================================
     start with image description
@@ -644,7 +649,7 @@ specifies the where to find the boot kernel.&lt;/db:para&gt;
         &lt;a:documentation&gt;Image locale setup.&lt;/a:documentation&gt;
         &lt;db:para&gt;The value will be part of /etc/sysconfig/keyboard&lt;/db:para&gt;
         &lt;ref name=&quot;k.locale.attlist&quot;/&gt;
-        &lt;text/&gt;
+        &lt;ref name=&quot;locale-name&quot;/&gt;
       &lt;/element&gt;
     &lt;/define&gt;
   &lt;/div&gt;
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index 3631c27..0c1de70 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -1,12 +1,25 @@
 -------------------------------------------------------------------
-Fri Jul 16 15:01:09 CEST 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
-
-- fixed Makefile boot image md5 creation time
-- added suport for the btrfs filesystem (bnc #596205)
+Tue Jul 20 17:17:02 CEST 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
+
+- fixed locale validation and documentation as well as
+  some template examples provided by kiwi. The locale value
+  in kiwi is always a UTF-8 locale therefore it's not
+  allowed to add the encoding type to the locale string.
+  We also support the xx_XX locale style only which is
+  now all checked by the schema (bnc #620789)
 - added main::isize function to replace the use of
   the -s operator. This is done because of SUSE Studio
   which maps a file to a block special under certain
   circumstances which causes -s to not work anymore
+- fixed oem recovery for LVM based images. It's required
+  to backup the LVM metadata in order to restore it
+- fixed suse-11.3/suse-pxe-client/config.xml
+
+-------------------------------------------------------------------
+Fri Jul 16 15:01:09 CEST 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
+
+- fixed Makefile boot image md5 creation time
+- added suport for the btrfs filesystem (bnc #596205)
 
 -------------------------------------------------------------------
 Thu Jul 15 15:59:20 CEST 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
diff --git a/system/boot/ix86/oemboot/suse-linuxrc b/system/boot/ix86/oemboot/suse-linuxrc
index b7ce8e9..2083b85 100755
--- a/system/boot/ix86/oemboot/suse-linuxrc
+++ b/system/boot/ix86/oemboot/suse-linuxrc
@@ -118,14 +118,6 @@ function setupInitialDeviceNames {
 		export haveLuks=yes
 	fi
 	#======================================
-	# Check root filesystem type
-	#--------------------------------------
-	if [ &quot;$FSTYPE&quot; = &quot;unknown&quot; ];then
-		systemException \
-			&quot;Couldn't determine filesystem type... abort&quot; \
-		&quot;reboot&quot;
-	fi
-	#======================================
 	# Check for LUKS extension on rw fs
 	#--------------------------------------
 	if isFSTypeReadOnly;then
@@ -323,7 +315,7 @@ if [ ! -z &quot;$KIWI_RECOVERY&quot; ];then
 		systemException &quot;Failed to mount recovery device&quot; &quot;reboot&quot;
 	fi
 	#======================================
-	# 16.2) restore MBR in restore mode
+	# 16.2) restore MBR/LVM in restore mode
 	#--------------------------------------
 	if [ ! -z &quot;$RESTORE&quot; ];then
 		if ! dd if=/reco-save/mbr of=$imageDiskDevice;then
@@ -335,6 +327,13 @@ if [ ! -z &quot;$KIWI_RECOVERY&quot; ];then
 		if ! mount -o ro $imageRecoveryDevice /reco-save &gt;/dev/null;then
 			systemException &quot;Failed to remount recovery device&quot; &quot;reboot&quot;
 		fi
+		if [ -f /reco-save/lvm ];then
+			restoreLVMPhysicalVolumes /reco-save/lvm
+			if ! vgcfgrestore -f /reco-save/lvm $VGROUP;then
+				systemException &quot;Failed to restore LVM metadata&quot; &quot;reboot&quot;
+			fi
+			setupInitialDeviceNames
+		fi
 	fi
 	#======================================
 	# 16.3) restore root archive
diff --git a/system/boot/ix86/oemboot/suse-repart b/system/boot/ix86/oemboot/suse-repart
index cffb19f..30fe2ee 100755
--- a/system/boot/ix86/oemboot/suse-repart
+++ b/system/boot/ix86/oemboot/suse-repart
@@ -613,6 +613,11 @@ function OEMRepart {
 			systemException &quot;Failed to store MBR&quot; &quot;reboot&quot;
 		fi
 		if [ ! -z &quot;$haveLVM&quot; ];then
+			if ! vgcfgbackup -f /reco-save/lvm $VGROUP;then
+				systemException &quot;Failed to store LVM metadata&quot; &quot;reboot&quot;
+			fi
+		fi
+		if [ ! -z &quot;$haveLVM&quot; ];then
 			umount /reco-root/boot
 			umount /recoboot &amp;&amp; rmdir /recoboot
 		fi


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002437.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-374-SuSE-11-1-SLE-SP-Devel,	updated. 4530e855d0892e4c2d5f0cf407909f6797293c80
</A></li>
	<LI>Next message: <A HREF="002439.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. b3d0a7fdac2fcda5c26c5eb6a85de1cbd3e76d05
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2438">[ date ]</a>
              <a href="thread.html#2438">[ thread ]</a>
              <a href="subject.html#2438">[ subject ]</a>
              <a href="author.html#2438">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
