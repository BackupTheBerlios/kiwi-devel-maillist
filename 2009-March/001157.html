<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 342ce3e86fdcd1923883d08b8cc1b9fa525c2c90
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%20342ce3e86fdcd1923883d08b8cc1b9fa525c2c90&In-Reply-To=%3C200903311418.n2VEIV0r030779%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001156.html">
   <LINK REL="Next"  HREF="001158.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 342ce3e86fdcd1923883d08b8cc1b9fa525c2c90</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%20342ce3e86fdcd1923883d08b8cc1b9fa525c2c90&In-Reply-To=%3C200903311418.n2VEIV0r030779%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 342ce3e86fdcd1923883d08b8cc1b9fa525c2c90">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Tue Mar 31 16:18:31 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001156.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 651e14dd5587b92ee496dc008d2e98e56e76f627
</A></li>
        <LI>Next message: <A HREF="001158.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3e77fa22d454c9dcaa7900117b8c14c27e7907c2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1157">[ date ]</a>
              <a href="thread.html#1157">[ thread ]</a>
              <a href="subject.html#1157">[ subject ]</a>
              <a href="author.html#1157">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  342ce3e86fdcd1923883d08b8cc1b9fa525c2c90 (commit)
      from  651e14dd5587b92ee496dc008d2e98e56e76f627 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 342ce3e86fdcd1923883d08b8cc1b9fa525c2c90
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Tue Mar 31 16:18:17 2009 +0200

    - v3.40
    - update manual pages. Patch by Peter Schinagl &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">peters at suse.de</A>&gt;
    - added functions to run X inside preinit (bnc #486758)

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/kiwi-man/KIWI::config.sh.1 b/doc/kiwi-man/KIWI::config.sh.1
index 718d081..bb2c43c 100644
--- a/doc/kiwi-man/KIWI::config.sh.1
+++ b/doc/kiwi-man/KIWI::config.sh.1
@@ -1,11 +1,11 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 03/25/2009
+.\&quot;      Date: Created: 03/31/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v2.10, r938
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/25/2009&quot; &quot;KIWI v2\.10, r938&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/31/2009&quot; &quot;KIWI v2\.10, r938&quot; &quot;KIWI Manualpage&quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
@@ -60,31 +60,101 @@ Umount the system filesystems /proc /dev/pts /sys
 Search all home directories of all users listed in /etc/passwd and change the ownership of all files to belong to the correct user and group
 .RE
 .PP
+[baseSetupBoot]
+.RS 4
+Set up the linuxrc as init
+.RE
+.PP
+[baseSetupBusyBox {\-f}]
+.RS 4
+activates busybox if installed for all links from the busybox/busybox\.links file \- you can choose custom apps to be forced into busybox with the &quot;\-f&quot; option as first parameter example: baseSetupBusyBox \-f /bin/zcat /bin/vi
+.RE
+.PP
+[baseStripRPM]
+.RS 4
+remove rpms defined in config\.xml under image=delete section
+.RE
+.PP
+[baseStripUnusedLibs]
+.RS 4
+remove libraries which are not directly linked against applications in the bin directories
+.RE
+.PP
+[baseUpdateSysConfig {filename} {variable} {value}]
+.RS 4
+update sysconfig variable contents
+.RE
+.PP
+[baseGetPackagesForDeletion]
+.RS 4
+Return the name(s) of packages which will be deleted
+.RE
+.PP
 [baseGetProfilesUsed]
 .RS 4
 Return the name(s) of profiles used to build this image
 .RE
 .PP
-[baseSetupInPlaceSVNRepository]
+[baseSetupInPlaceSVNRepository {path_list}]
 .RS 4
 Create an in place subversion repository for the specified directories\. A standard call could look like this baseSetupInPlaceSVNRepository /etc /srv /var/log
 .RE
 .PP
+[baseSetupPlainTextGITRepository]
+.RS 4
+Create an in place git repository of the root directory containing all plain/text files\.
+.RE
+.PP
 [baseSetupInPlaceGITRepository]
 .RS 4
 Create an in place git repository of the root directory\. This process may take some time and you may expect problems with binary data handling
 .RE
 .PP
-[suseInsertService]
+[baseStripMans {list of manpages to keep}]
+.RS 4
+remove all manual pages, except one given as parameter example: baseStripMans more less
+.RE
+.PP
+[baseStripDocs {list of docu names to keep}]
+.RS 4
+remove all documentation, except one given as parameter
+.RE
+.PP
+[baseStripLocales {list of locales}]
+.RS 4
+remove all locales, except one given as parameter
+.RE
+.PP
+[baseStripInfos {list of info\-files to keep}]
+.RS 4
+remove all info files, except one given as parameter
+.RE
+.PP
+[baseStripAndKeep {list of info\-files to keep}]
+.RS 4
+helper function for strip* functions read stdin lines of files to check for removing params: files which should be keep
+.RE
+.PP
+[baseStripTools {list of toolpath} {list of tools}]
+.RS 4
+helper function for suseStripInitrd function params: toolpath , tools
+.RE
+.PP
+[suseInsertService {servicename}]
 .RS 4
 Recursively insert a service\. If there is a service required for this service it will be inserted first\. The suse insserv program is used here
 .RE
 .PP
-[suseRemoveService]
+[suseRemoveService {servicename}]
 .RS 4
 Remove a service and its dependant services using the suse insserv program
 .RE
 .PP
+[suseStripPackager {\-a}]
+.RS 4
+Remove smart o zypper packages and db files Also remove rpm package and db if &quot;\-a&quot; given
+.RE
+.PP
 [suseActivateServices]
 .RS 4
 Check all services in /etc/init\.d/ and activate them by calling suseInsertService
@@ -95,14 +165,14 @@ Check all services in /etc/init\.d/ and activate them by calling suseInsertServi
 Call all postin scriptlets which among other things activates all required default services using suseInsertService
 .RE
 .PP
-[suseService]
+[suseService {servicename} {on|off}]
 .RS 4
 Activate/Deactivate a service by using the chkconfig program The function requires the service name and the value on or off as parameters
 .RE
 .PP
 [suseServiceDefaultOn]
 .RS 4
-Activates the following services to be on by default using the chkconfig program: boot\.rootfsck boot\.cleanup boot\.localfs boot\.localnet boot\.clock policykitd haldaemon network atd syslog cron
+Activates the following services to be on by default using the chkconfig program: boot\.rootfsck boot\.cleanup boot\.localfs boot\.localnet boot\.clock policykitd dbus consolekt haldaemon network atd syslog cron kbd
 .RE
 .PP
 [suseConfig]
@@ -110,10 +180,35 @@ Activates the following services to be on by default using the chkconfig program
 Setup keytable language and timezone if specified in config\.xml and call SuSEconfig afterwards
 .RE
 .PP
+[suseCloneRunlevel {runlevel}]
+.RS 4
+Clone the given runlevel to work in the same way as the default runlevel 3\.
+.RE
+.PP
 [suseSetupProductInformation]
 .RS 4
 This function will use zypper to search for the installed product and install all product specific packages\. This function only makes sense if zypper is used as packagemanager
 .RE
+.PP
+[Rm {list of files}]
+.RS 4
+Helper function to delete files and anounce it to log
+.RE
+.PP
+[Rpm {rpm commandline}]
+.RS 4
+Helper function to the rpm function and anounce it to log
+.RE
+.PP
+[Echo {echo commandline}]
+.RS 4
+Helper function to print a message to the controling terminal
+.RE
+.PP
+[Debug {message}]
+.RS 4
+Helper function to print a message if the variable DEBUG is set to 1
+.RE
 .SH &quot;PROFILE ENVIRONMENT VARIABLES&quot;
 .PP
 The \.profile environment file contains a specific set of variables which are listed below\. Some of the functions above makes use of the variables\.
@@ -123,7 +218,7 @@ The \.profile environment file contains a specific set of variables which are li
 The name of the image as listed in config\.xml
 .RE
 .PP
-[$keytablee]
+[$keytable]
 .RS 4
 The contents of the keytable setup as done in config\.xml
 .RE
diff --git a/doc/kiwi-man/KIWI::images.sh.1 b/doc/kiwi-man/KIWI::images.sh.1
index 74a3510..6476ff7 100644
--- a/doc/kiwi-man/KIWI::images.sh.1
+++ b/doc/kiwi-man/KIWI::images.sh.1
@@ -1,11 +1,11 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 03/25/2009
+.\&quot;      Date: Created: 03/31/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v2.10, r938
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/25/2009&quot; &quot;KIWI v2\.10, r938&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/31/2009&quot; &quot;KIWI v2\.10, r938&quot; &quot;KIWI Manualpage&quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
@@ -63,7 +63,12 @@ Return the name(s) of profiles used to build this image
 Return the list of packages setup in the packages type=\'delete\' section of the config\.xml used to build this image
 .RE
 .PP
-[suseGFXBoot]
+[baseSetupOEMPartition]
+.RS 4
+Writes the file /config\.oempartition depending on the following config\.xml parameters: oem\-reboot, oem\-swapsize, oem\-systemsize, oem\-home,oem\-swap,oem\-boot\-title,oem\-recovery, oem\-kiwi\-initrd\. kiwi takes the information from config\.xml and creates the config\.oempartition file as part of the automatically created boot image (initrd)\. The information must be available as part of the boot image because it controls the OEM repartition workflow on first boot of an OEM image\. Detailed information about the meaning of each option can be found in the OEM chapter in the kiwi cookbook
+.RE
+.PP
+[suseGFXBoot {theme} {loadertyp}]
 .RS 4
 This function requires the gfxboot and at least one bootsplash\-theme\-* package to be installed in order to work correctly\. The function creates from this package data a graphics boot screen for the isolinux and grub boot loaders\. Additionally it creates the bootsplash files for the resolutions 800x600 1024x768 and 1280x1024
 .RE
@@ -77,6 +82,26 @@ This function removes all kernel drivers which are not listed in the *drivers se
 .RS 4
 This function removes a whole bunch of tools binaries and libraries which are not required in order to boot a suse system with kiwi\.
 .RE
+.PP
+[Rm {list of files}]
+.RS 4
+Helper function to delete files and anounce it to log
+.RE
+.PP
+[Rpm {rpm commandline}]
+.RS 4
+Helper function to the rpm function and anounce it to log
+.RE
+.PP
+[Echo {echo commandline}]
+.RS 4
+Helper function to print a message to the controling terminal
+.RE
+.PP
+[Debug {message}]
+.RS 4
+Helper function to print a message if the variable DEBUG is set to 1
+.RE
 .SH &quot;PROFILE ENVIRONMENT VARIABLES&quot;
 .PP
 The \.profile environment file contains a specific set of variables which are listed below\. Some of the functions above makes use of the variables\.
diff --git a/doc/kiwi-man/kiwi-man-config.sh.xml b/doc/kiwi-man/kiwi-man-config.sh.xml
index 4b4116d..e360c7e 100644
--- a/doc/kiwi-man/kiwi-man-config.sh.xml
+++ b/doc/kiwi-man/kiwi-man-config.sh.xml
@@ -99,6 +99,58 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
+        &lt;term&gt;&lt;optional&gt;baseSetupBoot&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             Set up the linuxrc as init
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseSetupBusyBox {-f}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             activates busybox if installed for all links from
+             the busybox/busybox.links file - you can choose custom apps to
+             be forced into busybox with the &quot;-f&quot; option as first parameter
+             example: baseSetupBusyBox -f /bin/zcat /bin/vi
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+        &lt;term&gt;&lt;optional&gt;baseStripRPM&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             remove rpms defined in config.xml under image=delete section
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+        &lt;term&gt;&lt;optional&gt;baseStripUnusedLibs&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             remove libraries which are not directly linked
+             against applications in the bin directories
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseUpdateSysConfig {filename} {variable} {value}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+           &lt;para&gt;
+             update sysconfig variable contents
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+        &lt;term&gt;&lt;optional&gt;baseGetPackagesForDeletion&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Return the name(s) of packages which will be deleted
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
         &lt;term&gt;&lt;optional&gt;baseGetProfilesUsed&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
@@ -107,12 +159,21 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;&lt;optional&gt;baseSetupInPlaceSVNRepository&lt;/optional&gt;&lt;/term&gt;
+         &lt;term&gt;&lt;optional&gt;baseSetupInPlaceSVNRepository {path_list}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Create an in place subversion repository for the
+            specified directories. A standard call could look like this
+            baseSetupInPlaceSVNRepository /etc /srv /var/log 
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+        &lt;term&gt;&lt;optional&gt;baseSetupPlainTextGITRepository&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
-           Create an in place subversion repository for the
-           specified directories. A standard call could look like this
-           baseSetupInPlaceSVNRepository /etc /srv /var/log 
+            Create an in place git repository of the root
+            directory containing all plain/text files.
           &lt;/para&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
@@ -127,7 +188,59 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;&lt;optional&gt;suseInsertService&lt;/optional&gt;&lt;/term&gt;
+         &lt;term&gt;&lt;optional&gt;baseStripMans {list of manpages to keep}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             remove all manual pages, except one given as parameter
+             example: baseStripMans more less
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseStripDocs {list of docu names to keep}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             remove all documentation, except one given as parameter
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseStripLocales {list of locales}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+           &lt;para&gt;
+             remove all locales, except one given as parameter
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+     &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseStripInfos {list of info-files to keep}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+           &lt;para&gt;
+             remove all info files, except one given as parameter
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+     &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseStripAndKeep {list of info-files to keep}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+           &lt;para&gt;
+              helper function for strip* functions
+              read stdin lines of files to check for removing
+              params: files which should be keep
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+     &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;baseStripTools {list of toolpath} {list of tools}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+           &lt;para&gt;
+              helper function for suseStripInitrd function
+              params: toolpath , tools
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+     &lt;/varlistentry&gt;
+     &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;suseInsertService {servicename}&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
             Recursively insert a service. If there is a service
@@ -137,7 +250,7 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;&lt;optional&gt;suseRemoveService&lt;/optional&gt;&lt;/term&gt;
+         &lt;term&gt;&lt;optional&gt;suseRemoveService {servicename}&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
             Remove a service and its dependant services
@@ -146,6 +259,15 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;suseStripPackager {-a}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             Remove smart o zypper packages and db files
+             Also remove rpm package and db if &quot;-a&quot; given
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
         &lt;term&gt;&lt;optional&gt;suseActivateServices&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
@@ -164,7 +286,7 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;&lt;optional&gt;suseService&lt;/optional&gt;&lt;/term&gt;
+         &lt;term&gt;&lt;optional&gt;suseService {servicename} {on|off}&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
             Activate/Deactivate a service by using the chkconfig program
@@ -173,13 +295,13 @@ exit&lt;/programlisting&gt;
           &lt;/para&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
-      &lt;varlistentry&gt;
+	  &lt;varlistentry&gt;
         &lt;term&gt;&lt;optional&gt;suseServiceDefaultOn&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
             Activates the following services to be on by default using the
             chkconfig program: boot.rootfsck boot.cleanup boot.localfs boot.localnet
-            boot.clock policykitd haldaemon network atd syslog cron
+            boot.clock policykitd dbus consolekt haldaemon network atd syslog cron kbd
           &lt;/para&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
@@ -191,6 +313,15 @@ exit&lt;/programlisting&gt;
             call SuSEconfig afterwards
           &lt;/para&gt;
         &lt;/listitem&gt;
+     &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;suseCloneRunlevel {runlevel}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Clone the given runlevel to work in the same way
+            as the default runlevel 3.
+          &lt;/para&gt;
+        &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
         &lt;term&gt;&lt;optional&gt;suseSetupProductInformation&lt;/optional&gt;&lt;/term&gt;
@@ -201,6 +332,39 @@ exit&lt;/programlisting&gt;
             only makes sense if zypper is used as packagemanager
           &lt;/para&gt;
         &lt;/listitem&gt;
+     &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Rm {list of files}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to delete files and anounce it to log
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Rpm {rpm commandline}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to the rpm function and anounce it to log
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Echo {echo commandline}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to print a message to the controling terminal
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Debug {message}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to print a message 
+            if the variable DEBUG is set to 1
+          &lt;/para&gt;
+        &lt;/listitem&gt;
       &lt;/varlistentry&gt;
     &lt;/variablelist&gt;
   &lt;/refsect1&gt;
@@ -221,7 +385,7 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;&lt;optional&gt;$keytablee&lt;/optional&gt;&lt;/term&gt;
+        &lt;term&gt;&lt;optional&gt;$keytable&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
             The contents of the keytable setup as done in config.xml
diff --git a/doc/kiwi-man/kiwi-man-images.sh.xml b/doc/kiwi-man/kiwi-man-images.sh.xml
index 82f050b..2dcfb60 100644
--- a/doc/kiwi-man/kiwi-man-images.sh.xml
+++ b/doc/kiwi-man/kiwi-man-images.sh.xml
@@ -104,7 +104,24 @@ exit&lt;/programlisting&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;&lt;optional&gt;suseGFXBoot&lt;/optional&gt;&lt;/term&gt;
+        &lt;term&gt;&lt;optional&gt;baseSetupOEMPartition&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+             Writes the file /config.oempartition depending on the following
+             config.xml parameters: oem-reboot, oem-swapsize, oem-systemsize,
+			 oem-home,oem-swap,oem-boot-title,oem-recovery, oem-kiwi-initrd.
+			 kiwi takes the information from config.xml and creates the
+			 config.oempartition file as part of the automatically created
+             boot image (initrd). The information must be available as part
+             of the boot image because it controls the OEM repartition
+             workflow on first boot of an OEM image. Detailed information
+             about the meaning of each option can be found in the OEM
+             chapter in the kiwi cookbook
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;suseGFXBoot {theme} {loadertyp}&lt;/optional&gt;&lt;/term&gt;
         &lt;listitem&gt;
           &lt;para&gt;
             This function requires the gfxboot and at least one bootsplash-theme-*
@@ -133,6 +150,39 @@ exit&lt;/programlisting&gt;
           &lt;/para&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Rm {list of files}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to delete files and anounce it to log
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Rpm {rpm commandline}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to the rpm function and anounce it to log
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Echo {echo commandline}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to print a message to the controling terminal
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
+      &lt;varlistentry&gt;
+         &lt;term&gt;&lt;optional&gt;Debug {message}&lt;/optional&gt;&lt;/term&gt;
+        &lt;listitem&gt;
+          &lt;para&gt;
+            Helper function to print a message 
+            if the variable DEBUG is set to 1
+          &lt;/para&gt;
+        &lt;/listitem&gt;
+      &lt;/varlistentry&gt;
     &lt;/variablelist&gt;
   &lt;/refsect1&gt;
   &lt;refsect1 id=&quot;kiwi.config.environment&quot;&gt;
diff --git a/doc/kiwi-man/kiwi.1 b/doc/kiwi-man/kiwi.1
index 0b88cc6..712b4c1 100644
--- a/doc/kiwi-man/kiwi.1
+++ b/doc/kiwi-man/kiwi.1
@@ -1,11 +1,11 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Schaefer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 03/25/2009
+.\&quot;      Date: Created: 03/31/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.25
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/25/2009&quot; &quot;KIWI v3\.25&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/31/2009&quot; &quot;KIWI v3\.25&quot; &quot;KIWI Manualpage&quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
diff --git a/kiwi.pl b/kiwi.pl
index ae4771c..16bb1d7 100755
--- a/kiwi.pl
+++ b/kiwi.pl
@@ -44,7 +44,7 @@ use KIWITest;
 #============================================
 # Globals (Version)
 #--------------------------------------------
-our $Version       = &quot;3.39&quot;;
+our $Version       = &quot;3.40&quot;;
 our $Publisher     = &quot;SUSE LINUX Products GmbH&quot;;
 our $Preparer      = &quot;KIWI - <A HREF="http://kiwi.berlios.de">http://kiwi.berlios.de</A>&quot;;
 our $openSUSE      = &quot;<A HREF="http://download.opensuse.org">http://download.opensuse.org</A>&quot;;
diff --git a/modules/KIWIConfig.sh b/modules/KIWIConfig.sh
index 44c216c..05a6560 100644
--- a/modules/KIWIConfig.sh
+++ b/modules/KIWIConfig.sh
@@ -506,7 +506,7 @@ function suseStripPackager {
 	fi
 }
 #======================================
-# suseStripRPM
+# baseStripRPM
 #--------------------------------------
 function baseStripRPM {
 	# /.../
diff --git a/modules/KIWILinuxRC.sh b/modules/KIWILinuxRC.sh
index f5130e4..53526de 100644
--- a/modules/KIWILinuxRC.sh
+++ b/modules/KIWILinuxRC.sh
@@ -3994,6 +3994,74 @@ function makeLabel {
 	fi
 }
 #======================================
+# waitForX
+#--------------------------------------
+function waitForX {
+	# /.../
+	# wait for the X-Server with PID $xserver_pid to
+	# become read for client calls
+	# ----
+	local xserver_pid=$1
+	local testx=/usr/sbin/testX
+	local err=1
+	while kill -0 $xserver_pid 2&gt;/dev/null ; do
+		sleep 1
+		if test -e /tmp/.X11-unix/X0 &amp;&amp; test -x $testx ; then
+			$testx 16 2&gt;/dev/null
+			err=$?
+			# exit code 1 -&gt; XOpenDisplay failed...
+			if test $err = 1;then
+				Echo &quot;TestX: XOpenDisplay failed&quot;
+				return 1
+			fi
+			# exit code 2 -&gt; color or dimensions doesn't fit...
+			if test $err = 2;then
+				Echo &quot;TestX: color or dimensions doesn't fit&quot;
+				kill $xserver_pid
+				return 1
+			fi
+			# server is running, detach oom-killer from it
+			echo -n '-17' &gt; /proc/$xserver_pid/oom_adj
+			return 0
+		fi
+	done
+	return 1
+}
+#======================================
+# startX
+#--------------------------------------
+function startX {
+	# /.../
+	# start X-Server and wait for it to become ready
+	# ----
+	export DISPLAY=:0
+	local XServer=/usr/bin/Xorg
+	if [ -x /usr/X11R6/bin/Xorg ];then
+		XServer=/usr/X11R6/bin/Xorg
+	fi
+	$XServer -deferglyphs 16 vt07 &amp;
+	export XServerPID=$!
+	if ! waitForX $XServerPID;then
+		Echo &quot;Failed to start X-Server&quot;
+		return 1
+	fi
+	return 0
+}
+#======================================
+# stoppX
+#--------------------------------------
+function stoppX {
+	if [ -z &quot;$XServerPID&quot; ];then
+		return
+	fi
+	if kill -0 $XServerPID 2&gt;/dev/null; then
+		sleep 1 &amp;&amp; kill $XServerPID
+		while kill -0 $XServerPID 2&gt;/dev/null; do
+			sleep 1
+		done
+	fi
+}
+#======================================
 # SAPMemCheck
 #--------------------------------------
 function SAPMemCheck {
@@ -4204,3 +4272,11 @@ function SAPDataStorageSetup {
 		systemException &quot;Failed to create sapdata volume&quot; &quot;reboot&quot;
 	fi
 }
+#======================================
+# SAPStartMediaChanger
+#--------------------------------------
+function SAPStartMediaChanger {
+	startX
+	yast2 inst_sap_wrapper
+	stoppX
+}
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index 4220893..f577ef8 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -1,4 +1,11 @@
 -------------------------------------------------------------------
+Tue Mar 31 14:44:21 CEST 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
+
+- v3.40
+- update manual pages. Patch by Peter Schinagl &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">peters at suse.de</A>&gt;
+- added functions to run X inside preinit (bnc #486758)
+
+-------------------------------------------------------------------
 Mon Mar 30 11:31:54 CEST 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 
 - v3.39
diff --git a/rpm/kiwi.spec b/rpm/kiwi.spec
index ec925ee..8a2d127 100644
--- a/rpm/kiwi.spec
+++ b/rpm/kiwi.spec
@@ -1,5 +1,5 @@
 #
-# spec file for package kiwi (Version 3.39)
+# spec file for package kiwi (Version 3.40)
 #
 # Copyright (c) 2008 SUSE LINUX Products GmbH, Nuernberg, Germany.
 # This file and all modifications and additions to the pristine
@@ -46,7 +46,7 @@ Requires:       satsolver-tools
 Summary:        OpenSuSE - KIWI Image System
 Provides:       kiwi2 &lt;= 2.14
 Obsoletes:      kiwi2 &lt;= 2.14
-Version:        3.39
+Version:        3.40
 Release:        80
 Group:          System/Management
 License:        GPL v2 or later
diff --git a/system/boot/ix86/oemboot/suse-preinit b/system/boot/ix86/oemboot/suse-preinit
index e7d538f..67bad1e 100755
--- a/system/boot/ix86/oemboot/suse-preinit
+++ b/system/boot/ix86/oemboot/suse-preinit
@@ -84,7 +84,14 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ];then
 fi
 
 #======================================
-# 9) kill udev
+# 9) Run SAP media changer if activated
+#--------------------------------------
+if [ ! -z &quot;$OEM_SAP_INSTALL&quot; ];then
+	SAPStartMediaChanger
+fi
+
+#======================================
+# 10) kill udev
 #--------------------------------------
 udevKill
 umountSystemFilesystems


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001156.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 651e14dd5587b92ee496dc008d2e98e56e76f627
</A></li>
	<LI>Next message: <A HREF="001158.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3e77fa22d454c9dcaa7900117b8c14c27e7907c2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1157">[ date ]</a>
              <a href="thread.html#1157">[ thread ]</a>
              <a href="subject.html#1157">[ subject ]</a>
              <a href="author.html#1157">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
