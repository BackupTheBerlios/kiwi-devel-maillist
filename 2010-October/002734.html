<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 286c2c76895dde2b020d071ca153ebf1b8d70364
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2010-October/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%20286c2c76895dde2b020d071ca153ebf1b8d70364&In-Reply-To=%3C20101014110456.14E27480E49%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002733.html">
   <LINK REL="Next"  HREF="002735.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 286c2c76895dde2b020d071ca153ebf1b8d70364</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%20286c2c76895dde2b020d071ca153ebf1b8d70364&In-Reply-To=%3C20101014110456.14E27480E49%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 286c2c76895dde2b020d071ca153ebf1b8d70364">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Thu Oct 14 13:04:55 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002733.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 43f683bef2c6a1569a4868cba82ead343b8a18fe
</A></li>
        <LI>Next message: <A HREF="002735.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 122ad6d5199420d742a7af8387b3fa299a34264b
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2734">[ date ]</a>
              <a href="thread.html#2734">[ thread ]</a>
              <a href="subject.html#2734">[ subject ]</a>
              <a href="author.html#2734">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  286c2c76895dde2b020d071ca153ebf1b8d70364 (commit)
       via  ac96de0916d5eda4c7dd5394b568b19d64580632 (commit)
       via  e60ab1dc80da4364042c631c641e1e58caa23c37 (commit)
      from  43f683bef2c6a1569a4868cba82ead343b8a18fe (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 286c2c76895dde2b020d071ca153ebf1b8d70364
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Wed Oct 13 23:39:11 2010 +0200

    - fixed xenconfig creation, virtual framebuffer line wasn't written

commit ac96de0916d5eda4c7dd5394b568b19d64580632
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Wed Oct 13 23:06:09 2010 +0200

    - fixed suse-11.3/suse-xen-guest example by removing some
      old static sysconfig files. Also remove the boot.xen service
      script it's no longer required as we can use the xvc device
      for the console

commit e60ab1dc80da4364042c631c641e1e58caa23c37
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Wed Oct 13 22:01:06 2010 +0200

    - added support for targetdevice option for filesystem images
    - if the targetdevice option is used check if the device
      exists before proceeding

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/examples/suse-11.3/suse-xen-guest/config.sh b/doc/examples/suse-11.3/suse-xen-guest/config.sh
index 914e1ac..4f35644 100755
--- a/doc/examples/suse-11.3/suse-xen-guest/config.sh
+++ b/doc/examples/suse-11.3/suse-xen-guest/config.sh
@@ -37,7 +37,6 @@ suseSetupProduct
 suseActivateDefaultServices
 suseInsertService boot.device-mapper
 suseInsertService sshd
-suseInsertService boot.xen
 
 #======================================
 # SuSEconfig
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/init.d/boot b/doc/examples/suse-11.3/suse-xen-guest/root/etc/init.d/boot
deleted file mode 100755
index 7572e8d..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/init.d/boot
+++ /dev/null
@@ -1,323 +0,0 @@
-#! /bin/bash
-#
-# Copyright (c) 1996-2004 SuSE Linux AG, Nuernberg, Germany.
-# All rights reserved.
-#
-# Author: Ruediger Oertel &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ro at suse.de</A>&gt;, 1996-2002
-#         Werner Fink &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">werner at suse.de</A>&gt;, 1996-2004
-#         Burchard Steinbild, 1996-2000
-#         Florian La Roche, 1996
-#
-# Please send feedback to <A HREF="http://www.suse.de/feedback">http://www.suse.de/feedback</A>
-#
-# /etc/init.d/boot
-#
-# first script to be executed from init on system startup
-#
-
-#
-# Avoid be interrupted by child or keyboard
-# 
-trap &quot;echo&quot; SIGINT SIGSEGV SIGQUIT
-set +e
-
-#
-# Get terminal size of standard input of the system console
-#
-test -z &quot;$CONSOLE&quot; &amp;&amp; CONSOLE=/dev/console
-set -- $(stty size &lt; $CONSOLE)
-  LINES=$1
-COLUMNS=$2
-export LINES COLUMNS CONSOLE
-
-#
-# Set I/O of this script and its childs to console
-#
-exec 0&lt;&gt; $CONSOLE 1&gt;&amp;0 2&gt;&amp;0
-
-#
-# Export the real device in variable REDIRECT.
-#
-REDIRECT=&quot;`showconsole 2&gt;/dev/null`&quot;
-export REDIRECT
-if test $COLUMNS -eq 0 ; then
-    # Serial: columns and lines are not defined
-      LINES=24
-    COLUMNS=80
-    test &quot;$TERM&quot; = &quot;linux&quot; -o -z &quot;$TERM&quot; &amp;&amp; TERM=vt102
-fi
-
-#
-# Configuration and coloring of the boot messages
-#
-
-. /etc/rc.status
-. /etc/sysconfig/boot
-
-echo -n &quot;System Boot Control: &quot;
-echo &quot;Running $0&quot;
-
-#
-# Start of e.g. blogd, requires /proc and /dev/pts.
-#
-rc_reset
-echo -n &quot;Mounting procfs at /proc&quot;
-mount -n -t proc proc /proc
-rc_status -v -r
-
-echo -n &quot;Mounting sysfs at /sys&quot;
-mount -n -t sysfs sysfs /sys
-rc_status -v -r
-
-if test -d /sys/kernel/debug ; then
-    while read dev type ; do
-	if test &quot;$type&quot; = &quot;debugfs&quot; ; then
-	    echo -n &quot;Mounting debugfs at /sys/kernel/debug&quot;
-	    mount -n -t debugfs debugfs /sys/kernel/debug
-	    rc_status -v -r
-	fi
-    done &lt; /proc/filesystems
-fi
-#
-# mount tmpfs on /dev if not already done by initramfs
-#
-while read dev dir type options; do
-    if test &quot;$dir&quot; = &quot;/dev&quot; -a &quot;$type&quot; = &quot;tmpfs&quot;; then
-	DEV_MOUNTED=1;
-	break;
-    fi
-done &lt; /proc/mounts
-if test -z &quot;$DEV_MOUNTED&quot;; then
-    echo -n &quot;Mounting tmpfs at /dev&quot;
-    mount -n -t tmpfs -o mode=0755 udev /dev
-    rc_status -v -r
-fi
-
-#
-# populate /dev with initial content
-#
-echo -n &quot;Initializing /dev&quot;
-cp --preserve=all --recursive --remove-destination /lib/udev/devices/* /dev
-chmod 1777 /dev/shm
-rc_status -v -r
-
-echo -n &quot;Mounting devpts at /dev/pts&quot;
-mount -n -t devpts -o mode=0620,gid=5 devpts /dev/pts
-rc_status -v -r
-
-#
-# Save old terminal settings and set -nl to avoid staircase
-# effect, do not lock scrolling, and avoid break characters.
-#
-otty=$(stty -g)
-if test &quot;$FLOW_CONTROL&quot; = &quot;yes&quot; ; then
-    stty -nl  ixon ignbrk -brkint
-else
-    stty -nl -ixon ignbrk -brkint
-fi
-
-#
-# Should we ask for interactive boot mode
-#
-DO_CONFIRM=&quot;&quot;
-read -t 2 check &lt; /proc/cmdline 2&gt; /dev/null
-case &quot;$check&quot; in
-    *confirm*) DO_CONFIRM=yes ;;
-esac
-test -z &quot;$CONFIRM_PROMPT_TIMEOUT&quot; &amp;&amp; CONFIRM_PROMPT_TIMEOUT=5
-if test &quot;$PROMPT_FOR_CONFIRM&quot; = &quot;yes&quot; -a &quot;$DO_CONFIRM&quot; != &quot;yes&quot; ; then
-    echo -en &quot;${extd}Enter Interactive startup mode?${norm}&quot;
-    rc_timer_on &quot;$CONFIRM_PROMPT_TIMEOUT&quot; 37
-    read -t &quot;$CONFIRM_PROMPT_TIMEOUT&quot; -n 1 \
-	-p &quot; ${extd}y${norm}/[${extd}n${norm}](&quot;${CONFIRM_PROMPT_TIMEOUT}s&quot;) &quot; answer
-    rc_timer_off
-    case &quot;$answer&quot; in
-    [yYiI]) DO_CONFIRM=yes ;;
-    *)      DO_CONFIRM=    ;;
-    esac
-    unset answer
-    echo
-fi
-export DO_CONFIRM
-
-#
-# Start blogd, requires /proc and /dev/pts.
-# Export the real device in variable REDIRECT.
-#
-test -x /sbin/blogd -a -n &quot;$REDIRECT&quot; &amp;&amp; /sbin/blogd $REDIRECT
-if test -z &quot;$REDIRECT&quot; ; then
-    if (echo -n &gt; /dev/tty) 2&gt;/dev/null ; then
-	REDIRECT=/dev/tty
-    else
-	REDIRECT=/dev/console
-    fi
-fi
-
-#
-# Common used variables
-#
-bootrc=/etc/init.d/boot.d
-rex=&quot;[0-9][0-9]&quot;
-failed=&quot;&quot;
-skipped=&quot;&quot;
-callord=&quot;&quot;
-
-#
-# Initialize boosplash progressbar variables
-#
-. /etc/rc.splash B
-splashtrigger &quot;rlchange B&quot;
-
-#
-# Check if we are able to use make for booting
-#
-test -s /etc/init.d/.depend.boot || RUN_PARALLEL=&quot;no&quot;
-test -s /etc/init.d/Makefile	 || RUN_PARALLEL=&quot;no&quot;
-test &quot;$DO_CONFIRM&quot;   = &quot;yes&quot;	 &amp;&amp; RUN_PARALLEL=&quot;no&quot;
-type -p startpar &amp;&gt; /dev/null    || RUN_PARALLEL=&quot;no&quot;
-startpar -v &amp;&gt; /dev/null	 || RUN_PARALLEL=&quot;no&quot;
-
-#
-# Start bootup client scripts.
-#
-if test &quot;$RUN_PARALLEL&quot; = &quot;yes&quot; ; then
-
-    #
-    # Start scripts in parallel with make behaviour of startpar
-    #
-
-    startopt=&quot;-p4 -t 30 -T 3 $(splashmake)&quot;
-    eval $(startpar $startopt -M boot)
-    failed=&quot;${failed:+$failed }$failed_service&quot;
-    skipped=&quot;${skipped:+$skipped }$skipped_service&quot;
-
-    unset failed_service skipped_service startopt
-
-elif test -d ${bootrc}/ ; then
-
-    #
-    # Start scripts in given link order
-    #
-    for i in ${bootrc}/S${rex}*; do
-
-	test -f $i || continue
-
-	B=${i##*/}
-	script=${B#*S$rex}
-	B=${B%$script}
-
-	if test &quot;$DO_CONFIRM&quot; = &quot;yes&quot; ; then
-	    rc_confirm -t $CONFIRM_PROMPT_TIMEOUT &quot;Start bootup script ${script}&quot; &lt; $REDIRECT &gt; $REDIRECT 2&gt;&amp;1
-	    case &quot;$?&quot; in
-	    0) true     ;;
-	    1) continue ;;
-	    2) DO_CONFIRM=&quot;&quot;
-	    esac
-	fi
-
-	blogger &quot;$script start&quot;
-
-	if test -x &quot;$i&quot; ; then
-		$i start
-	else
-	    echo Running $i
-	    /bin/sh $i b
-	    rc_status -v1 -r
-	fi
-	status=$?
-	echo -en &quot;$rc_reset&quot;
-	splashprogress &quot;$script start&quot;
-
-	case $status in
-	[1-47])  failed=&quot;${failed:+$failed }$script&quot;   ;;
-	[56])   skipped=&quot;${skipped:+$skipped }$script&quot; ;;
-	0|*) ;;
-	esac
-
-	blogger &quot;'$script start' exits with status $status&quot;
-    done
-fi
-
-splashtrigger &quot;rlreached B&quot;
-
-#
-# Be verbose and print stats
-#
-echo -n &quot;System Boot Control: &quot;
-echo -e &quot;The system has been ${stat}${extd}set up${norm}&quot;
-if test -n &quot;$failed&quot; ; then
-    n=$((${#failed} + 7))
-    echo -n  &quot;Failed features: &quot;
-    test $n -lt 47 &amp;&amp; echo -en &quot;\033[${COLUMNS}C\033[${n}D&quot;
-    echo -e  &quot;${warn}${failed}${norm}&quot;
-fi
-if test -n &quot;$skipped&quot; ; then
-    n=$((${#skipped} + 7))
-    echo -n  &quot;Skipped features: &quot;
-    test $n -lt 47 &amp;&amp; echo -en &quot;\033[${COLUMNS}C\033[${n}D&quot;
-    echo -e  &quot;${attn}${skipped}${norm}&quot;
-fi
-
-#
-# Start user defined bootup script.
-#
-if test -f /etc/init.d/boot.local ; then
-    echo -n &quot;System Boot Control: &quot;
-    echo &quot;Running /etc/init.d/boot.local&quot;
-    /bin/sh /etc/init.d/boot.local
-    rc_status -v1 -r
-    splashtrigger &quot;boot.local&quot;
-fi
-
-#
-# Stop blogd
-#
-test -x /sbin/blogd &amp;&amp; killproc -QUIT /sbin/blogd
-
-#
-# Check for boot cycle detection
-#
-test -s /lib/bootcycle/stats &amp;&amp; . /lib/bootcycle/stats
-
-#
-# Remember for master resource script
-#
-if test &quot;$DO_CONFIRM&quot; = &quot;yes&quot; ; then
-    touch /var/run/do_confirm
-fi
-
-#
-# Restore old terminal settings
-#
-stty $otty
-
-# create config file if not yet done
-if [ ! -f /etc/X11/xorg.conf ];then
-	/usr/sbin/sax2 -c 0 -a -i &amp;&gt;/dev/null
-fi
-
-#
-# Let YaST2 finish its installation, if you installed with YaST2
-#
-if test -f /var/lib/YaST2/runme_at_boot ; then
-    HOSTTYPE=$(uname -m)
-    splashtrigger &quot;YaST&quot;
-    exec 0&lt;&gt; $REDIRECT 1&gt;&amp;0 2&gt;&amp;0
-    # if yast2 failed, this ensures proper system setup
-    #ulimit -c unlimited
-    touch /var/lib/YaST2/run_suseconfig
-    if test -x /usr/lib/YaST2/startup/YaST2.Second-Stage; then
-	/usr/lib/YaST2/startup/YaST2.Second-Stage
-    else
-	# oops, yast2 not installed
-	rm -f /var/lib/YaST2/runme_at_boot
-    fi
-fi
-# run SuSEconfig (with args) if needed
-if test -f /var/lib/YaST2/run_suseconfig ; then
-    /sbin/SuSEconfig `cat /var/lib/YaST2/run_suseconfig`
-    rm -f /var/lib/YaST2/run_suseconfig
-fi
-
-rc_reset
-exit 0
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/init.d/boot.xen b/doc/examples/suse-11.3/suse-xen-guest/root/etc/init.d/boot.xen
deleted file mode 100755
index 052c25f..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/init.d/boot.xen
+++ /dev/null
@@ -1,80 +0,0 @@
-#! /bin/sh
-#
-# Copyright (c) 2001-2002 SuSE Linux AG, Nuernberg, Germany.
-# All rights reserved.
-#
-# /etc/init.d/boot.xen
-#
-### BEGIN INIT INFO
-# Provides:          boot.xen
-# Required-Start:    boot.localfs
-# Required-Stop:
-# Default-Start:     B S
-# Default-Stop:
-# Description:       Check and Prepare xen environment
-### END INIT INFO
-
-. /etc/rc.status
-rc_reset
-
-kernel=`uname -r | grep -qi &quot;\-xen&quot; &amp;&amp; echo xen || echo none`
-if [ ! -e /proc/xen/capabilities ]; then
-	domain=native
-elif ! grep control_d /proc/xen/capabilities &gt;/dev/null 2&gt;&amp;1; then
-	domain=domU
-else
-	domain=dom0
-fi
-
-case &quot;$1&quot; in
-    start|restart)
-		#
-		# Check and Prepare xen environment
-		#
-		echo -n &quot;Setting up xen environment&quot;
-		if test ! &quot;$kernel&quot; = &quot;xen&quot;;then
-			rc_status -s
-			rc_failed 6
-		else
-			if test &quot;$domain&quot; = &quot;dom0&quot;;then
-				rc_status -s
-				rc_failed 6
-			else
-				insserv -r /etc/init.d/kbd
-				insserv -r /etc/init.d/acpid
-				sed -ie &quot;s/^[2-6]:/#\\0/&quot; /etc/inittab
-				init q
-				rc_status
-				rc_status -v -r
-			fi
-		fi
-	;;
-    stop)
-		echo -n &quot;Restoring default environment&quot;
-		if test ! &quot;$kernel&quot; = &quot;xen&quot;;then
-			rc_status -s
-			rc_failed 6
-		else
-			if test &quot;$domain&quot; = &quot;dom0&quot;;then
-				rc_status -s
-				rc_failed 6
-			else
-				insserv /etc/init.d/acpid
-				insserv /etc/init.d/kbd
-				sed -ie &quot;s/^#\([2-6]:\)/\\1/&quot; /etc/inittab
-				init q
-				rc_status -v -r
-			fi
-		fi
-	;;
-    status)
-		rc_failed 4
-		rc_status -v
-	;;
-	*)
-		echo &quot;Usage: $0 {start|stop|status|restart}&quot;
-		exit 1
-	;;
-esac
-
-rc_exit
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/bootloader b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/bootloader
deleted file mode 100644
index 1077da9..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/bootloader
+++ /dev/null
@@ -1,23 +0,0 @@
-## Path:	System/Bootloader
-## Description:	Bootloader configuration
-## Type:	list(grub,lilo,none)
-## Default:	grub
-#
-# Type of bootloader in use.
-# For making the change effect run bootloader configuration tool
-# and configure newly selected bootloader
-#
-#
-LOADER_TYPE=&quot;grub&quot;
-
-
-## Path:        System/Bootloader
-## Description: Bootloader configuration
-## Type:        list(floppy,mbr,root,boot,custom,none)
-## Default:     mbr
-#
-# Location of boot loader.
-# For making the change effect run bootloader configuration tool
-#
-#
-LOADER_LOCATION=&quot;mbr&quot;
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/bootsplash b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/bootsplash
deleted file mode 100644
index 4c7cfee..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/bootsplash
+++ /dev/null
@@ -1,20 +0,0 @@
-## Path:	System/Boot
-## Description:	selects bootsplash graphics theme
-## Type:	string
-## Default:	SuSE
-# Choose the bootsplash theme. It should be based in
-# /etc/bootsplash/themes/
-THEME=&quot;SuSE&quot;
-## Path:	System/Boot
-## Description:	enables/disables bootup graphics
-## Type:	yesno
-## Default:	yes
-#
-# SPLASH can be set to &quot;no&quot; to turn off the splash-screen on console 1
-# at boot time (after kernel load).
-#
-# SPLASH=no to disable the splash screen
-#
-# SPLASH=yes to show the splash screen
-#
-SPLASH=&quot;yes&quot;
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/console b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/console
deleted file mode 100644
index 8467c4c..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/console
+++ /dev/null
@@ -1,87 +0,0 @@
-## Path:	System/Console/Framebuffer
-## Description:	Framebuffer configuration
-## Type:	string
-## Default:	&quot;&quot;
-#
-# You may want to load a framebuffer display driver into your kernel
-# in order to be able to change graphics modes etc. with fbset in
-# console mode.
-#
-# Notes: Most people won't enter anything here, as:
-#   * it won't work if you have vesafb already active
-#   * its advantageous to have fb support compiled into your kernel
-#   * Some XFree86 drivers (especially in XFree86-4.x) don't work
-#     too well, if you enable framebuffer text mode.
-#
-# Example:
-#  FB_MODULES=&quot;matroxfb_base vesa=0x182 fv=85 matroxfb_maven matroxfb_crtc2&quot;
-# 
-FB_MODULES=&quot;&quot;
-
-## Type:        string
-## Default:     &quot;&quot;
-#
-# In case your kernel has framebuffer support (or you loaded the framebuffer
-# support into your kernel as a module above), you may want to change the
-# resolution or other parameters. This is done by secifying the parameters
-# to fbset. Use a mode from /etc/fb-modes and additional parameters as
-# -a, -depth &lt;BPP&gt;, -vyres &lt;VYRES&gt;, ... (See fbset manpage and/or fbset -h).
-#
-# Notes:
-#   * vesafb does not (currently) support changing the display mode
-#   * BEWARE! Don't set modes your monitor can't do. Watch out for the maximum
-#     horizontal frequency. Old monitors might even be damaged if you exceed 
-#     their capabilities.
-#
-# Example:
-#   FBSET_PARAMS=&quot;-a -depth 16 768x576-90 -vyres 10240&quot;
-# 
-FBSET_PARAMS=&quot;&quot;
-## Path:        Hardware/Console
-## Description: Text console settings (see also Hardware/Keyboard)
-## Type:	string
-## Default:	&quot;&quot;
-## ServiceRestart: kbd
-#
-# Console settings.
-# Note: The KBD_TTY setting from Hardware/Keyboard (sysconfig/keyboard)
-# also applies for the settings here.
-#
-# Load this console font on bootup:
-# (/usr/share/kbd/consolefonts/)
-# 
-CONSOLE_FONT=&quot;lat9w-16.psfu&quot;
-
-## Type:	string
-## Default:	&quot;&quot;
-#
-# Some fonts come without a unicode map.
-# (.psfu fonts supposedly have it, others often not.)
-# You can then specify the unicode mapping of your font 
-# explicitly. (/usr/share/kbd/unimaps/)
-# Normally not needed.
-#
-CONSOLE_UNICODEMAP=&quot;&quot;
-
-## Type:	string
-## Default:	&quot;&quot;
-#
-# Most programs output 8 bit characters, so you need a table to
-# translate those characters into unicode. That one can be specified
-# here. (/usr/share/kbd/consoletrans/)
-# (Note: If your console is in utf-8 mode you don't need this.)
-# If your code does not use a unicode mapping at all (because you
-# e.g. explicitly specified UNICODEMAP=&quot;none&quot;) you may circumvent
-# the translation via unicode, but load a map which directly maps
-# 8 bit output of your program to a font position.
-#
-CONSOLE_SCREENMAP=&quot;&quot;
-
-## Type:	string
-## Default:	&quot;&quot;
-#
-# for some fonts the console has to be initialized with CONSOLE_MAGIC.
-# CONSOLE_MAGIC can be empty or have the values &quot;(B&quot;, &quot;)B&quot;, &quot;(K&quot; or &quot;)K&quot;.
-# Normally not needed (automatically handled by setfont).
-#
-CONSOLE_MAGIC=&quot;&quot;
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/keyboard b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/keyboard
deleted file mode 100644
index ef2ab72..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/keyboard
+++ /dev/null
@@ -1,97 +0,0 @@
-## Path:        Hardware/Keyboard
-## Description: Keyboard settings
-## Type:        string
-## Default:     &quot;&quot;
-## ServiceRestart: kbd
-#
-# Keyboard settings for the text console
-#
-# Keyboard mapping
-# (/usr/share/kbd/keymaps/)
-# e.g. KEYTABLE=&quot;de-latin1-nodeadkeys&quot;, &quot;us&quot; or empty for US settings
-#
-KEYTABLE=&quot;us.map.gz&quot;
-
-## Type:        integer
-## Default:
-#
-# Keyboard delay time in ms (250, 500, 750, 1000)
-KBD_DELAY=&quot;&quot;
-
-## Type:	string(2.0,2.1,2.3,2.5,2.7,3.0,3.3,3.7,4.0,4.3,4.6,5.0,5.5,6.0,6.7,7.5,8.0,8.6,9.2,10.0,10.9,12.0,13.3,15.0,16.0,17.1,18.5,20.0,21.8,24.0,26.7,30.0)
-## Default:
-#
-# Keyboard repeat rate (2.0 - 30.0)
-KBD_RATE=&quot;&quot;
-
-## Type:        list(bios,yes,no)
-## Default:     bios
-#
-# NumLock on? (&quot;yes&quot; or &quot;no&quot; or empty or &quot;bios&quot; for BIOS setting)
-KBD_NUMLOCK=&quot;bios&quot;
-
-## Type:        yesno
-## Default:     no
-#
-# ScrollLock on? (&quot;yes&quot; or &quot;no&quot;)
-KBD_SCRLOCK=&quot;no&quot;
-
-## Type:        yesno
-## Default:     no
-#
-# CapsLock on? (&quot;yes&quot; or &quot;no&quot;)
-KBD_CAPSLOCK=&quot;no&quot;
-
-## Type:        yesno
-## Default:     no
-#
-# Disable CAPS LOCK and make it a normal Shift key?
-# (Ctrl Caps Lock will still toggle Caps Lock functionality)
-# Note that you need to tweak the xkb maps or use xmodmap
-# if you want to do the same under X-Windows. In ~/.Xmodmap:
-# keycode 0x42 = Shift_L Shift_L
-#
-KBD_DISABLE_CAPS_LOCK=&quot;no&quot;
-
-## Type:        string
-## Default:     &quot;tty1 tty2 tty3 tty4 tty5 tty6&quot;
-#
-# ttys for the above settings 
-# Example: &quot;tty1 tty2&quot;
-# &quot;&quot; for all tty's
-#
-KBD_TTY=&quot;tty1 tty2 tty3 tty4 tty5 tty6&quot;
-
-# 
-# Compose tables to be loaded.
-# Compose tables are good for producing characters, which can not
-#  be directly input from your keyboard, such as characters with
-#  accents, currency signs, ...
-# Please read /usr/share/doc/packages/kbd/README.SuSE for an
-#  explanation.
-# You may leave this variable empty (default compose table from kernel 
-#  or KEYTABLE will be used then -- most keyboard maps don't have a
-#  compose table, though)
-# More than one compose table can be given. For a selection of possible
-#  tables see /usr/share/kbd/keymaps/include/compose.*
-# You can give more than one compose table, but only the last one will
-#  determine the compose combinations.
-#  The word &quot;clear&quot; has a special meaning:
-#  Your compose table will be cleared, before more compose symbols are
-#  added.
-# The files compose.winkeys and shiftctrl may be used to map the 
-#  &lt;compose&gt; key to the W*n menu key and Shift-Ctrl, respectively,
-#  on a PC keyboard.
-# A typical setting for Latin1 users (with a PC keyboard) may be
-#  COMPOSETABLE=&quot;clear winkeys shiftctrl latin1.add&quot;
-# For latin2, this would be
-#  COMPOSETABLE=&quot;clear winkeys shiftctrl latin2&quot;
-# A typical setting for sb. with a character set, where a matching 
-#  compose table is missing (but with a PC keyboard), would be
-#  COMPOSETABLE=&quot;winkeys shiftctrl&quot;
-# 
-COMPOSETABLE=&quot;clear winkeys shiftctrl latin1.add&quot;
-
-# The YaST-internal identifier of the attached keyboard.
-#
-YAST_KEYBOARD=&quot;us,pc104&quot;
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/config b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/config
deleted file mode 100644
index f2bee93..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/config
+++ /dev/null
@@ -1,236 +0,0 @@
-## Path:	Network/Hardware/Config
-## Description:	Set some general network configuration
-## Type:	string(&quot;&quot;,&quot;-&quot;,&quot;+&quot;)
-## Default:	&quot;+&quot;
-## ServiceRestart: network
-#
-# DEFAULT_BROADCAST is used when no individual BROADCAST is set. It can get one
-# of the following values:
-# &quot;&quot;  : don't set a broadcast address
-# &quot;-&quot; : use IPADDR with all host bits deleted
-# &quot;+&quot; : use IPADDR with all host bits set
-DEFAULT_BROADCAST=&quot;+&quot;
-
-## Type:	yesno
-## Default:	yes
-# sometimes we want some script to be executed after an interface has been
-# brought up, or before an interface is taken down. 
-# default dir is /etc/sysconfig/network/if-up.d for POST_UP and
-# /etc/sysconfig/network/if-down.d for PRE_DOWN
-GLOBAL_POST_UP_EXEC=&quot;yes&quot;
-GLOBAL_PRE_DOWN_EXEC=&quot;yes&quot;
-
-## Type:        yesno
-## Default:     no
-# If ifup should check if an ip address is already in use, set this to yes.
-# Make sure that packet sockets (CONFIG_PACKET) are supported in the kernel,
-# since this feature uses arping, which depends on that.
-# Also be aware that this takes one second per interface; consider that when
-# setting up a lot of interfaces. 
-CHECK_DUPLICATE_IP=&quot;no&quot;
-
-## Type:        yesno
-## Default:     no
-# Switch on/off debug messages for all network configuration stuff. If set to no
-# most scripts can enable it locally with &quot;-o debug&quot;.
-DEBUG=&quot;no&quot;
-
-## Type:        yesno
-## Default:     yes
-# All error and info messages from network and hardware configuration scripts go
-# to stderr. Most tools that call sysconfig scripts (udev, rcnetwork, scpm,
-# YaST) catch these messages and can log them. So some messages appear twice in
-# syslog. If you don't like that, then set USE_SYSLOG=no.
-USE_SYSLOG=&quot;yes&quot;
-
-## Type:        yesno
-## Default:     yes
-# There are some services (ppp, ippp, dhcp-client, pcmcia, hotplug) that have to
-# change the /etc/resolv.conf dynamically at certain times.  E.g. if ppp/ippp
-# establishes a connection and is supplied by the peer with a list of
-# nameservers. Or pcmcia needs to set the correct nameserver for the choosen
-# configuration scheme. If you don't like these services to change
-# /etc/resolv.conf at all, then set this variable to &quot;no&quot;.
-# If unsure, leave it at the default (which is &quot;yes&quot;).
-#
-MODIFY_RESOLV_CONF_DYNAMICALLY=&quot;yes&quot;
-
-## Type:        yesno
-## Default:     no
-# Like MODIFY_RESOLV_CONF_DYNAMICALLY, except it modifies /etc/named.conf.
-# If unsure, leave it at the default (which is &quot;no&quot;).
-#
-MODIFY_NAMED_CONF_DYNAMICALLY=&quot;no&quot;
-
-# Handling of network connections
-# ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
-# These features are designed for the convenience of the experienced
-# user. If you encounter problems you don't understand then switch
-# them off. That is the default.
-# Please do not complain if you get troubles. But if you want help to
-# make them smarter write to &lt;<A HREF="http://www.suse.de/feedback">http://www.suse.de/feedback</A>&gt;.
-
-## Type:	yesno
-## Default:	no
-#
-# If you are interested in the connections and nfs mounts that use a
-# network interface, you can set CONNECTION_SHOW_WHEN_IFSTATUS=&quot;yes&quot;.
-# Then you will see them with 'ifstatus &lt;interface&gt;' (or 'ifstatus
-# &lt;config&gt;')
-# This one _should_ never harm ;)
-#
-CONNECTION_SHOW_WHEN_IFSTATUS=&quot;no&quot;
-
-## Type:	yesno
-## Default:	no
-#
-# If an interface should be set down only if there are no active
-# connections, then use CONNECTION_CHECK_BEFORE_IFDOWN=&quot;yes&quot;
-#
-CONNECTION_CHECK_BEFORE_IFDOWN=&quot;no&quot;
-
-## Type:	yesno
-## Default:	no
-#
-# If these connetions (without the nfs mounts) should be closed when
-# shutting down an interface, set CONNECTION_CLOSE_BEFORE_IFDOWN=&quot;yes&quot;.
-# WARNING: Be aware that this may terminate applications which need
-# one of these connections!
-#
-CONNECTION_CLOSE_BEFORE_IFDOWN=&quot;no&quot;
-
-## Type:	yesno
-## Default:	no
-#
-# If you are a mobile laptop user and like even nfs mounts to be
-# closed when you leave your current workplace, then set
-# CONNECTION_UMOUNT_NFS_BEFORE_IFDOWN=&quot;yes&quot;. This does only work
-# if CONNECTION_CLOSE_BEFORE_IFDOWN=&quot;yes&quot;, too.
-# WARNING: Be aware that this may terminate applications which use
-# these nfs mounts as working directory. Be very carefull if your home
-# is mounted via nfs!!!
-# WARNING: This may even lead to hanging ifdown processes if there are
-# processes that could not be terminated. If you are using
-# hotpluggable devices (pcmcia, usb, firewire), first shut them down
-# before unplugging!
-#
-CONNECTION_UMOUNT_NFS_BEFORE_IFDOWN=&quot;no&quot;
-
-## Type:	yesno
-## Default:	no
-#
-# If terminating processes that use a connection or nfs mount is not
-# enough, then they can be killed after an unsuccesfull termination.
-# If you want that set CONNECTION_SEND_KILL_SIGNAL=&quot;yes&quot;
-#
-CONNECTION_SEND_KILL_SIGNAL=&quot;no&quot;
-
-## Type:        string
-## Default:     &quot;&quot;
-#
-# Here you may specify which interfaces have to be up and configured properly
-# after 'rcnetwork start'. rcconfig will return 'failed' if any of these
-# interfaces is not up. You may use interface names as well but better use
-# hardware descriptions of the devices (eth-id-&lt;macaddress&gt; or eth-bus-...  See
-# man ifup for 'hardware description'). The network start script will wait for
-# these interfaces, but not longer as set in WAIT_FOR_INTERFACES.
-# You need not to add dialup or tunnel interfaces here, only physical devices.
-# The interface 'lo' is always considered to be mandatory and can be omitted.
-#
-# If this variable is empty, rcnetwork tries to derive the list of mandatory
-# devices automatically from the list of existing configurations. Configurations
-# with names bus-pcmcia or bus-usb or with STARTMODE=hotplug are skipped. (try
-# '/etc/init.d/rc5.d/S*network start -o debug fake | grep MANDAT')
-MANDATORY_DEVICES=&quot;&quot;
-
-## Type:	integer
-## Default:	20
-#
-# Some interfaces need some time to come up or come asynchronously via hotplug.
-# WAIT_FOR_INTERFACES is a global wait for all mandatory interfaces in
-# seconds. If empty no wait occurs.
-#
-WAIT_FOR_INTERFACES=&quot;20&quot;
-
-## Type:	yesno
-## Default:	yes
-#
-# With this variable you can determine if the SuSEfirewall when enabled
-# should get started when network interfaces are started.
-FIREWALL=&quot;yes&quot;
-
-## Type:        string
-## Default:     &quot;eth*[0-9]|tr*[0-9]|wlan[0-9]|ath[0-9]&quot;
-#
-# Automatically add a linklocal route to the matching interfaces.
-# This string is used in a bash &quot;case&quot; statement, so it may contain
-# '*', '[', ']'  and '|' meta-characters.
-#
-LINKLOCAL_INTERFACES=&quot;eth*[0-9]|tr*[0-9]|wlan[0-9]|ath[0-9]&quot;
-
-## Type:        string
-## Default:     &quot;-f -I&quot;
-#
-# Set default options for ifplugd. You may also set them in an ifcfg-* file
-# individually. Have a look at 'man ifplug' for details. We let ifplugd set the
-# interface UP when starting, because there are many interfaces where link beat
-# cannot be detected otherwise. If you want the interface to stay down then add
-# the option '-a'.
-#
-IFPLUGD_OPTIONS=&quot;-f -I&quot;
-
-## Type:        yesno
-## Default:     yes
-#
-# Forces all interfaces eth* ath* wlan* and ra* to be persistent via udev.
-# See /usr/share/doc/package/sysconfig/README.Persistent_Interface_Names for
-# details. 
-#
-FORCE_PERSISTENT_NAMES=yes
-
-## Type:        string
-## Default:     &quot;&quot;
-# If you need a special nameserver that should always be prepended to the list
-# of dynamically changed nameservers, you may add it here.
-#
-MODIFY_RESOLV_CONF_STATIC_DNS=&quot;&quot;
-
-## Type:        yesno
-## Default:     no
-#
-# Instead of the usual network setup (now called 'NetControl') you may also use
-# 'NetworkManager' to control your interfaces.
-#
-# NetControl is what you were used to in SUSE Linux up to now. It has a wide
-# range of configurations means for setting up any number of different virtual
-# and real interfaces. It should be used if you:
-# - want a static network setup
-# - have many interfaces
-# - need VLAN, bonding, bridging, multiple IP addresses
-# - must restrict network control to root
-# It may also switch interfaces automatically, but lacks a usable GUI for normal
-# users.
-#
-# NetworkManager lets the user control interfaces and switches automatically if
-# network interfaces lose/gain physical connection. It should be used if you:
-# - move between networks frequently
-# - want a GUI for network control
-# Especially on mobile computers that use mainly one wired and one wireless
-# interface NetworkManager will please you.
-#
-# If you are used to SCPM then you might probably stay with NetControl. But at
-# least try NetworkManager, because it can replace SCPM in some usage scenarios.
-# 
-NETWORKMANAGER=no
-
-## Type:        yesno
-## Default:     yes
-#
-# When using NetworkManager you may want to trigger special actions when an
-# interface comes up. NetworkManagerDispatcher is a daemon that listens to
-# dbus-messages that tell that an interface is up/down and triggers whatever
-# you like. Read more about it in the manpage to NetworkManagerDispatcher.
-#
-# This variable has no effect if NETWORKMANAGER=no
-#
-NM_DISPATCHER=yes
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/dhcp b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/dhcp
deleted file mode 100644
index 53efe63..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/dhcp
+++ /dev/null
@@ -1,21 +0,0 @@
-DHCLIENT_DEBUG=&quot;no&quot;
-DHCLIENT_SET_HOSTNAME=&quot;yes&quot;
-DHCLIENT_MODIFY_RESOLV_CONF=&quot;yes&quot;
-DHCLIENT_SET_DEFAULT_ROUTE=&quot;yes&quot;
-DHCLIENT_MODIFY_NTP_CONF=&quot;no&quot;
-DHCLIENT_MODIFY_NIS_CONF=&quot;no&quot;
-DHCLIENT_SET_DOMAINNAME=&quot;no&quot;
-DHCLIENT_KEEP_SEARCHLIST=&quot;no&quot;
-DHCLIENT_LEASE_TIME=&quot;&quot;
-DHCLIENT_TIMEOUT=&quot;999999&quot;
-DHCLIENT_REBOOT_TIMEOUT=&quot;&quot;
-DHCLIENT_HOSTNAME_OPTION=&quot;AUTO&quot;
-DHCLIENT_CLIENT_ID=&quot;&quot;
-DHCLIENT_VENDOR_CLASS_ID=&quot;&quot;
-DHCLIENT_RELEASE_BEFORE_QUIT=&quot;no&quot;
-DHCLIENT_SCRIPT_EXE=&quot;&quot;
-DHCLIENT_ADDITIONAL_OPTIONS=&quot;&quot;
-DHCLIENT_SLEEP=&quot;0&quot;
-DHCLIENT_WAIT_AT_BOOT=&quot;15&quot;
-DHCLIENT_UDP_CHECKSUM=&quot;no&quot;
-DHCLIENT_MODIFY_SMB_CONF=&quot;yes&quot;
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/ifcfg-lo b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/ifcfg-lo
deleted file mode 100644
index c3ca3cf..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/ifcfg-lo
+++ /dev/null
@@ -1,7 +0,0 @@
-# Loopback (lo) configuration
-IPADDR=127.0.0.1
-NETMASK=255.0.0.0
-NETWORK=127.0.0.0
-BROADCAST=127.255.255.255
-STARTMODE=onboot
-USERCONTROL=no
diff --git a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/ifroute-lo b/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/ifroute-lo
deleted file mode 100644
index 2d510dd..0000000
--- a/doc/examples/suse-11.3/suse-xen-guest/root/etc/sysconfig/network/ifroute-lo
+++ /dev/null
@@ -1,4 +0,0 @@
-# Set an explicit route to the localnet, because there was a report (bug 34872)
-# about performance problems in an oracle installation without that route.
-# Normally it should not be necessary since kernel 2.4, but it does not harm.
-127/8
diff --git a/kiwi.pl b/kiwi.pl
index 099f356..3bc601d 100755
--- a/kiwi.pl
+++ b/kiwi.pl
@@ -851,23 +851,23 @@ sub main {
 		my $ok;
 		SWITCH: for ($attr{type}) {
 			/^ext2/     &amp;&amp; do {
-				$ok = $image -&gt; createImageEXT2 ();
+				$ok = $image -&gt; createImageEXT2 ( $targetDevice );
 				last SWITCH;
 			};
 			/^ext3/     &amp;&amp; do {
-				$ok = $image -&gt; createImageEXT3 ();
+				$ok = $image -&gt; createImageEXT3 ( $targetDevice );
 				last SWITCH;
 			};
 			/^ext4/     &amp;&amp; do {
-				$ok = $image -&gt; createImageEXT4 ();
+				$ok = $image -&gt; createImageEXT4 ( $targetDevice );
 				last SWITCH;
 			};
 			/^reiserfs/ &amp;&amp; do {
-				$ok = $image -&gt; createImageReiserFS ();
+				$ok = $image -&gt; createImageReiserFS ( $targetDevice );
 				last SWITCH;
 			};
 			/^btrfs/    &amp;&amp; do {
-				$ok = $image -&gt; createImageBTRFS ();
+				$ok = $image -&gt; createImageBTRFS ( $targetDevice );
 				last SWITCH;
 			};
 			/^squashfs/ &amp;&amp; do {
@@ -1505,6 +1505,11 @@ sub init {
 		$kiwi -&gt; failed ();
 		my $code = kiwiExit (1); return $code;
 	}
+	if (($targetDevice) &amp;&amp; (! -b $targetDevice)) {
+		$kiwi -&gt; error (&quot;Target device $targetDevice doesn't exist&quot;);
+		$kiwi -&gt; failed ();
+		my $code = kiwiExit (1); return $code;
+	}
 	if ((defined $IgnoreRepos) &amp;&amp; (defined $SetRepository)) {
 		$kiwi -&gt; error (&quot;Can't use ignore repos together with set repos&quot;);
 		$kiwi -&gt; failed ();
diff --git a/modules/KIWIImage.pm b/modules/KIWIImage.pm
index 5223715..8eee4ff 100644
--- a/modules/KIWIImage.pm
+++ b/modules/KIWIImage.pm
@@ -306,37 +306,51 @@ sub createImageClicFS {
 }
 
 #==========================================
-# createImageEXT2
+# createImageEXT
 #------------------------------------------
-sub createImageEXT2 {
+sub createImageEXT {
 	# ...
 	# Create EXT2 image from source tree
 	# ---
 	my $this    = shift;
 	my $journal = shift;
+	my $device  = shift;
 	#==========================================
 	# PRE filesystem setup
 	#------------------------------------------
-	my $name = $this -&gt; preImage ();
+	my $name = $this -&gt; preImage ($device);
 	if (! defined $name) {
 		return undef;
 	}
 	#==========================================
 	# Create filesystem on extend
 	#------------------------------------------
-	if (! $this -&gt; setupEXT2 ( $name,$journal )) {
+	if (! $this -&gt; setupEXT2 ( $name,$journal,$device )) {
 		return undef;
 	}
 	#==========================================
 	# POST filesystem setup
 	#------------------------------------------
-	if (! $this -&gt; postImage ($name)) {
+	if (! $this -&gt; postImage ($name,undef,undef,$device)) {
 		return undef;
 	}
 	return $this;
 }
 
 #==========================================
+# createImageEXT2
+#------------------------------------------
+sub createImageEXT2 {
+	# ...
+	# create journaled EXT2 image from source tree
+	# ---
+	my $this = shift;
+	my $device  = shift;
+	my $journal = &quot;journaled-ext2&quot;;
+	return $this -&gt; createImageEXT ($journal,$device);
+}
+
+#==========================================
 # createImageEXT3
 #------------------------------------------
 sub createImageEXT3 {
@@ -344,7 +358,9 @@ sub createImageEXT3 {
 	# create journaled EXT3 image from source tree
 	# ---
 	my $this = shift;
-	return $this -&gt; createImageEXT2 (&quot;journaled-ext3&quot;);
+	my $device  = shift;
+	my $journal = &quot;journaled-ext3&quot;;
+	return $this -&gt; createImageEXT ($journal,$device);
 }
 
 #==========================================
@@ -355,7 +371,9 @@ sub createImageEXT4 {
 	# create journaled EXT4 image from source tree
 	# ---
 	my $this = shift;
-	return $this -&gt; createImageEXT2 (&quot;journaled-ext4&quot;);
+	my $device  = shift;
+	my $journal = &quot;journaled-ext4&quot;;
+	return $this -&gt; createImageEXT ($journal,$device);
 }
 
 #==========================================
@@ -366,23 +384,24 @@ sub createImageReiserFS {
 	# create journaled ReiserFS image from source tree
 	# ---
 	my $this = shift;
+	my $device  = shift;
 	#==========================================
 	# PRE filesystem setup
 	#------------------------------------------
-	my $name = $this -&gt; preImage ();
+	my $name = $this -&gt; preImage ($device);
 	if (! defined $name) {
 		return undef;
 	}
 	#==========================================
 	# Create filesystem on extend
 	#------------------------------------------
-	if (! $this -&gt; setupReiser ( $name )) {
+	if (! $this -&gt; setupReiser ( $name,$device )) {
 		return undef;
 	}
 	#==========================================
 	# POST filesystem setup
 	#------------------------------------------
-	if (! $this -&gt; postImage ($name)) {
+	if (! $this -&gt; postImage ($name,undef,undef,$device)) {
 		return undef;
 	}
 	return $this;
@@ -396,23 +415,24 @@ sub createImageBTRFS {
 	# create BTRFS image from source tree
 	# ---
 	my $this = shift;
+	my $device  = shift;
 	#==========================================
 	# PRE filesystem setup
 	#------------------------------------------
-	my $name = $this -&gt; preImage ();
+	my $name = $this -&gt; preImage ($device);
 	if (! defined $name) {
 		return undef;
 	}
 	#==========================================
 	# Create filesystem on extend
 	#------------------------------------------
-	if (! $this -&gt; setupBTRFS ( $name )) {
+	if (! $this -&gt; setupBTRFS ( $name,$device )) {
 		return undef;
 	}
 	#==========================================
 	# POST filesystem setup
 	#------------------------------------------
-	if (! $this -&gt; postImage ($name)) {
+	if (! $this -&gt; postImage ($name,undef,undef,$device)) {
 		return undef;
 	}
 	return $this;
@@ -2726,9 +2746,9 @@ sub preImage {
 	# dependant tasks before the logical extend
 	# has been created
 	# ---
-	my $this = shift;
+	my $this       = shift;
 	my $haveExtend = shift;
-	my $quiet= shift;
+	my $quiet      = shift;
 	#==========================================
 	# Get image creation date and name
 	#------------------------------------------
@@ -2935,19 +2955,20 @@ sub postImage {
 	my $name  = shift;
 	my $nozip = shift;
 	my $fstype= shift;
+	my $device= shift;
 	my $kiwi  = $this-&gt;{kiwi};
 	my $xml   = $this-&gt;{xml};
 	#==========================================
 	# mount logical extend for data transfer
 	#------------------------------------------
-	my $extend = $this -&gt; mountLogicalExtend ($name);
+	my $extend = $this -&gt; mountLogicalExtend ($name,undef,$device);
 	if (! defined $extend) {
 		return undef;
 	}
 	#==========================================
 	# copy physical to logical
 	#------------------------------------------
-	if (! $this -&gt; installLogicalExtend ($extend)) {
+	if (! $this -&gt; installLogicalExtend ($extend,undef,$device)) {
 		$this -&gt; cleanLuks();
 		return undef;
 	}
@@ -3187,6 +3208,7 @@ sub installLogicalExtend {
 	my $this   = shift;
 	my $extend = shift;
 	my $source = shift;
+	my $device = shift;
 	my $kiwi   = $this-&gt;{kiwi};
 	my $imageTree = $this-&gt;{imageTree};
 	if (! defined $source) {
@@ -3209,6 +3231,24 @@ sub installLogicalExtend {
 		return undef;
 	}
 	$kiwi -&gt; done();
+	#==========================================
+	# dump image file from device if requested
+	#------------------------------------------
+	if ($device) {
+		$this -&gt; cleanMount();
+		$name = $this -&gt; buildImageName ();
+		$kiwi -&gt; info (&quot;Dumping filesystem image from $device...&quot;);
+		$data = qxx (&quot;dd if=$device of=$this-&gt;{imageDest}/$name bs=32k 2&gt;&amp;1&quot;);
+		$code = $? &gt;&gt; 8;
+		if ($code != 0) {
+			$kiwi -&gt; failed ();
+			$kiwi -&gt; error  (&quot;Failed to load filesystem image&quot;);
+			$kiwi -&gt; failed ();
+			$kiwi -&gt; error  ($data);
+			return undef;
+		}
+		$kiwi -&gt; done();
+	}
 	return $extend;
 }
 
@@ -3286,23 +3326,30 @@ sub setupLogicalExtend {
 # mountLogicalExtend
 #------------------------------------------
 sub mountLogicalExtend {
-	my $this = shift;
-	my $name = shift;
-	my $opts = shift;
-	my $kiwi = $this-&gt;{kiwi};
+	my $this   = shift;
+	my $name   = shift;
+	my $opts   = shift;
+	my $device = shift;
+	my $kiwi   = $this-&gt;{kiwi};
 	#==========================================
 	# mount logical extend for data transfer
 	#------------------------------------------
-	mkdir &quot;$this-&gt;{imageDest}/mnt-$$&quot;;
-	my $mount = &quot;mount -o loop&quot;;
+	my $target = &quot;$this-&gt;{imageDest}/$name&quot;;
+	my $mount  = &quot;mount&quot;;
 	if (defined $opts) {
-		$mount = &quot;mount $opts -o loop&quot;;
+		$mount = &quot;mount $opts&quot;;
+	}
+	if ($device) {
+		$target = $device;
+	} else {
+		$mount .= &quot; -o loop&quot;;
 	}
+	mkdir &quot;$this-&gt;{imageDest}/mnt-$$&quot;;
 	#==========================================
 	# check for filesystem options
 	#------------------------------------------
 	my $fstype = qxx (
-		&quot;/sbin/blkid -c /dev/null -s TYPE -o value $this-&gt;{imageDest}/$name&quot;
+		&quot;/sbin/blkid -c /dev/null -s TYPE -o value $target&quot;
 	);
 	chomp $fstype;
 	if ($fstype eq &quot;ext4&quot;) {
@@ -3313,7 +3360,7 @@ sub mountLogicalExtend {
 		$mount .= &quot;,nodelalloc&quot;;
 	}
 	my $data= qxx (
-		&quot;$mount $this-&gt;{imageDest}/$name $this-&gt;{imageDest}/mnt-$$ 2&gt;&amp;1&quot;
+		&quot;$mount $target $this-&gt;{imageDest}/mnt-$$ 2&gt;&amp;1&quot;
 	);
 	my $code= $? &gt;&gt; 8;
 	if ($code != 0) {
@@ -3321,7 +3368,7 @@ sub mountLogicalExtend {
 		$kiwi -&gt; error  (&quot;Image loop mount failed:&quot;);
 		$kiwi -&gt; failed ();
 		$kiwi -&gt; error  (
-			&quot;mnt: $this-&gt;{imageDest}/$name -&gt; $this-&gt;{imageDest}/mnt-$$: $data&quot;
+			&quot;mnt: $target -&gt; $this-&gt;{imageDest}/mnt-$$: $data&quot;
 		);
 		return undef;
 	}
@@ -3469,6 +3516,7 @@ sub setupEXT2 {
 	my $this    = shift;
 	my $name    = shift;
 	my $journal = shift;
+	my $device  = shift;
 	my $kiwi    = $this-&gt;{kiwi};
 	my $xml  = $this-&gt;{xml};
 	my %type = %{$xml-&gt;getImageTypeAndAttributes()};
@@ -3476,6 +3524,7 @@ sub setupEXT2 {
 	my $tuneopts;
 	my %FSopts = main::checkFSOptions();
 	my $fstool;
+	my $target = &quot;$this-&gt;{imageDest}/$name&quot;;
 	if ((defined $journal) &amp;&amp; ($journal eq &quot;journaled-ext3&quot;)) {
 		$fsopts = $FSopts{ext3};
 		$fstool = &quot;mkfs.ext3&quot;;
@@ -3491,10 +3540,13 @@ sub setupEXT2 {
 	}
 	$tuneopts = $type{fsnocheck} eq &quot;true&quot; ? &quot;-c 0 -i 0&quot; : &quot;&quot;;
 	$tuneopts = $FSopts{extfstune} if $FSopts{extfstune};
-	my $data = qxx (&quot;$fstool $fsopts $this-&gt;{imageDest}/$name 2&gt;&amp;1&quot;);
+	if ($device) {
+		$target = $device;
+	}
+	my $data = qxx (&quot;$fstool $fsopts $target 2&gt;&amp;1&quot;);
 	my $code = $? &gt;&gt; 8;
 	if (!$code &amp;&amp; $tuneopts) {
-		$data = qxx (&quot;/sbin/tune2fs $tuneopts $this-&gt;{imageDest}/$name 2&gt;&amp;1&quot;);
+		$data = qxx (&quot;/sbin/tune2fs $tuneopts $target 2&gt;&amp;1&quot;);
 		$code = $? &gt;&gt; 8;
 	}
 	if ($code != 0) {
@@ -3503,6 +3555,9 @@ sub setupEXT2 {
 		$kiwi -&gt; error  ($data);
 		return undef;
 	}
+	if ($device) {
+		qxx (&quot;touch $this-&gt;{imageDest}/$name&quot;);
+	}
 	$this -&gt; restoreImageDest();
 	if ((defined $journal) &amp;&amp; ($journal eq &quot;journaled-ext3&quot;)) {
 		$data = qxx (&quot;cd $this-&gt;{imageDest} &amp;&amp; ln -vs $name $name.ext3 2&gt;&amp;1&quot;);
@@ -3520,13 +3575,18 @@ sub setupEXT2 {
 # setupBTRFS
 #------------------------------------------
 sub setupBTRFS {
-	my $this = shift;
-	my $name = shift;
-	my $kiwi = $this-&gt;{kiwi};
+	my $this   = shift;
+	my $name   = shift;
+	my $device = shift;
+	my $kiwi   = $this-&gt;{kiwi};
 	my %FSopts = main::checkFSOptions();
 	my $fsopts = $FSopts{btrfs};
+	my $target = &quot;$this-&gt;{imageDest}/$name&quot;;
+	if ($device) {
+		$target = $device;
+	}
 	my $data = qxx (
-		&quot;/sbin/mkfs.btrfs $fsopts $this-&gt;{imageDest}/$name 2&gt;&amp;1&quot;
+		&quot;/sbin/mkfs.btrfs $fsopts $target 2&gt;&amp;1&quot;
 	);
 	my $code = $? &gt;&gt; 8;
 	if ($code != 0) {
@@ -3535,6 +3595,9 @@ sub setupBTRFS {
 		$kiwi -&gt; error  ($data);
 		return undef;
 	}
+	if ($device) {
+		qxx (&quot;touch $this-&gt;{imageDest}/$name&quot;);
+	}
 	$this -&gt; restoreImageDest();
 	$data = qxx (&quot;cd $this-&gt;{imageDest} &amp;&amp; ln -vs $name $name.btrfs 2&gt;&amp;1&quot;);
 	$this -&gt; remapImageDest();
@@ -3546,14 +3609,19 @@ sub setupBTRFS {
 # setupReiser
 #------------------------------------------
 sub setupReiser {
-	my $this = shift;
-	my $name = shift;
+	my $this   = shift;
+	my $name   = shift;
+	my $device = shift;
 	my $kiwi = $this-&gt;{kiwi};
 	my %FSopts = main::checkFSOptions();
 	my $fsopts = $FSopts{reiserfs};
+	my $target = &quot;$this-&gt;{imageDest}/$name&quot;;
+	if ($device) {
+		$target = $device;
+	}
 	$fsopts.= &quot;-f&quot;;
 	my $data = qxx (
-		&quot;/sbin/mkreiserfs $fsopts $this-&gt;{imageDest}/$name 2&gt;&amp;1&quot;
+		&quot;/sbin/mkreiserfs $fsopts $target 2&gt;&amp;1&quot;
 	);
 	my $code = $? &gt;&gt; 8;
 	if ($code != 0) {
@@ -3562,6 +3630,9 @@ sub setupReiser {
 		$kiwi -&gt; error  ($data);
 		return undef;
 	}
+	if ($device) {
+		qxx (&quot;touch $this-&gt;{imageDest}/$name&quot;);
+	}
 	$this -&gt; restoreImageDest();
 	$data = qxx (&quot;cd $this-&gt;{imageDest} &amp;&amp; ln -vs $name $name.reiserfs 2&gt;&amp;1&quot;);
 	$this -&gt; remapImageDest();
diff --git a/modules/KIWIImageFormat.pm b/modules/KIWIImageFormat.pm
index 04f55ee..7f9e93f 100644
--- a/modules/KIWIImageFormat.pm
+++ b/modules/KIWIImageFormat.pm
@@ -550,8 +550,11 @@ sub createXENConfiguration {
 	#------------------------------------------
 	if ($type{type} eq &quot;xen&quot;) {
 		print $FD 'root=&quot;'.$part.' ro&quot;'.&quot;\n&quot;;
-		print $FD 'vfb = [&quot;type=vnc,vncunused=1,vnclisten=0.0.0.0&quot;]'.&quot;\n&quot;;
 	}
+	#==========================================
+	# xen virtual framebuffer
+	#------------------------------------------
+	print $FD 'vfb = [&quot;type=vnc,vncunused=1,vnclisten=0.0.0.0&quot;]'.&quot;\n&quot;;
 	close $FD;
 	$kiwi -&gt; done();
 	return $file;


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002733.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 43f683bef2c6a1569a4868cba82ead343b8a18fe
</A></li>
	<LI>Next message: <A HREF="002735.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 122ad6d5199420d742a7af8387b3fa299a34264b
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2734">[ date ]</a>
              <a href="thread.html#2734">[ thread ]</a>
              <a href="subject.html#2734">[ subject ]</a>
              <a href="author.html#2734">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
