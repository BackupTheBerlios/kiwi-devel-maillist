<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 6adaa13315762334ed5f330c6dfb723b427622d8
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2011-March/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%206adaa13315762334ed5f330c6dfb723b427622d8&In-Reply-To=%3C20110303120826.31464480CE9%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003158.html">
   <LINK REL="Next"  HREF="003154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 6adaa13315762334ed5f330c6dfb723b427622d8</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%206adaa13315762334ed5f330c6dfb723b427622d8&In-Reply-To=%3C20110303120826.31464480CE9%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 6adaa13315762334ed5f330c6dfb723b427622d8">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Thu Mar  3 13:08:23 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003158.html">[Kiwi-devel] new stuff - restructuring related
</A></li>
        <LI>Next message: <A HREF="003154.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-480-SuSE-11.4-Devel,	updated. a22464de7ec1df6b9d31e6878d8751d7b7fd464b
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3164">[ date ]</a>
              <a href="thread.html#3164">[ thread ]</a>
              <a href="subject.html#3164">[ subject ]</a>
              <a href="author.html#3164">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  6adaa13315762334ed5f330c6dfb723b427622d8 (commit)
       via  2845b996d0a9a0736543522103f54b0d85b95036 (commit)
       via  f846a8e9836408b82298022b7150cb8352aacaae (commit)
      from  ee3490632c5be25ed68223fab3b8e585c012d149 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 6adaa13315762334ed5f330c6dfb723b427622d8
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Thu Mar 3 13:02:17 2011 +0100

    - fixed xsl stylesheet convert47to48.xsl. existing lvmvolumes
      section wasn't translated into systemdisk section

commit 2845b996d0a9a0736543522103f54b0d85b95036
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Thu Mar 3 11:54:57 2011 +0100

    - added KIWICommandLine and KIWIRuntimeChecker modules. The command
      line module is a storage container for the commandline options
      passed to kiwi. It's used to transport the data into other objects.
      One successor of KIWICommandLine is the KIWIRuntimeChecker module
      which does some checks while kiwi runs. This means kiwi reads in
      the image description and after that the runtimer checker checks
      if it is possible to build the desired image according to the
      specified information. If that tests are passed kiwi enters the
      actual processing mode which is either the image prepare or create.
      This is useful to exit early if some option combination or data
      set is valid according to the XML schema but can't be build due
      to other reasons.

commit f846a8e9836408b82298022b7150cb8352aacaae
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Thu Mar 3 09:50:52 2011 +0100

    - update RNG schema ec2region comment

-----------------------------------------------------------------------

Summary of changes:
diff --git a/kiwi.pl b/kiwi.pl
index b1b82eb..92ac965 100755
--- a/kiwi.pl
+++ b/kiwi.pl
@@ -32,6 +32,7 @@ use warnings;
 use Carp qw (cluck);
 use Getopt::Long;
 use File::Spec;
+use KIWICommandLine;
 use KIWIRoot;
 use KIWIXML;
 use KIWILocator;
@@ -41,6 +42,7 @@ use KIWIBoot;
 use KIWIMigrate;
 use KIWIOverlay;
 use KIWIQX;
+use KIWIRuntimeChecker;
 use KIWIImageFormat;
 use KIWIXMLValidator;
 
@@ -221,6 +223,7 @@ our $targetDevice;          # alternative device instead of a loop device
 our %XMLChangeSet;          # internal data set for update of XML objects
 our $ImageDescription;      # uniq path to image description due to caller opts
 our $RecycleRoot;           # use existing root directory incl. contents
+our $cmdL;                  # command line storage object
 our $kiwi;                  # global logging handler object
 
 #============================================
@@ -387,6 +390,10 @@ sub main {
 		if (! defined $xml) {
 			my $code = kiwiExit (1); return $code;
 		}
+		my $krc = new KIWIRuntimeChecker ($kiwi,$cmdL,$xml);
+		if (! $krc -&gt; prepareChecks()) {
+			my $code = kiwiExit (1); return $code;
+		}
 		my %type = %{$xml-&gt;getImageTypeAndAttributes()};
 		#==========================================
 		# print boot theme information
@@ -582,6 +589,10 @@ sub main {
 		if (! defined $xml) {
 			my $code = kiwiExit (1); return $code;
 		}
+		my $krc = new KIWIRuntimeChecker ($kiwi,$cmdL,$xml);
+		if (! $krc -&gt; createChecks()) {
+			my $code = kiwiExit (1); return $code;
+		}
 		my %attr = %{$xml-&gt;getImageTypeAndAttributes()};
 		#==========================================
 		# Check for default destination in XML
@@ -1159,6 +1170,7 @@ sub init {
 	$SIG{&quot;TERM&quot;}     = \&quit;
 	$SIG{&quot;INT&quot;}      = \&quit;
 	my $kiwi = new KIWILog(&quot;tiny&quot;);
+	$cmdL = new KIWICommandLine($kiwi);
 	#==========================================
 	# get options and call non-root tasks
 	#------------------------------------------
@@ -1260,6 +1272,7 @@ sub init {
 	#----------------------------------------
 	if (defined $Destination) {
 		$Destination = File::Spec-&gt;rel2abs ($Destination);
+		$cmdL -&gt; setImagetargetDir ($Destination);
 	}
 	#========================================
 	# check prepare/create/cache paths
@@ -1287,6 +1300,7 @@ sub init {
 	#----------------------------------------
 	if (defined $Prepare) {
 		$ImageDescription = $Prepare;
+		$cmdL -&gt; setConfigDir ($ImageDescription);
 	}
 	if (defined $Create) {
 		if (open FD,&quot;$Create/image/main::Prepare&quot;) {
@@ -1297,6 +1311,7 @@ sub init {
 	# store original value of Profiles
 	#----------------------------------------
 	@ProfilesOrig = @Profiles;
+	$cmdL -&gt; setBuildProfiles (\@Profiles);
 	#========================================
 	# set default inode ratio for ext2/3
 	#----------------------------------------
@@ -1442,10 +1457,15 @@ sub init {
 		$kiwi -&gt; error  (&quot;No destination directory specified&quot;);
 		$kiwi -&gt; failed ();
 		my $code = kiwiExit (1); return $code;
+	} elsif (defined $Build) {
+		$cmdL -&gt; setTargetDirsForBuild();
 	}
 	if (defined $listXMLInfo) {
 		listXMLInfo();
 	}
+	if (defined $SetImageType) {
+		$cmdL -&gt; setBuildType($SetImageType);
+	}
 }
 
 #==========================================
diff --git a/modules/KIWICommandLine.pm b/modules/KIWICommandLine.pm
new file mode 100644
index 0000000..0aecffb
--- /dev/null
+++ b/modules/KIWICommandLine.pm
@@ -0,0 +1,236 @@
+#================
+# FILE          : KIWICommandLine.pm
+#----------------
+# PROJECT       : OpenSUSE Build-Service
+# COPYRIGHT     : (c) 2011 SUSE LINUX Products GmbH, Germany
+#               :
+# AUTHOR        : Robert Schweikert &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&gt;
+#               :
+# BELONGS TO    : Operating System images
+#               :
+# DESCRIPTION   : This module is used to store command line arguments
+#               : provided to the kiwi driver.
+#               :
+# STATUS        : Development
+#----------------
+package KIWICommandLine;
+#==========================================
+# Modules
+#------------------------------------------
+use strict;
+use warnings;
+require Exporter;
+use KIWILog;
+
+#==========================================
+# Exports
+#------------------------------------------
+our @ISA    = qw (Exporter);
+our @EXPORT = qw ();
+
+#==========================================
+# Constructor
+#------------------------------------------
+sub new {
+	# ...
+	# Create the CommandLine object
+	# ---
+	#==========================================
+	# Object setup
+	#------------------------------------------
+	my $this  = {};
+	my $class = shift;
+	bless $this,$class;
+	#==========================================
+	# Module Parameters
+	#------------------------------------------
+	my $kiwi = shift;
+	#==========================================
+	# Constructor setup
+	#------------------------------------------
+	if (! defined $kiwi) {
+		$kiwi = new KIWILog();
+	}
+	#==========================================
+	# Object initialize object member data
+	#------------------------------------------
+	$this-&gt;{addPackages}   = ''; # Holds array ref
+	$this-&gt;{addPatterns}   = ''; # Holds array ref
+	$this-&gt;{addRepos}      = ''; # Holds array ref
+	$this-&gt;{buildType}     = '';
+	$this-&gt;{buildProfiles} = ''; # Holds array ref
+	$this-&gt;{configDir}     = '';
+	$this-&gt;{imageTgtDir}   = '';
+	$this-&gt;{kiwi}          = $kiwi;
+	$this-&gt;{rootTgtDir}    = '';
+
+	return $this;
+}
+
+#==========================================
+# getAdditionalPackages
+#------------------------------------------
+sub getAdditionalPackages {
+}
+
+#==========================================
+# getAdditionalPatterns
+#------------------------------------------
+sub getAdditionalPatterns {
+}
+
+#==========================================
+# getAdditionalRepos
+#------------------------------------------
+sub getAdditionalRepos {
+}
+
+#==========================================
+# getBuildType
+#------------------------------------------
+sub getBuildType {
+	# ...
+	# Return the build type specified
+	# ---
+	my $this = shift;
+	return $this -&gt; {buildType};
+}
+
+#==========================================
+# getBuildProfiles
+#------------------------------------------
+sub getBuildProfiles {
+	# ...
+	# Return the list of specified build profiles
+	# ---
+	my $this = shift;
+	return $this -&gt; {buildProfiles};
+}
+
+#==========================================
+# getConfigDir
+#------------------------------------------
+sub getConfigDir {
+	# ...
+	# Return location of the configuration tree
+	# ---
+	my $this = shift;
+	return $this -&gt; {configDir};
+}
+
+#==========================================
+# getImageTargetDir
+#------------------------------------------
+sub getImageTargetDir {
+	# ...
+	# Return the location of the target directory for the image
+	# ---
+	my $this = shift;
+	return $this -&gt; {imageTgtDir};
+}
+
+#==========================================
+# getPrepTargetDir
+#------------------------------------------
+sub getRootTargetDir {
+	# ...
+	# Return the location for the unpacked image directory
+	# ---
+	my $this = shift;
+	return $this -&gt; {rootTgtDir};
+}
+
+#==========================================
+# setAdditionalPackages
+#------------------------------------------
+sub setAdditionalPackages {
+}
+
+#==========================================
+# setAdditionalPatterns
+#------------------------------------------
+sub setAdditionalPatterns {
+}
+
+#==========================================
+# setAdditionalRepos
+#------------------------------------------
+sub setAdditionalRepos {
+}
+
+#==========================================
+# setBuildTargetDir
+#------------------------------------------
+sub setTargetDirsForBuild {
+	# ...
+	# Setup the target dirs for a combined (prepare &amp; create) image build.
+	# ---
+	my $this = shift;
+	$this-&gt;{prepTgtDir} = $this-&gt;{imageTgtDir};
+	$this-&gt;{imageTgtDir} = $this-&gt;{prepTgtDir} . '/build';
+	return 1;
+}
+
+#==========================================
+# setBuildType
+#------------------------------------------
+sub setBuildType {
+	# ...
+	# Set the specified build type (string)
+	# ---
+	my $this = shift;
+	my $type = shift;
+	$this -&gt; {buildType} = $type;
+	return 1;
+}
+
+#==========================================
+# setBuildProfiles
+#------------------------------------------
+sub setBuildProfiles {
+	# ...
+	# Set the build profile list
+	# ---
+	my $this    = shift;
+	my $profRef = shift;
+	$this -&gt; {buildProfiles} = $profRef;
+	return 1;
+}
+
+#==========================================
+# setConfigDir
+#------------------------------------------
+sub setConfigDir {
+	# ...
+	# Set the location of the configuration directory
+	# ---
+	my $this = shift;
+	$this -&gt; {configDir} = shift;
+	return 1;
+}
+
+#==========================================
+# setImasetarsetDir
+#------------------------------------------
+sub setImagetargetDir {
+	# ...
+	# Set the destination directory for the completed image
+	# ---
+	my $this = shift;
+	$this -&gt; {imageTgtDir} = shift;
+	return 1;
+}
+
+#==========================================
+# setPrepTargetDir
+#------------------------------------------
+sub setRootTargetDir {
+	# ...
+	# Set the target directory for the unpacked root tree
+	# ---
+	my $this = shift;
+	$this -&gt; {rootTgtDir} = shift;
+	return 1;
+}
+
+1;
diff --git a/modules/KIWIRuntimeChecker.pm b/modules/KIWIRuntimeChecker.pm
new file mode 100644
index 0000000..142d0ce
--- /dev/null
+++ b/modules/KIWIRuntimeChecker.pm
@@ -0,0 +1,341 @@
+#================
+# FILE          : KIWIRuntimeChecker.pm
+#----------------
+# PROJECT       : OpenSUSE Build-Service
+# COPYRIGHT     : (c) 2011 SUSE LINUX Products GmbH, Germany
+#               :
+# AUTHOR        : Robert Schweikert &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&gt;
+#               :
+# BELONGS TO    : Operating System images
+#               :
+# DESCRIPTION   : This module is used to check setup and other conditions
+#               : that can only be verified when KIWI is running. An example
+#               : is the check for required tools such as filesystem tools,
+#               : where we only know at runtime what file system tool we
+#               : actually need.
+#               :
+# STATUS        : Development
+#----------------
+package KIWIRuntimeChecker;
+#==========================================
+# Modules
+#------------------------------------------
+use strict;
+use warnings;
+require Exporter;
+use KIWILocator;
+use KIWILog;
+
+
+#==========================================
+# Exports
+#------------------------------------------
+our @ISA    = qw (Exporter);
+our @EXPORT = qw (createChecks prepareChecks);
+
+#==========================================
+# Constructor
+#------------------------------------------
+sub new {
+	# ...
+	# Create the RuntimChecker object
+	# ---
+	#==========================================
+	# Object setup
+	#------------------------------------------
+	my $this  = {};
+	my $class = shift;
+	bless $this,$class;
+	#==========================================
+	# Module Parameters
+	#------------------------------------------
+	my $kiwi    = shift;
+	my $cmdArgs = shift;
+	my $xml     = shift;
+	#==========================================
+	# Check pre-conditions
+	#------------------------------------------
+	if (! $cmdArgs ) {
+		my $msg = 'Expecting reference to KIWICommandLine object as second '
+		. 'argument.';
+		$kiwi -&gt; error ($msg);
+		$kiwi -&gt; failed ();
+		return undef;
+	}
+	if (! $xml ) {
+		my $msg = 'Expecting reference to KIWIXML object as third argument.';
+		$kiwi -&gt; error ($msg);
+		$kiwi -&gt; failed ();
+		return undef;
+	}
+	#==========================================
+	# Constructor setup
+	#------------------------------------------
+	if (! defined $kiwi) {
+		$kiwi = new KIWILog();
+	}
+	$this-&gt;{cmdArgs} = $cmdArgs;
+	$this-&gt;{locator} = new KIWILocator($kiwi);
+	$this-&gt;{kiwi}    = $kiwi;
+	$this-&gt;{xml}     = $xml;
+	return $this;
+}
+
+#==========================================
+# createChecks
+#------------------------------------------
+sub createChecks {
+	# ...
+	# Runtime checks specific to the create step
+	# ---
+	my $this = shift;
+	if (! $this -&gt; __haveValidTypeString()) {
+		return undef;
+	}
+	if (! $this -&gt; __checkFilesystemTool()) {
+		return undef;
+	}
+	if (! $this -&gt; __checkHaveTypeToBuild()) {
+		return undef;
+	}
+	return 1;
+}
+
+#==========================================
+# prepareChecks
+#------------------------------------------
+sub prepareChecks {
+	# ...
+	# Runtime checks specific to the prepare step
+	# ---
+	my $this = shift;
+	if (! $this -&gt; __haveValidTypeString()) {
+		return undef;
+	}
+	if (! $this -&gt; __checkHaveTypeToBuild()) {
+		return undef;
+	}
+	if (! $this -&gt; __checkPatternTypeAttrrValueConsistent()) {
+		return undef;
+	}
+	return 1;
+}
+
+#==========================================
+# Private helper methods
+#------------------------------------------
+sub __haveValidTypeString {
+	# ...
+	# if the commandline data set contains a buildtype
+	# information, check if it contains a valid string
+	# This check must be done for prepare and create in
+	# order to early detect a broken commandline when
+	# using prepare + create in one call by the --build
+	# option
+	# ---
+	my $this = shift;
+	my $cmdL = $this -&gt; {cmdArgs};
+	my $type = $cmdL -&gt; getBuildType();
+	my @allowedTypes = qw (
+		btrfs clicfs cpio ext2 ext3 ext4 iso
+		oem product pxe reiserfs split squashfs
+		usb vmx xfs
+	);
+	if ($type) {
+		if (! grep /$type/, @allowedTypes) {
+			my $kiwi = $this -&gt; {kiwi};
+			my $msg = 'Specified value for &quot;type&quot; command line argument is not '
+			. 'valid.';
+			$kiwi -&gt; error ($msg);
+			$kiwi -&gt; failed();
+			return undef;
+		}
+	}
+	return 1;
+}
+
+#==========================================
+# __checkFilesystemTool
+#------------------------------------------
+sub __checkFilesystemTool {
+	# ...
+	# Check that the build system has the necessary file
+	# system tools installed for the requested build.
+	# ---
+	my $this = shift;
+	my $cmdL = $this -&gt; {cmdArgs};
+	my $xml  = $this -&gt; {xml};
+	my %type = %{$xml-&gt;getImageTypeAndAttributes()};
+	my $typeName = $type{type};
+	my $flag     = $type{flags};
+	my $toolError;
+	my $checkedFS;
+	my @knownFsTypes = qw (
+		btrfs clicfs ext2 ext3 ext4 reiserfs squashfs xfs cpio
+	);
+	if (grep /^$typeName/, @knownFsTypes) {
+		my $haveTool = $this -&gt; __isFsToolAvailable($typeName);
+		$checkedFS = $typeName;
+		if (! $haveTool) {
+			$toolError = 1;
+		}
+	} elsif ($typeName eq 'iso') {
+		my $haveTool = $this -&gt; {locator} -&gt; getExecPath('mkisofs');
+		if (! $haveTool) {
+			$checkedFS = 'mkisofs';
+			$toolError = 1;
+		}
+		if ($flag &amp;&amp; $flag eq 'clic') {
+			$haveTool = $this -&gt; __isFsToolAvailable('clicfs');
+			$checkedFS = 'clicfs';
+		} elsif ($flag &amp;&amp; $flag eq 'compressed') {
+			$haveTool = $this -&gt; __isFsToolAvailable('squashfs');
+			$checkedFS = 'squashfs';
+		} elsif ($flag &amp;&amp; $flag eq 'unified') {
+			$haveTool = $this -&gt; __isFsToolAvailable('squashfs');
+			$checkedFS = 'squashfs';
+		}
+		if (! $haveTool) {
+			$toolError = 1;
+		}
+	} else {
+		my @fsType = ($type{filesystem});
+		if ($type{filesystem} =~ /(.*),(.*)/) {
+			@fsType = ($1,$2);
+		}
+		foreach my $fs (@fsType) {
+			my $haveTool = $this -&gt; __isFsToolAvailable($fs);
+			if (! $haveTool) {
+				$checkedFS = $fs;
+				$toolError = 1;
+			}
+		}
+	}
+	if ($toolError) {
+		my $kiwi = $this -&gt; {kiwi};
+		my $msg = 'Requested image creation with filesystem &quot;'
+		. $checkedFS
+		. '&quot;; but tool to create the file system could not '
+		. 'be found.';
+		$kiwi -&gt; error($msg);
+		$kiwi -&gt; failed();
+		return undef;
+	}
+	return 1;
+}
+
+#==========================================
+# __checkHaveTypeToBuild
+#------------------------------------------
+sub __checkHaveTypeToBuild {
+	# ...
+	# Check that there is a type to build:
+	# 1.) config file must have &lt;preferences&gt; without profile
+	# or
+	# 2.) one profile on a &lt;preferences&gt; element is marked as default
+	# or
+	# 3.) one profile on a &lt;preferences&gt; element specified on the command line
+	# ---
+	#TODO
+	# implement when XML becomes a dumb container and looses notion of state
+	return 1;
+}
+
+#==========================================
+# __checkPatternTypeAttrValueConsistent
+#------------------------------------------
+sub __checkPatternTypeAttrrValueConsistent {
+	# ...
+	# Check that the use of the patternType attribute for the &lt;packages&gt;
+	# element is consistent. The static component of this is checked during
+	# XML validation. If no profiles are specified on the command line
+	# or if the configuration contains a &lt;packages&gt; element without a
+	# profile attribute there is nothing to do.
+	# ---
+	my $this = shift;
+	my $buildProfiles = $this -&gt; {cmdArgs} -&gt; getBuildProfiles();
+	# If no profiles are specified on the command line the static check is
+	# sufficient
+	if ( (ref $buildProfiles) ne 'ARRAY') {
+		return 1;
+	}
+	my @buildProfiles = @{$buildProfiles};
+	# If there is a &quot;default&quot; &lt;packages&gt; element, i.e. an element without the
+	# profiles attribute the static check is sufficient
+	if ($this -&gt; {xml} -&gt; hasDefaultPackages() ) {
+		return 1;
+	}
+	# If there is only one profile to be built there is nothing to check
+	my $numProfiles = @buildProfiles;
+	if ($numProfiles == 1) {
+		return 1;
+	}
+	my @pkgsNodes = @{$this -&gt; {xml} -&gt; getPackageNodeList()};
+	my $reqPatternTypeVal;
+	for my $pkgs (@pkgsNodes) {
+		my $profiles = $pkgs -&gt; getAttribute( 'profiles' );
+		my @profNames = split /,/, $profiles;
+		my $patternType = $pkgs -&gt; getAttribute( 'patternType' );
+		if (! $patternType) {
+			$patternType = 'onlyRequired';
+		}
+		for my $profName (@profNames) {
+			if (grep /^$profName/, @buildProfiles) {
+				if (! $reqPatternTypeVal) {
+					$reqPatternTypeVal = $patternType;
+				} elsif ($reqPatternTypeVal ne $patternType) {
+					my $kiwi = $this -&gt; {kiwi};
+					my $msg = 'Conflicting patternType attribute values for '
+					. 'specified profiles &quot;'
+					. &quot;@buildProfiles&quot;
+					. '&quot; found';
+					$kiwi -&gt; error ( $msg );
+					$kiwi -&gt; failed ();
+					return undef;
+				}
+			}
+		}
+	}
+	return 1;
+}
+
+#==========================================
+# __isFsToolAvailable
+#------------------------------------------
+sub __isFsToolAvailable {
+	# ...
+	# Find the tool for a given filesystem name
+	# ---
+	my $this   = shift;
+	my $fsType = shift;
+	my $locator = $this -&gt; {locator};
+	if ($fsType eq 'btrfs' ) {
+		$locator -&gt; getExecPath('mkfs.btrfs');
+	}
+	if ($fsType eq 'clicfs' ) {
+		return $locator -&gt; getExecPath('mkclicfs');
+	}
+	if ($fsType eq 'cpio' ) {
+		return $locator -&gt; getExecPath('cpio');
+	}
+	if ($fsType eq 'ext2' ) {
+		return $locator -&gt; getExecPath('mkfs.ext2');
+	}
+	if ($fsType eq 'ext3' ) {
+		return $locator -&gt; getExecPath('mkfs.ext3');
+	}
+	if ($fsType eq 'ext4' ) {
+		return $locator -&gt; getExecPath('mkfs.ext4');
+	}
+	if ($fsType eq 'reiserfs' ) {
+		return $locator -&gt; getExecPath('mkreiserfs');
+	}
+	if ($fsType eq 'squashfs' ) {
+		return $locator -&gt; getExecPath('mksquashfs');
+	}
+	if ($fsType eq 'xfs' ) {
+		return $locator -&gt; getExecPath('mkfs.xfs');
+	}
+}
+
+1;
diff --git a/modules/KIWISchema.rng b/modules/KIWISchema.rng
index e6f0a8b..83a835b 100644
--- a/modules/KIWISchema.rng
+++ b/modules/KIWISchema.rng
@@ -444,7 +444,7 @@ cert-*.pem&lt;/a:documentation&gt;
         &lt;a:documentation&gt;Specify the region/availability zone&lt;/a:documentation&gt;
         &lt;db:para&gt;Specify the region/availability zone in EC2 for this image.
 Values are limited to the EC2 recognized zones:
-AP-Singapore, EU-West, US-East, and US-West&lt;/db:para&gt;
+AP-Japan, AP-Singapore, EU-West, US-East, and US-West&lt;/db:para&gt;
         &lt;ref name=&quot;k.ec2region.attlist&quot;/&gt;
         &lt;text/&gt;
       &lt;/element&gt;
diff --git a/modules/KIWIXML.pm b/modules/KIWIXML.pm
index 3cc0c2b..1d786df 100644
--- a/modules/KIWIXML.pm
+++ b/modules/KIWIXML.pm
@@ -30,6 +30,7 @@ use KIWILog;
 use KIWIManager qw (%packageManager);
 use KIWIOverlay;
 use KIWIQX;
+use KIWIURL;
 use KIWIXMLValidator;
 
 #==========================================
@@ -3334,8 +3335,8 @@ sub getNodeList {
 #------------------------------------------
 sub getPackageNodeList {
 	# ...
-	# Return the current &lt;packages&gt; list which consists
-	# of XML::LibXML::Element object pointers
+	# Return a list of all &lt;packages&gt; nodes. Each list member
+	# is an XML::LibXML::Element object pointer
 	# ---
 	my $this = shift;
 	return $this-&gt;{packageNodeList};
@@ -3993,6 +3994,27 @@ sub buildImageName {
 }
 
 #==========================================
+# hasDefaultPackages
+#------------------------------------------
+sub hasDefaultPackages {
+	# ...
+	# Returns true if a &lt;packages&gt; element exists that
+	# has no profiles attribute.
+	# ---
+	my $this = shift;
+	for my $pkgs (@{$this-&gt;{packageNodeList} }) {
+		my $type = $pkgs -&gt; getAttribute( 'type' );
+		if ($type eq 'image') {
+			my $profiles = $pkgs -&gt; getAttribute ('profiles');
+			if (! $profiles) {
+				return 1;
+			}
+		}
+	}
+	return 0;
+}
+
+#==========================================
 # Private helper methods
 #------------------------------------------
 #==========================================
@@ -4884,6 +4906,11 @@ sub __populateImageTypeAndNode {
 	#==========================================
 	# check selection
 	#------------------------------------------
+	if (! $select) {
+		$kiwi -&gt; error  ('Cannot determine build type');
+		$kiwi -&gt; failed ();
+		return undef;
+	}
 	if (! $typeinfo-&gt;{$select}) {
 		$kiwi -&gt; error  (&quot;Can't find requested image type: $select&quot;);
 		$kiwi -&gt; failed ();
diff --git a/modules/KIWIXMLValidator.pm b/modules/KIWIXMLValidator.pm
index 2f4c803..6372b33 100644
--- a/modules/KIWIXMLValidator.pm
+++ b/modules/KIWIXMLValidator.pm
@@ -317,15 +317,15 @@ sub __checkPatternTypeAttrConsistent {
 	# the value set for the default profile.
 	# ---
 	my $this = shift;
-	my @pkgsNodes = $this-&gt;{systemTree} -&gt; getElementsByTagName(&quot;packages&quot;);
+	my @pkgsNodes = $this-&gt;{systemTree} -&gt; getElementsByTagName('packages');
 	my $defPatternTypeVal = '';
 	my $defPackSection;
 	# Check if a &lt;packages&gt; spec without a profiles attribute exists
 	for my $pkgs (@pkgsNodes) {
-		if ( (! $pkgs -&gt; getAttribute( &quot;profiles&quot; ))
-			&amp;&amp; ($pkgs -&gt; getAttribute( &quot;type&quot; ) eq 'image')) {
+		if ( (! $pkgs -&gt; getAttribute( 'profiles' ))
+			&amp;&amp; ($pkgs -&gt; getAttribute( 'type' ) eq 'image')) {
 			$defPackSection = $pkgs;
-			my $patternType = $pkgs -&gt; getAttribute( &quot;patternType&quot; );
+			my $patternType = $pkgs -&gt; getAttribute( 'patternType' );
 			if ($patternType) {
 				$defPatternTypeVal = $patternType;
 			} else {
@@ -338,10 +338,10 @@ sub __checkPatternTypeAttrConsistent {
 	# multiple times, the value of patternType must be the same for each use
 	my %profPatternUseMap = ();
 	for my $pkgs (@pkgsNodes) {
-		my $profiles = $pkgs -&gt; getAttribute( &quot;profiles&quot; );
+		my $profiles = $pkgs -&gt; getAttribute( 'profiles' );
 		if ($profiles) {
 			my @profNames = split /,/, $profiles;
-			my $patternType = $pkgs -&gt; getAttribute( &quot;patternType&quot; );
+			my $patternType = $pkgs -&gt; getAttribute( 'patternType' );
 			if (! $patternType) {
 				$patternType = 'onlyRequired';
 			}
@@ -367,7 +367,7 @@ sub __checkPatternTypeAttrConsistent {
 	}
 	for my $pkgs (@pkgsNodes) {
 		if ($pkgs != $defPackSection) {
-			my $patternType = $pkgs -&gt; getAttribute( &quot;patternType&quot; );
+			my $patternType = $pkgs -&gt; getAttribute( 'patternType' );
 			if ($patternType &amp;&amp; $patternType ne $defPatternTypeVal) {
 				my $kiwi = $this-&gt;{kiwi};
 				my $msg = 'The specified value &quot;'
@@ -380,7 +380,7 @@ sub __checkPatternTypeAttrConsistent {
 				$kiwi -&gt; failed ();
 				return undef
 			}
-			my $type = $pkgs -&gt; getAttribute( &quot;type&quot; );
+			my $type = $pkgs -&gt; getAttribute( 'type' );
 			if (! $patternType
 				&amp;&amp; $type ne 'bootstrap'
 				&amp;&amp; $type ne 'delete'
@@ -510,7 +510,8 @@ sub __checkPreferencesDefinition {
 #------------------------------------------
 sub __checkProfileNames {
 	# ...
-	# Check that a profile name does not contain whitespace.
+	# Check that a profile name does not contain whitespace, and is not
+	# named &quot;all&quot;. &quot;all&quot; has a special meaning in Kiwi :(
 	# ---
 	my $this = shift;
 	my @profiles = $this-&gt;{systemTree} -&gt; getElementsByTagName('profile');
@@ -523,6 +524,13 @@ sub __checkProfileNames {
 			$kiwi -&gt; failed();
 			return undef;
 		}
+		if ($name =~ /^all$/) {
+			my $kiwi = $this -&gt; {kiwi};
+			my $msg = 'Name of a profile may not be set to &quot;all&quot;.';
+			$kiwi -&gt; error ($msg);
+			$kiwi -&gt; failed();
+			return undef;
+		}
 	}
 	return 1;
 }
diff --git a/tests/unit/KIWILocator.t b/tests/unit/KIWICommandLine.t
similarity index 89%
copy from tests/unit/KIWILocator.t
copy to tests/unit/KIWICommandLine.t
index 91f6fc3..f04ff66 100644
--- a/tests/unit/KIWILocator.t
+++ b/tests/unit/KIWICommandLine.t
@@ -1,5 +1,5 @@
 #================
-# FILE          : KIWILocator.t
+# FILE          : KIWICommandLine.t
 #----------------
 # PROJECT       : OpenSUSE Build-Service
 # COPYRIGHT     : (c) 2011 Novell Inc.
@@ -24,4 +24,4 @@ use lib &quot;$FindBin::Bin/lib&quot;;
 use lib &quot;$FindBin::Bin/../../modules&quot;;
 
 my $runner = Test::Unit::HarnessUnit-&gt;new();
-$runner-&gt;start( 'Test::kiwiLocator' );
+$runner-&gt;start( 'Test::kiwiCommandLine' );
diff --git a/tests/unit/KIWIRuntimeChecker.t b/tests/unit/KIWIRuntimeChecker.t
new file mode 100644
index 0000000..cc9f168
--- /dev/null
+++ b/tests/unit/KIWIRuntimeChecker.t
@@ -0,0 +1,37 @@
+#================
+# FILE          : KIWIRuntimeChecker.t
+#----------------
+# PROJECT       : OpenSUSE Build-Service
+# COPYRIGHT     : (c) 2011 Novell Inc.
+#               :
+# AUTHOR        : Robert Schweikert &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&gt;
+#               :
+# BELONGS TO    : Operating System images
+#               :
+# DESCRIPTION   : Unit test driver for the KIWIRuntimeChecker module.
+#               :
+# STATUS        : Development
+#----------------
+use strict;
+use warnings;
+use FindBin;
+use Test::Unit::HarnessUnit;
+
+# Location of test cases according to program path
+use lib &quot;$FindBin::Bin/lib&quot;;
+
+# Location of Kiwi modules relative to test
+use lib &quot;$FindBin::Bin/../../modules&quot;;
+
+# TODO eliminate the following variables
+# Set some variables that are encoded in kiwi.pl and are used by KIWIXML via
+# direct access through $main::*
+# Once KIWIXML ctor args change this can be eliminated
+our $KSplit    = &quot;$FindBin::Bin/../../modules/KIWISplit.txt&quot;;
+our $Revision  = &quot;$FindBin::Bin/data/kiwiRuntimeChecker/revision&quot;;
+our $Schema    = &quot;$FindBin::Bin/../../modules/KIWISchema.rng&quot;;
+our $SchemaCVT = &quot;$FindBin::Bin/../../xsl/master.xsl&quot;;
+# END variable hack
+
+my $runner = Test::Unit::HarnessUnit-&gt;new();
+$runner-&gt;start( 'Test::kiwiRuntimeChecker' );
diff --git a/tests/unit/data/kiwiRuntimeChecker/README.txt b/tests/unit/data/kiwiRuntimeChecker/README.txt
new file mode 100644
index 0000000..404d880
--- /dev/null
+++ b/tests/unit/data/kiwiRuntimeChecker/README.txt
@@ -0,0 +1,6 @@
+At present (02/24/2011) it is not possible to create a KIWIXML object by
+passing an XML file name. Thus for testing purposes when an XML file is
+required we need to create a separate directory containing a config.xml file.
+
+Once the KIWIXML objects ctor has been changed, XML files can be collected in
+one directory with more meaningful names.
diff --git a/tests/unit/data/xmlValidator/patternTattrConsValid_1.xml b/tests/unit/data/kiwiRuntimeChecker/config.xml
similarity index 96%
copy from tests/unit/data/xmlValidator/patternTattrConsValid_1.xml
copy to tests/unit/data/kiwiRuntimeChecker/config.xml
index a416d47..369f502 100644
--- a/tests/unit/data/xmlValidator/patternTattrConsValid_1.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/config.xml
@@ -1,4 +1,5 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
+
 &lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-xml-validator-test&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
@@ -28,8 +29,8 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;$1$wYJUgpM5$RXMMeASDc035eX.NbYWFl0&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot; profiles=&quot;my-first&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/btrfs/config.xml
similarity index 67%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/fileSysImg/btrfs/config.xml
index be0b4b7..469bbeb 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/btrfs/config.xml
@@ -1,37 +1,31 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;btrfs-test-config&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;Test configuration for runtime validtaion using btrfs as image type.&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
 		&lt;version&gt;1.0.0&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
+		&lt;type image=&quot;btrfs&quot;/&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
-		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;ifplugd&quot;/&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;vim&quot;/&gt;
 		&lt;opensusePattern name=&quot;base&quot;/&gt;
 	&lt;/packages&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext2/config.xml
similarity index 67%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext2/config.xml
index be0b4b7..a2be866 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext2/config.xml
@@ -1,37 +1,31 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;ext2-test-config&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;Test configuration for runtime validtaion using ext2 as image type.&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
 		&lt;version&gt;1.0.0&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
+		&lt;type image=&quot;ext2&quot;/&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
-		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;ifplugd&quot;/&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;vim&quot;/&gt;
 		&lt;opensusePattern name=&quot;base&quot;/&gt;
 	&lt;/packages&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext3/config.xml
similarity index 67%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext3/config.xml
index be0b4b7..427b2e6 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext3/config.xml
@@ -1,37 +1,31 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;ext3-test-config&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;Test configuration for runtime validtaion using ext3 as image type.&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
 		&lt;version&gt;1.0.0&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
+		&lt;type image=&quot;ext3&quot;/&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
-		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;ifplugd&quot;/&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;vim&quot;/&gt;
 		&lt;opensusePattern name=&quot;base&quot;/&gt;
 	&lt;/packages&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext4/config.xml
similarity index 67%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext4/config.xml
index be0b4b7..978eb24 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/ext4/config.xml
@@ -1,37 +1,31 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;ext4-test-config&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;Test configuration for runtime validtaion using ext4 as image type.&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
 		&lt;version&gt;1.0.0&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
+		&lt;type image=&quot;ext4&quot;/&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
-		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;ifplugd&quot;/&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;vim&quot;/&gt;
 		&lt;opensusePattern name=&quot;base&quot;/&gt;
 	&lt;/packages&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/reiserfs/config.xml
similarity index 67%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/fileSysImg/reiserfs/config.xml
index be0b4b7..c5d43be 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/reiserfs/config.xml
@@ -1,37 +1,31 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;reiserfs-test-config&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;Test configuration for runtime validtaion using reiserfs as image type.&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
 		&lt;version&gt;1.0.0&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
+		&lt;type image=&quot;reiserfs&quot;/&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
-		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;ifplugd&quot;/&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;vim&quot;/&gt;
 		&lt;opensusePattern name=&quot;base&quot;/&gt;
 	&lt;/packages&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/xfs/config.xml
similarity index 67%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/fileSysImg/xfs/config.xml
index be0b4b7..f4ecfc7 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/fileSysImg/xfs/config.xml
@@ -1,37 +1,31 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;xfs-test-config&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;Test configuration for runtime validtaion using xfs as image type.&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
 		&lt;version&gt;1.0.0&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
 		&lt;locale&gt;en_US&lt;/locale&gt;
 		&lt;keytable&gt;us.map.gz&lt;/keytable&gt;
+		&lt;type image=&quot;xfs&quot;/&gt;
 	&lt;/preferences&gt;
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
 	&lt;packages type=&quot;image&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
-		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;ifplugd&quot;/&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
 		&lt;package name=&quot;vim&quot;/&gt;
 		&lt;opensusePattern name=&quot;base&quot;/&gt;
 	&lt;/packages&gt;
diff --git a/tests/unit/data/xmlValidator/patternTattrConsValid_2.xml b/tests/unit/data/kiwiRuntimeChecker/haveDefaultPkgs/config.xml
similarity index 93%
copy from tests/unit/data/xmlValidator/patternTattrConsValid_2.xml
copy to tests/unit/data/kiwiRuntimeChecker/haveDefaultPkgs/config.xml
index b51b02d..1eda1ad 100644
--- a/tests/unit/data/xmlValidator/patternTattrConsValid_2.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/haveDefaultPkgs/config.xml
@@ -1,4 +1,5 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
+
 &lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-xml-validator-test&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
@@ -28,9 +29,12 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;$1$wYJUgpM5$RXMMeASDc035eX.NbYWFl0&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
+	&lt;packages type=&quot;image&quot; patternType=&quot;plusRecommended&quot;&gt;
+		&lt;package name=&quot;yast2&quot;/&gt;
+	&lt;/packages&gt;
 	&lt;packages type=&quot;image&quot; profiles=&quot;my-first&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/liveIsoImg/clic/config.xml
similarity index 63%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/liveIsoImg/clic/config.xml
index be0b4b7..b6c212e 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/liveIsoImg/clic/config.xml
@@ -1,20 +1,14 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;test-filetools-verification&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;test configuration for filesystem tools checking using clicfs via flag&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
-		&lt;version&gt;1.0.0&lt;/version&gt;
+		&lt;type image=&quot;iso&quot; primary=&quot;true&quot; boot=&quot;isoboot/suse-11.4&quot; flags=&quot;clic&quot;/&gt;
+		&lt;version&gt;2.5.2&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
@@ -24,10 +18,10 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
-	&lt;packages type=&quot;image&quot;&gt;
+	&lt;packages type=&quot;image&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;kernel-default&quot;/&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/liveIsoImg/compressed/config.xml
similarity index 63%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/liveIsoImg/compressed/config.xml
index be0b4b7..d1575da 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/liveIsoImg/compressed/config.xml
@@ -1,20 +1,14 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;test-filetools-verification&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;test configuration for filesystem tools checking using squashfs via flag&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
-		&lt;version&gt;1.0.0&lt;/version&gt;
+		&lt;type image=&quot;iso&quot; primary=&quot;true&quot; boot=&quot;isoboot/suse-11.4&quot; flags=&quot;compressed&quot;/&gt;
+		&lt;version&gt;2.5.2&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
@@ -24,10 +18,10 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
-	&lt;packages type=&quot;image&quot;&gt;
+	&lt;packages type=&quot;image&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;kernel-default&quot;/&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/liveIsoImg/unified/config.xml
similarity index 63%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/liveIsoImg/unified/config.xml
index be0b4b7..c62f492 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/liveIsoImg/unified/config.xml
@@ -1,20 +1,14 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;test-filetools-verification&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;test configuration for filesystem tools checking using squashfs via flag&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
-		&lt;version&gt;1.0.0&lt;/version&gt;
+		&lt;type image=&quot;iso&quot; primary=&quot;true&quot; boot=&quot;isoboot/suse-11.4&quot; flags=&quot;unified&quot;/&gt;
+		&lt;version&gt;2.5.2&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
@@ -24,10 +18,10 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;/tmp&quot;/&gt;
 	&lt;/repository&gt;
-	&lt;packages type=&quot;image&quot;&gt;
+	&lt;packages type=&quot;image&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;kernel-default&quot;/&gt;
diff --git a/tests/unit/data/xmlValidator/patternTattrConsValid_1.xml b/tests/unit/data/kiwiRuntimeChecker/noDefaultBuildType/config.xml
similarity index 88%
copy from tests/unit/data/xmlValidator/patternTattrConsValid_1.xml
copy to tests/unit/data/kiwiRuntimeChecker/noDefaultBuildType/config.xml
index a416d47..6cce5ee 100644
--- a/tests/unit/data/xmlValidator/patternTattrConsValid_1.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/noDefaultBuildType/config.xml
@@ -1,15 +1,16 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-xml-validator-test&quot;&gt;
+
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-runtime-validator-test&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.</A>&lt;/contact&gt;
-		&lt;specification&gt;test patternType usage consistency, no default packages section, different attribute values&lt;/specification&gt;
+		&lt;specification&gt;test case to check that config without default build type and no prof spec on command line causes early exit&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;profiles&gt;
 		&lt;profile name=&quot;my-first&quot; description=&quot;a first test profile&quot;/&gt;
 		&lt;profile name=&quot;my-second&quot; description=&quot;a second test profile&quot;/&gt;
 	&lt;/profiles&gt;
-	&lt;preferences&gt;
+	&lt;preferences profiles=&quot;my-first&quot;&gt;
 		&lt;type image=&quot;vmx&quot; primary=&quot;true&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
 			&lt;machine memory=&quot;1024&quot;&gt;
 				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/oemBtrfs/config.xml
similarity index 63%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/oemBtrfs/config.xml
index be0b4b7..5ee9b6e 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/oemBtrfs/config.xml
@@ -1,20 +1,19 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;test-filesys-tool-check&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;test case for runtime checker location of file system tools, using oem image with btrfs&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
+		&lt;type image=&quot;oem&quot; filesystem=&quot;btrfs&quot; boot=&quot;oemboot/suse-11.3&quot; installstick=&quot;true&quot; installboot=&quot;install&quot;&gt;
+			&lt;oemconfig&gt;
+				&lt;oem-swapsize&gt;2048&lt;/oem-swapsize&gt;
+				&lt;oem-unattended&gt;true&lt;/oem-unattended&gt;
+			&lt;/oemconfig&gt;
 		&lt;/type&gt;
-		&lt;version&gt;1.0.0&lt;/version&gt;
+		&lt;version&gt;0.0.1&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
@@ -24,10 +23,10 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;tmp&quot;/&gt;
 	&lt;/repository&gt;
-	&lt;packages type=&quot;image&quot;&gt;
+	&lt;packages type=&quot;image&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;kernel-default&quot;/&gt;
diff --git a/tests/unit/data/xmlValidator/revision.txt b/tests/unit/data/kiwiRuntimeChecker/revision
similarity index 100%
copy from tests/unit/data/xmlValidator/revision.txt
copy to tests/unit/data/kiwiRuntimeChecker/revision
diff --git a/tests/unit/data/kiwiLocator/config.xml b/tests/unit/data/kiwiRuntimeChecker/splitImg/config.xml
similarity index 63%
copy from tests/unit/data/kiwiLocator/config.xml
copy to tests/unit/data/kiwiRuntimeChecker/splitImg/config.xml
index be0b4b7..07826e0 100644
--- a/tests/unit/data/kiwiLocator/config.xml
+++ b/tests/unit/data/kiwiRuntimeChecker/splitImg/config.xml
@@ -1,20 +1,16 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
 
-&lt;image schemaversion=&quot;5.2&quot; name=&quot;suse-11.3-vm-guest&quot;&gt;
+&lt;image schemaversion=&quot;5.2&quot; name=&quot;test-filesys-tool-check-split&quot;&gt;
 	&lt;description type=&quot;system&quot;&gt;
 		&lt;author&gt;Robert Schweikert&lt;/author&gt;
 		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&lt;/contact&gt;
-		&lt;specification&gt;Generic valid configuration file&lt;/specification&gt;
+		&lt;specification&gt;test case for runtime checker location of file system tools, using split image with squashfs and btrfs&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;preferences&gt;
-		&lt;type image=&quot;vmx&quot; filesystem=&quot;ext4&quot; boot=&quot;vmxboot/suse-11.3&quot; format=&quot;vmdk&quot;&gt;
-			&lt;machine memory=&quot;512&quot;&gt;
-				&lt;vmdisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
-				&lt;vmnic interface=&quot;0&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-				&lt;vmnic interface=&quot;1&quot; driver=&quot;e1000&quot; mode=&quot;bridged&quot;/&gt;
-			&lt;/machine&gt;
-		&lt;/type&gt;
-		&lt;version&gt;1.0.0&lt;/version&gt;
+&lt;!-- Test assumes that the squashfs tool is available, if not--&gt;
+&lt;!-- test will fail --&gt;
+		&lt;type image=&quot;split&quot; fsreadwrite=&quot;btrfs&quot; fsreadonly=&quot;squashfs&quot; boot=&quot;oemboot/suse-11.3&quot; installiso=&quot;true&quot;/&gt;
+		&lt;version&gt;0.0.1&lt;/version&gt;
 		&lt;packagemanager&gt;zypper&lt;/packagemanager&gt;
 		&lt;rpm-check-signatures&gt;false&lt;/rpm-check-signatures&gt;
 		&lt;rpm-force&gt;true&lt;/rpm-force&gt;
@@ -24,10 +20,10 @@
 	&lt;users group=&quot;root&quot;&gt;
 		&lt;user pwd=&quot;linux&quot; pwdformat=&quot;plain&quot; home=&quot;/root&quot; name=&quot;root&quot;/&gt;
 	&lt;/users&gt;
-	&lt;repository type=&quot;yast2&quot;&gt;
-		&lt;source path=&quot;<A HREF="opensuse://11.3/repo/oss/">opensuse://11.3/repo/oss/</A>&quot;/&gt;
+	&lt;repository type=&quot;rpm-dir&quot;&gt;
+		&lt;source path=&quot;tmp&quot;/&gt;
 	&lt;/repository&gt;
-	&lt;packages type=&quot;image&quot;&gt;
+	&lt;packages type=&quot;image&quot; patternType=&quot;plusRecommended&quot;&gt;
 		&lt;package name=&quot;bootsplash-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;gfxboot-branding-openSUSE&quot; bootinclude=&quot;true&quot; bootdelete=&quot;true&quot;/&gt;
 		&lt;package name=&quot;kernel-default&quot;/&gt;
diff --git a/tests/unit/data/xmlValidator/profileNameInvalid_1.xml b/tests/unit/data/xmlValidator/profileNameInvalid_2.xml
similarity index 95%
copy from tests/unit/data/xmlValidator/profileNameInvalid_1.xml
copy to tests/unit/data/xmlValidator/profileNameInvalid_2.xml
index 0b9c620..2e0f766 100644
--- a/tests/unit/data/xmlValidator/profileNameInvalid_1.xml
+++ b/tests/unit/data/xmlValidator/profileNameInvalid_2.xml
@@ -6,7 +6,7 @@
 		&lt;specification&gt;test profile name validation&lt;/specification&gt;
 	&lt;/description&gt;
 	&lt;profiles&gt;
-		&lt;profile name=&quot;xen Flavour&quot; description=&quot;VMX with Xen kernel&quot; import=&quot;true&quot;/&gt;
+		&lt;profile name=&quot;all&quot; description=&quot;VMX with Xen kernel&quot; import=&quot;true&quot;/&gt;
 	&lt;/profiles&gt;
 	&lt;preferences&gt;
 		&lt;type primary=&quot;true&quot; image=&quot;oem&quot; filesystem=&quot;ext4&quot; boot=&quot;oemboot/suse-11.3&quot; installiso=&quot;true&quot; installboot=&quot;install&quot;&gt; 
diff --git a/tests/unit/lib/Common/ktLog.pm b/tests/unit/lib/Common/ktLog.pm
index 783aa50..5d684be 100644
--- a/tests/unit/lib/Common/ktLog.pm
+++ b/tests/unit/lib/Common/ktLog.pm
@@ -102,6 +102,66 @@ sub failed {
 }
 
 #==========================================
+# getErrorMessage
+#------------------------------------------
+sub getErrorMessage {
+	# ...
+	# Retrieve the error message.
+	# In general the getMessage method should be used. However, under certain
+	# test conditions it is unavoidable to have multiple messages in the log
+	# object. For these rare occasions the log allows access to the specific
+	# message types directly.
+	# ---
+	my $this = shift;
+	return $this -&gt; {errMsg};
+}
+
+#==========================================
+# getInfoMessage
+#------------------------------------------
+sub getInfoMessage {
+	# ...
+	# Retrieve the info message.
+	# In general the getMessage method should be used. However, under certain
+	# test conditions it is unavoidable to have multiple messages in the log
+	# object. For these rare occasions the log allows access to the specific
+	# message types directly.
+	# ---
+	my $this = shift;
+	return $this -&gt; {infoMsg};
+}
+
+#==========================================
+# getLogInfoMessage
+#------------------------------------------
+sub getLogInfoMessage {
+	# ...
+	# Retrieve the loginfo message.
+	# In general the getMessage method should be used. However, under certain
+	# test conditions it is unavoidable to have multiple messages in the log
+	# object. For these rare occasions the log allows access to the specific
+	# message types directly.
+	# ---
+	my $this = shift;
+	return $this -&gt; {logInfoMsg};
+}
+
+#==========================================
+# getWarningMessage
+#------------------------------------------
+sub getWarningMessage {
+	# ...
+	# Retrieve the error message.
+	# In general the getMessage method should be used. However, under certain
+	# test conditions it is unavoidable to have multiple messages in the log
+	# object. For these rare occasions the log allows access to the specific
+	# message types directly.
+	# ---
+	my $this = shift;
+	return $this -&gt; {warnMsg};
+}
+
+#==========================================
 # getMessage
 #------------------------------------------
 sub getMessage {
@@ -132,6 +192,7 @@ sub getMessage {
 	}
 	if ( $msgCnt &gt; 1 ) {
 		$msg = 'Log error: Multiple messages defined';
+		$this -&gt; __printAllMessages();
 	}
 	return $msg;
 }
@@ -219,6 +280,17 @@ sub skipped {
 }
 
 #==========================================
+# storeXML
+#------------------------------------------
+sub storeXML {
+	# ...
+	# Dummy function, storing the XML has nothing really to do with logging
+	# but that's a discussion for another day.
+	my $this = shift;
+	return $this;
+}
+
+#==========================================
 # warning
 #------------------------------------------
 sub warning {
@@ -235,6 +307,36 @@ sub warning {
 # Private helper methods
 #------------------------------------------
 #==========================================
+# __printAllMessages
+#------------------------------------------
+sub __printAllMessages {
+	# ...
+	# Print all the messages that have been set.
+	# During testing it is expected that the state of the log object is
+	# such that only one message is set. To aid in test development and
+	# failure investigation it is useful when all messages that have been set
+	# get printed upon failure.
+	# ---
+	my $this = shift;
+	if ( $this -&gt; {errMsg} ) {
+		my $msg = $this -&gt; {errMsg};
+		print STDERR &quot;Log set error message: $msg\n&quot;;
+	}
+	if ( $this -&gt; {infoMsg} ) {
+		my $msg = $this -&gt; {infoMsg};
+		print STDERR &quot;Log set info message: $msg\n&quot;;
+	}
+	if ( $this -&gt; {logInfoMsg} ) {
+		my $msg = $this -&gt; {logInfoMsg};
+		print STDERR &quot;Log set loginfo message: $msg\n&quot;;
+	}
+	if ( $this -&gt; {warnMsg} ) {
+		my $msg = $this -&gt; {warnMsg};
+		print STDERR &quot;Log set warning message: $msg\n&quot;;
+	}
+}
+
+#==========================================
 # __reset
 #------------------------------------------
 sub __reset {
diff --git a/tests/unit/lib/Common/ktTestCase.pm b/tests/unit/lib/Common/ktTestCase.pm
index 693ffd0..b702d6d 100644
--- a/tests/unit/lib/Common/ktTestCase.pm
+++ b/tests/unit/lib/Common/ktTestCase.pm
@@ -30,6 +30,36 @@ sub new {
 	return $this;
 }
 
+
+#==========================================
+# assert_array_equal
+#------------------------------------------
+sub assert_array_equal {
+	# ...
+	# Make sure two arrays are equal (element order is not considered)
+	# ---
+	my $this           = shift;
+	my $base_array_ref = shift;
+	my $cmp_array_ref  = shift;
+
+	my @base_array = @{$base_array_ref};
+	my @cmp_array  = @{$cmp_array_ref};
+
+	if (scalar @base_array != scalar @cmp_array) {
+		$this -&gt; assert(0, 'Did not get the expected list of names.');
+	}
+
+	for my $item (@base_array) {
+		if ( ! grep /^$item$/x, @cmp_array ) {
+			my $msg = 'Did not get the expected list of names. '
+			.'Mismatch content.';
+			$self-&gt;assert(0, $msg);
+		}
+	}
+
+return;
+}
+
 #==========================================
 # getBaseDir
 #------------------------------------------
@@ -38,6 +68,7 @@ sub getBaseDir {
 	# Return the directory of the KIWI source tree
 	# ---
 	my $dir = dirname ($FindBin::Bin );
+	return $dir;
 }
 
 #==========================================
diff --git a/tests/unit/lib/Test/kiwiCommandLine.pm b/tests/unit/lib/Test/kiwiCommandLine.pm
new file mode 100644
index 0000000..1934c1c
--- /dev/null
+++ b/tests/unit/lib/Test/kiwiCommandLine.pm
@@ -0,0 +1,124 @@
+#================
+# FILE          : kiwiCommandLine.pm
+#----------------
+# PROJECT       : OpenSUSE Build-Service
+# COPYRIGHT     : (c) 2011 Novell Inc.
+#               :
+# AUTHOR        : Robert Schweikert &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&gt;
+#               :
+# BELONGS TO    : Operating System images
+#               :
+# DESCRIPTION   : Unit test implementation for the KIWICommandLine module..
+#               :
+# STATUS        : Development
+#----------------
+package Test::kiwiCommandLine;
+
+use strict;
+use warnings;
+
+use Common::ktLog;
+use Common::ktTestCase;
+use base qw /Common::ktTestCase/;
+
+use KIWICommandLine;
+
+#==========================================
+# Constructor
+#------------------------------------------
+sub new {
+	# ...
+	# Construct new test case
+	# ---
+	my $this = shift -&gt; SUPER::new(@_);
+	$this -&gt; {kiwi} = new Common::ktLog();
+
+	return $this;
+}
+
+#==========================================
+# test_ctor
+#------------------------------------------
+sub test_ctor {
+	# ...
+	# Test the commandline constructor, it has no error conditions, thus check
+	# the object construction.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = new KIWICommandLine($kiwi);
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_not_null($cmd);
+}
+
+#==========================================
+# test_cmdBuildTypeUsage
+#------------------------------------------
+sub test_cmdBuildTypeUsage {
+	# ...
+	# Test the storage and verification of the build type data
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCmdObj();
+	# Use valid data to set a type information
+	my $res = $cmd -&gt; setBuildType('reiserfs');
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	$this -&gt; assert_not_null($res);
+	# Make sure we can get our data back
+	my $cmdT = $cmd -&gt; getBuildType();
+	$this -&gt; assert_str_equals('reiserfs', $cmdT);
+}
+
+#==========================================
+# test_cmdProfileUsage
+#------------------------------------------
+sub test_cmdProfileUsage {
+	# ...
+	# Test the storage for profile data
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCmdObj();
+	# Set some list data
+	my @profiles = qw(first second);
+	my $res = $cmd -&gt; setBuildProfiles(\@profiles);
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	$this -&gt; assert_not_null($res);
+	# Make sure we can get our data back
+	my @cmdProfs = @{$cmd -&gt; getBuildProfiles()};
+	$this -&gt; assert_array_equal(\@profiles, \@cmdProfs);
+}
+
+#==========================================
+# Private helper methods
+#------------------------------------------
+#==========================================
+# __getCmdObj
+#------------------------------------------
+sub __getCmdObj {
+	# ...
+	# Helper method to create a CommandLine object;
+	# ---
+	my $this = shift;
+	my $cmd = new KIWICommandLine($this -&gt; {kiwi});
+	return $cmd;
+}
+
+1;
diff --git a/tests/unit/lib/Test/kiwiLocator.pm b/tests/unit/lib/Test/kiwiLocator.pm
index e1226ec..03ad28e 100644
--- a/tests/unit/lib/Test/kiwiLocator.pm
+++ b/tests/unit/lib/Test/kiwiLocator.pm
@@ -8,7 +8,7 @@
 #               :
 # BELONGS TO    : Operating System images
 #               :
-# DESCRIPTION   : Unit test implementation for the KIWILocato module.
+# DESCRIPTION   : Unit test implementation for the KIWILocator module.
 #               :
 # STATUS        : Development
 #----------------
@@ -42,7 +42,7 @@ sub new {
 #------------------------------------------
 sub test_ctor {
 	# ...
-	# Test the locator contructor, it has no error conditions, thus check
+	# Test the locator constructor, it has no error conditions, thus check
 	# the object construction.
 	# ---
 	my $this = shift;
@@ -232,9 +232,12 @@ sub test_getExecPerl {
 #==========================================
 # Private helper methods
 #------------------------------------------
+#==========================================
+# __getLocator
+#------------------------------------------
 sub __getLocator {
 	# ...
-	# Helper function to create a KIWILocator object
+	# Helper method to create a KIWILocator object
 	# ---
 	my $this = shift;
 	my $locator = new KIWILocator ( $this -&gt; {kiwi} );
diff --git a/tests/unit/lib/Test/kiwiRuntimeChecker.pm b/tests/unit/lib/Test/kiwiRuntimeChecker.pm
new file mode 100644
index 0000000..427aa0c
--- /dev/null
+++ b/tests/unit/lib/Test/kiwiRuntimeChecker.pm
@@ -0,0 +1,472 @@
+#================
+# FILE          : kiwiRuntimeChecker.pm
+#----------------
+# PROJECT       : OpenSUSE Build-Service
+# COPYRIGHT     : (c) 2011 Novell Inc.
+#               :
+# AUTHOR        : Robert Schweikert &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">rschweikert at novell.com</A>&gt;
+#               :
+# BELONGS TO    : Operating System images
+#               :
+# DESCRIPTION   : Unit test implementation for the KIWIRuntimeChecker module.
+#               :
+# STATUS        : Development
+#----------------
+package Test::kiwiRuntimeChecker;
+
+use strict;
+use warnings;
+
+use Common::ktLog;
+use Common::ktTestCase;
+use base qw /Common::ktTestCase/;
+
+use KIWICommandLine;
+use KIWIRuntimeChecker;
+use KIWIXML;
+
+#==========================================
+# Constructor
+#------------------------------------------
+sub new {
+	# ...
+	# Construct new test case
+	# ---
+	my $this = shift -&gt; SUPER::new(@_);
+	$this -&gt; {dataDir} = $this -&gt; getDataDir() . '/kiwiRuntimeChecker';
+	$this -&gt; {kiwi} = new Common::ktLog();
+
+	return $this;
+}
+
+#==========================================
+# test_ctor
+#------------------------------------------
+sub test_ctor {
+	# ...
+	# Test the runtime checker constructor
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	# Test missing second argument
+	my $checker = new KIWIRuntimeChecker($kiwi);
+	my $msg = $kiwi -&gt; getMessage();
+	my $expected = 'Expecting reference to KIWICommandLine object as second '
+		. 'argument.';
+	$this -&gt; assert_str_equals($expected, $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('error', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('failed', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_null($checker);
+	# Test missing third argument
+	my $cmd = $this -&gt; __getCommandLineObj();
+	$checker = new KIWIRuntimeChecker($kiwi, $cmd);
+	$msg = $kiwi -&gt; getMessage();
+	$expected = 'Expecting reference to KIWIXML object as third argument.';
+	$this -&gt; assert_str_equals($expected, $msg);
+	$msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('error', $msgT);
+	$state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('failed', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_null($checker);
+	# No error construction
+	my $xml = $this -&gt; __getXMLObj( $this -&gt; {dataDir} );
+	$checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	$msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	$msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	$state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_not_null($checker);
+}
+
+#==========================================
+# test_buildProfWithDefPackages
+#------------------------------------------
+sub test_buildProfWithDefPackages {
+	# ...
+	# Test that using specified build profiles with configuration that has
+	# default packages does not trigger an error
+	# in the runtime checker.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my @profiles = ('my-first','my-second');
+	my $cmd = $this -&gt; __getCommandLineObj();
+	$cmd -&gt; setBuildProfiles(\@profiles);
+	my $xml = $this -&gt; __getXMLObj( $this -&gt; {dataDir} . '/haveDefaultPkgs' );
+	my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	my $res = $checker -&gt; prepareChecks();
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_not_null($res);
+}
+
+#==========================================
+# test_conflictingProfiles
+#------------------------------------------
+sub test_conflictingProfiles {
+	# ...
+	# Test that conflicting values of the patternType attribute
+	# are properly detected at runtime.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my @profiles = ('my-first','my-second');
+	my $cmd = $this -&gt; __getCommandLineObj();
+	$cmd -&gt; setBuildProfiles(\@profiles);
+	my $xml = $this -&gt; __getXMLObj( $this -&gt; {dataDir} );
+	my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	my $res = $checker -&gt; prepareChecks();
+	my $msg = $kiwi -&gt; getMessage();
+	my $expected = 'Conflicting patternType attribute values for specified '
+	. 'profiles &quot;my-first my-second&quot; found';
+	$this -&gt; assert_str_equals($expected, $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('error', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('failed', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_null($res);
+}
+
+#==========================================
+# test_fsToolCheckFsysImg
+#------------------------------------------
+sub test_fsToolCheckFsysImg {
+	# ...
+	# Test the verification of the *fs tool presence verification.
+	# Do not know how to hide the tool from within the test, thus certain
+	# conditions of the test are only exercised on systems where the
+	# tool is not present.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCommandLineObj();
+	my $dataBaseDir = $this -&gt; {dataDir} . '/fileSysImg/';
+	my @fsTestDirs = glob &quot;$dataBaseDir/*&quot;;
+	for my $fsTestName (@fsTestDirs) {
+		my $xml = $this -&gt; __getXMLObj($fsTestName);
+		my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+		my $res = $checker -&gt; createChecks();
+		my $eMsg = $kiwi -&gt; getErrorMessage();
+		if ($eMsg) {
+			# File system tool is not present
+			my $fsTool;
+			if ($fsTestName =~ 'btrfs' ) {
+				$fsTool = 'mkfs.btrfs'
+			} elsif ($fsTestName =~ 'ext2' ) {
+				$fsTool = 'mkfs.ext2';
+			} elsif ($fsTestName =~ 'ext3' ) {
+				$fsTool = 'mkfs.ext3';
+			} elsif ($fsTestName =~ 'ext4' ) {
+				$fsTool = 'mkfs.ext4';
+			} elsif ($fsTestName =~ 'reiserfs' ) {
+				$fsTool = 'mkreiserfs';
+			} elsif ($fsTestName =~ 'xfs' ) {
+				$fsTool = 'mkfs.xfs';
+			}
+			my $logMsg = $kiwi -&gt; getLogInfoMessage();
+			my $expected = &quot;warning: $fsTool not found\n&quot;;
+			$this -&gt; assert_str_equals($expected, $logMsg);
+			my @prts = split /\//, $fsTestName;
+			my $fsExpected = $prts[-1];
+			$expected = 'Requested image creation with filesystem &quot;'
+			. $fsExpected
+			. '&quot;; but tool to create the file system could not '
+			. 'be found.';
+			$this -&gt; assert_str_equals($expected, $eMsg);
+			my $msgT = $kiwi -&gt; getMessageType();
+			$this -&gt; assert_str_equals('error', $msgT);
+			my $state = $kiwi -&gt; getState();
+			$this -&gt; assert_str_equals('failed', $state);
+			# Test this condition last to get potential error messages
+			$this -&gt; assert_null($res);
+		} else {
+			# Filesystem tools is present
+			my $msg = $kiwi -&gt; getMessage();
+			$this -&gt; assert_str_equals('No messages set', $msg);
+			my $msgT = $kiwi -&gt; getMessageType();
+			$this -&gt; assert_str_equals('none', $msgT);
+			my $state = $kiwi -&gt; getState();
+			$this -&gt; assert_str_equals('No state set', $state);
+			# Test this condition last to get potential error messages
+			$this -&gt; assert_not_null($res);
+		}
+	}
+}
+
+#==========================================
+# test_fsToolCheckIsoImg
+#------------------------------------------
+sub test_fsToolCheckIsoImg {
+	# ...
+	# Test the verification of the *fs tool presence verification.
+	# Do not know how to hide the tool from within the test, thus certain
+	# conditions of the test are only exercised on systems where the
+	# tool is not present.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCommandLineObj();
+	my $dataBaseDir = $this -&gt; {dataDir} . '/liveIsoImg';
+	my @fsTestDirs = glob &quot;$dataBaseDir/*&quot;;
+	for my $fsTestName (@fsTestDirs) {
+		my $xml = $this -&gt; __getXMLObj($fsTestName);
+		my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+		my $res = $checker -&gt; createChecks();
+		my $eMsg = $kiwi -&gt; getErrorMessage();
+		if ($eMsg) {
+			# File system tool is not present
+			my $fsTool;
+			my $fsExpected;
+			if ($fsTestName =~ 'clic') {
+				$fsExpected = 'clicfs';
+				$fsTool = 'mkclicfs';
+			} elsif ($fsTestName =~ 'compressed' || $fsTestName =~ 'unified') {
+				$fsExpected = 'squashfs';
+				$fsTool = 'mksquashfs';
+			}
+			my $logMsg = $kiwi -&gt; getLogInfoMessage();
+			my $expected = &quot;warning: $fsTool not found\n&quot;;
+			$this -&gt; assert_str_equals($expected, $logMsg);
+			$expected = 'Requested image creation with filesystem &quot;'
+			. $fsExpected
+			. '&quot;; but tool to create the file system could not '
+			. 'be found.';
+			$this -&gt; assert_str_equals($expected, $eMsg);
+			my $msgT = $kiwi -&gt; getMessageType();
+			$this -&gt; assert_str_equals('error', $msgT);
+			my $state = $kiwi -&gt; getState();
+			$this -&gt; assert_str_equals('failed', $state);
+			# Test this condition last to get potential error messages
+			$this -&gt; assert_null($res);
+		} else {
+			# Filesystem tools is present
+			my $msg = $kiwi -&gt; getMessage();
+			$this -&gt; assert_str_equals('No messages set', $msg);
+			my $msgT = $kiwi -&gt; getMessageType();
+			$this -&gt; assert_str_equals('none', $msgT);
+			my $state = $kiwi -&gt; getState();
+			$this -&gt; assert_str_equals('No state set', $state);
+			# Test this condition last to get potential error messages
+			$this -&gt; assert_not_null($res);
+		}
+	}
+}
+
+#==========================================
+# test_fsToolCheckOemBtrfs
+#------------------------------------------
+sub test_fsToolCheckOemBtrfs {
+	# ...
+	# Test the verification of the *fs tool presence verification.
+	# Do not know how to hide the tool from within the test, thus certain
+	# conditions of the test are only exercised on systems where the
+	# tool is not present.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCommandLineObj();
+	my $configPath = $this -&gt; {dataDir} . '/oemBtrfs';
+	my $xml = $this -&gt; __getXMLObj($configPath);
+	my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	my $res = $checker -&gt; createChecks();
+	my $eMsg = $kiwi -&gt; getErrorMessage();
+	if ($eMsg) {
+		# File system tool is not present
+		my $logMsg = $kiwi -&gt; getLogInfoMessage();
+		my $expected = &quot;warning: mkfs.btrfs not found\n&quot;;
+		$this -&gt; assert_str_equals($expected, $logMsg);
+		$expected = 'Requested image creation with filesystem &quot;btrfs&quot;; '
+		. 'but tool to create the file system could not '
+		. 'be found.';
+		$this -&gt; assert_str_equals($expected, $eMsg);
+		my $msgT = $kiwi -&gt; getMessageType();
+		$this -&gt; assert_str_equals('error', $msgT);
+		my $state = $kiwi -&gt; getState();
+		$this -&gt; assert_str_equals('failed', $state);
+		# Test this condition last to get potential error messages
+		$this -&gt; assert_null($res);
+	} else {
+		# Filesystem tools is present
+		my $msg = $kiwi -&gt; getMessage();
+		$this -&gt; assert_str_equals('No messages set', $msg);
+		my $msgT = $kiwi -&gt; getMessageType();
+		$this -&gt; assert_str_equals('none', $msgT);
+		my $state = $kiwi -&gt; getState();
+		$this -&gt; assert_str_equals('No state set', $state);
+		# Test this condition last to get potential error messages
+		$this -&gt; assert_not_null($res);
+	}
+}
+
+#==========================================
+# test_fsToolCheckSplitImg
+#------------------------------------------
+sub test_fsToolCheckSplitImg {
+	# ...
+	# Test the verification of the *fs tool presence verification.
+	# Do not know how to hide the tool from within the test, thus certain
+	# conditions of the test are only exercised on systems where the
+	# tool is not present.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCommandLineObj();
+	my $configPath = $this -&gt; {dataDir} . '/splitImg';
+	my $xml = $this -&gt; __getXMLObj($configPath);
+	my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	my $res = $checker -&gt; createChecks();
+	my $eMsg = $kiwi -&gt; getErrorMessage();
+	if ($eMsg) {
+		# File system tool is not present
+		my $logMsg = $kiwi -&gt; getLogInfoMessage();
+		my $expected = &quot;warning: mkfs.btrfs not found\n&quot;;
+		$this -&gt; assert_str_equals($expected, $logMsg);
+		$expected = 'Requested image creation with filesystem &quot;btrfs&quot;; '
+		. 'but tool to create the file system could not '
+		. 'be found.';
+		$this -&gt; assert_str_equals($expected, $eMsg);
+		my $msgT = $kiwi -&gt; getMessageType();
+		$this -&gt; assert_str_equals('error', $msgT);
+		my $state = $kiwi -&gt; getState();
+		$this -&gt; assert_str_equals('failed', $state);
+		# Test this condition last to get potential error messages
+		$this -&gt; assert_null($res);
+	} else {
+		# Filesystem tools is present
+		my $msg = $kiwi -&gt; getMessage();
+		$this -&gt; assert_str_equals('No messages set', $msg);
+		my $msgT = $kiwi -&gt; getMessageType();
+		$this -&gt; assert_str_equals('none', $msgT);
+		my $state = $kiwi -&gt; getState();
+		$this -&gt; assert_str_equals('No state set', $state);
+		# Test this condition last to get potential error messages
+		$this -&gt; assert_not_null($res);
+	}
+}
+
+#==========================================
+# test_noBuildProfile
+#------------------------------------------
+sub test_noBuildProfile {
+	# ...
+	# Test that using no build profile does not trigger an error
+	# in the runtime checker.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCommandLineObj();
+	my $xml = $this -&gt; __getXMLObj( $this -&gt; {dataDir} );
+	my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	my $res = $checker -&gt; prepareChecks();
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_not_null($res);
+}
+
+#==========================================
+# test_noBuildType
+#------------------------------------------
+sub test_noBuildType {
+	# ...
+	# Test that an error is triggered if Kiwi cannot determine the build type
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my $cmd = $this -&gt; __getCommandLineObj();
+	my $configDir = $this -&gt; {dataDir} . '/noDefaultBuildType';
+	# TODO
+	# Change to a RuntimeChecker test when XML object becomes a dumb
+	# container and looses notion of state
+	#my $xml = $this -&gt; __getXMLObj($configDir);
+	#my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	#my $res = $checker -&gt; prepareChecks();
+	my $xml = new KIWIXML($kiwi, $configDir, undef, undef);
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('Cannot determine build type', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('error', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('failed', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_null($xml);
+}
+
+#==========================================
+# test_useSingleBuildProfile
+#------------------------------------------
+sub test_useSingleBuildProfile {
+	# ...
+	# Test that using a single build profile does not trigger an error
+	# in the runtime checker.
+	# ---
+	my $this = shift;
+	my $kiwi = $this -&gt; {kiwi};
+	my @profiles = ('my-first');
+	my $cmd = $this -&gt; __getCommandLineObj();
+	$cmd -&gt; setBuildProfiles(\@profiles);
+	my $xml = $this -&gt; __getXMLObj( $this -&gt; {dataDir} );
+	my $checker = new KIWIRuntimeChecker($kiwi, $cmd, $xml);
+	my $res = $checker -&gt; prepareChecks();
+	my $msg = $kiwi -&gt; getMessage();
+	$this -&gt; assert_str_equals('No messages set', $msg);
+	my $msgT = $kiwi -&gt; getMessageType();
+	$this -&gt; assert_str_equals('none', $msgT);
+	my $state = $kiwi -&gt; getState();
+	$this -&gt; assert_str_equals('No state set', $state);
+	# Test this condition last to get potential error messages
+	$this -&gt; assert_not_null($res);
+}
+
+#==========================================
+# Private helper methods
+#------------------------------------------
+#==========================================
+# __getCommandLineObj
+#------------------------------------------
+sub __getCommandLineObj {
+	# ...
+	# Create a command line object
+	# ---
+	my $this = shift;
+	return new KIWICommandLine( $this -&gt; {kiwi} );
+}
+
+#==========================================
+# __getXMLObj
+#------------------------------------------
+sub __getXMLObj {
+	# ...
+	# Create an XML object with the given config dir
+	# ---
+	my $this      = shift;
+	my $configDir = shift;
+	# TODO
+	# Fix the creation of the XML object once the ctor arguments change
+	my $xml = new KIWIXML( $this -&gt; {kiwi}, $configDir, undef, undef);
+	if (! $xml) {
+		my $msg = 'Failed to create XML obj, most likely improper config '
+		. 'path: '
+		. $configDir;
+		$this -&gt; assert_equals(1, $msg);
+	}
+	return $xml;
+}
+1;
diff --git a/tests/unit/lib/Test/xmlValidator.pm b/tests/unit/lib/Test/xmlValidator.pm
index 26d10a3..3814f6c 100644
--- a/tests/unit/lib/Test/xmlValidator.pm
+++ b/tests/unit/lib/Test/xmlValidator.pm
@@ -482,7 +482,12 @@ sub test_profileName {
 		$validator -&gt; validate();
 		my $kiwi = $this -&gt; {kiwi};
 		my $msg = $kiwi -&gt; getMessage();
-		my $expectedMsg = 'Name of a profile may not contain whitespace.';
+		my $expectedMsg ;
+		if ($iConfFile =~ /profileNameInvalid_2.xml/) {
+			$expectedMsg = 'Name of a profile may not be set to &quot;all&quot;.';
+		} else {
+			$expectedMsg = 'Name of a profile may not contain whitespace.';
+		}
 		$this -&gt; assert_str_equals($expectedMsg, $msg);
 		my $msgT = $kiwi -&gt; getMessageType();
 		$this -&gt; assert_str_equals('error', $msgT);
diff --git a/xsl/convert47to48.xsl b/xsl/convert47to48.xsl
index 6ee70f3..3662022 100644
--- a/xsl/convert47to48.xsl
+++ b/xsl/convert47to48.xsl
@@ -16,7 +16,7 @@
 	&lt;xsl:choose&gt;
 		&lt;xsl:when test=&quot;$content = 'true'&quot;&gt;
 			&lt;systemdisk name=&quot;kiwiVG&quot;&gt;
-			&lt;volume name=&quot;/home&quot; freespace=&quot;200M&quot;/&gt;
+				&lt;volume name=&quot;/home&quot; freespace=&quot;200M&quot;/&gt;
 			&lt;/systemdisk&gt;
 		&lt;/xsl:when&gt;
 		&lt;xsl:otherwise&gt;
@@ -59,13 +59,11 @@
 		&lt;xsl:copy-of select=&quot;@*[not(local-name(.) = 'lvm')]&quot;/&gt;
 		&lt;xsl:choose&gt;
 			&lt;xsl:when test=&quot;lvmvolumes&quot;&gt;
+				&lt;xsl:variable name=&quot;content&quot;
+					select=&quot;translate(normalize-space(oemconfig/oem-home), 
+							&uppercase;, &lowercase;)&quot;
+				/&gt;
 				&lt;xsl:choose&gt;
-					&lt;xsl:when test=&quot;oemconfig/oem-home&quot;&gt;
-					&lt;xsl:variable name=&quot;content&quot;
-						select=&quot;translate(normalize-space(oemconfig/oem-home), 
-								&uppercase;, &lowercase;)&quot;
-					/&gt;
-					&lt;xsl:choose&gt;
 					&lt;xsl:when test=&quot;$content = 'true'&quot;&gt;
 						&lt;xsl:apply-templates
 							select=&quot;*[not(self::lvmvolumes)]&quot; mode=&quot;conv47to48&quot;
@@ -74,8 +72,9 @@
 							mode=&quot;mode-volumes&quot;
 						/&gt;
 					&lt;/xsl:when&gt;
-					&lt;/xsl:choose&gt;
-					&lt;/xsl:when&gt;
+					&lt;xsl:otherwise&gt;
+						&lt;xsl:apply-templates mode=&quot;conv47to48&quot;/&gt;
+					&lt;/xsl:otherwise&gt;
 				&lt;/xsl:choose&gt;
 			&lt;/xsl:when&gt;
 			&lt;xsl:otherwise&gt;


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003158.html">[Kiwi-devel] new stuff - restructuring related
</A></li>
	<LI>Next message: <A HREF="003154.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-480-SuSE-11.4-Devel,	updated. a22464de7ec1df6b9d31e6878d8751d7b7fd464b
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3164">[ date ]</a>
              <a href="thread.html#3164">[ thread ]</a>
              <a href="subject.html#3164">[ subject ]</a>
              <a href="author.html#3164">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
