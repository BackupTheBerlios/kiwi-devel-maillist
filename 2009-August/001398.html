<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3e48ca8d7b3f4e0449df1b60261b976cc96921c3
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%203e48ca8d7b3f4e0449df1b60261b976cc96921c3&In-Reply-To=%3C200908101527.n7AFRlUO001212%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001397.html">
   <LINK REL="Next"  HREF="001399.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3e48ca8d7b3f4e0449df1b60261b976cc96921c3</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%203e48ca8d7b3f4e0449df1b60261b976cc96921c3&In-Reply-To=%3C200908101527.n7AFRlUO001212%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3e48ca8d7b3f4e0449df1b60261b976cc96921c3">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Mon Aug 10 17:27:47 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001397.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. c6ddd9ae6e01ff4150445df8849743e851284c7a
</A></li>
        <LI>Next message: <A HREF="001399.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. ae66a0c815c50a593da64d70bda44dd7caebbf84
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1398">[ date ]</a>
              <a href="thread.html#1398">[ thread ]</a>
              <a href="subject.html#1398">[ subject ]</a>
              <a href="author.html#1398">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  3e48ca8d7b3f4e0449df1b60261b976cc96921c3 (commit)
      from  c6ddd9ae6e01ff4150445df8849743e851284c7a (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 3e48ca8d7b3f4e0449df1b60261b976cc96921c3
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Mon Aug 10 17:27:32 2009 +0200

    - added ddn function and replace all occurrences of
      a=$disk&quot;number&quot; with a=$(ddn $disk number) (bnc #529580)

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/kiwi-man/KIWI::config.sh.1 b/doc/kiwi-man/KIWI::config.sh.1
index 49c0a69..a82bb36 100644
--- a/doc/kiwi-man/KIWI::config.sh.1
+++ b/doc/kiwi-man/KIWI::config.sh.1
@@ -1,11 +1,11 @@
 .\&quot;     Title: kiwi::config.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 08/07/2009
+.\&quot;      Date: Created: 08/10/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;
-.TH &quot;KIWI::CONFIG\.SH&quot; &quot;1&quot; &quot;Created: 08/07/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::CONFIG\.SH&quot; &quot;1&quot; &quot;Created: 08/10/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
diff --git a/doc/kiwi-man/KIWI::images.sh.1 b/doc/kiwi-man/KIWI::images.sh.1
index bc5e901..2ea9d67 100644
--- a/doc/kiwi-man/KIWI::images.sh.1
+++ b/doc/kiwi-man/KIWI::images.sh.1
@@ -1,11 +1,11 @@
 .\&quot;     Title: kiwi::images.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 08/07/2009
+.\&quot;      Date: Created: 08/10/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;
-.TH &quot;KIWI::IMAGES\.SH&quot; &quot;1&quot; &quot;Created: 08/07/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::IMAGES\.SH&quot; &quot;1&quot; &quot;Created: 08/10/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
diff --git a/doc/kiwi-man/kiwi.1 b/doc/kiwi-man/kiwi.1
index 84f4c71..9491bdf 100644
--- a/doc/kiwi-man/kiwi.1
+++ b/doc/kiwi-man/kiwi.1
@@ -1,11 +1,11 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Schaefer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 08/07/2009
+.\&quot;      Date: Created: 08/10/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 08/07/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 08/10/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
diff --git a/doc/kiwi.pdf b/doc/kiwi.pdf
index 0db1f06..f232aa9 100644
Binary files a/doc/kiwi.pdf and b/doc/kiwi.pdf differ
diff --git a/modules/KIWILinuxRC.sh b/modules/KIWILinuxRC.sh
index 8462acc..57b500d 100644
--- a/modules/KIWILinuxRC.sh
+++ b/modules/KIWILinuxRC.sh
@@ -1913,8 +1913,9 @@ function USBStickDevice {
 			removable=`cat $isremovable`
 			if [ $removable -eq 1 ];then
 				stickRoot=$device
-				stickDevice=$device&quot;1&quot;
-				for dev in $stickRoot&quot;1&quot; $stickRoot&quot;2&quot;;do
+				stickDevice=$(ddn $device 1)
+				for devnr in 1 2;do
+					dev=$(ddn $stickRoot $devnr)
 					if ! kiwiMount &quot;$dev&quot; &quot;/mnt&quot;;then
 						continue
 					fi
@@ -2033,7 +2034,7 @@ function CDMount {
 		# search for hybrid device
 		#--------------------------------------
 		Echo -n &quot;Mounting hybrid live boot drive...&quot;
-		cddev=$biosBootDevice&quot;1&quot;
+		cddev=$(ddn $biosBootDevice 1)
 		kiwiMount $cddev /cdrom
 		if [ -f $LIVECD_CONFIG ];then
 			echo
@@ -2128,8 +2129,12 @@ function searchBIOSBootDevice {
 	#--------------------------------------
 	mkdir -p $cmpd
 	for curd in $ddevs;do
+		if [ ! $(echo $curd | cut -c 1) = &quot;/&quot; ];then
+			continue
+		fi
 		for id in 1 2 3;do
-			if ! mount $curd$id /mnt;then
+			dev=$(ddn $curd $id)
+			if ! mount $dev /mnt;then
 				continue
 			fi
 			if [ -f /mnt/boot/grub/mbrid ];then
@@ -4452,6 +4457,25 @@ function displayEULA {
 		esac
 	done
 }
+
+#======================================
+# ddn
+#--------------------------------------
+function ddn {
+	# /.../
+	# print disk device name (node name) according to the
+	# linux device node specs: If the last character of the
+	# device is a letter, attach the partition number. If the
+	# last character is a number, attach a 'p' and then the
+	# partition number.
+	# ----
+	local lastc=$(echo $1 | sed -e 's@\(^.*\)\(.$\)@\2@')
+	if echo $last | grep -P &quot;^\d+$&quot;;then
+		echo $1&quot;p&quot;$2
+		return
+	fi
+	echo $1$2
+}
 #======================================
 # SAPMemCheck
 #--------------------------------------
@@ -4646,8 +4670,9 @@ function SAPDataStorageSetup {
 	#======================================
 	# Add volume group and filesystem
 	#--------------------------------------
-	pvcreate -ff -y $storage&quot;1&quot;
-	vgcreate data_vg $storage&quot;1&quot;
+	local diskpart=$(ddn $storage 1)
+	pvcreate -ff -y $diskpart
+	vgcreate data_vg $diskpart
 	lvcreate -l 100%FREE -n sapdata data_vg
 	mke2fs -T ext3 -j /dev/data_vg/sapdata
 	if test $? != 0; then
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index 3157cb0..be80258 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -2,6 +2,8 @@
 Fri Aug  7 14:56:27 CEST 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 
 - v3.71
+- added ddn function and replace all occurrences of
+  a=$disk&quot;number&quot; with a=$(ddn $disk number) (bnc #529580)
 - added --select packages for the --info option
 - added checkmedia KIWIIsoLinux constructor parameter
 
diff --git a/system/boot/ix86/netboot/suse-linuxrc b/system/boot/ix86/netboot/suse-linuxrc
index 087c838..de42d0c 100755
--- a/system/boot/ix86/netboot/suse-linuxrc
+++ b/system/boot/ix86/netboot/suse-linuxrc
@@ -557,15 +557,15 @@ else
 	#--------------------------------------
 	if [ $LOCAL_BOOT = &quot;yes&quot; ];then
 		imageDisk=`getDiskDevice $root | sed -e s&quot;@[0-9]@@g&quot;`
-		imageDevice=$imageDisk&quot;2&quot;
+		imageDevice=$(ddn $imageDisk 2)
 		imageRootDevice=$imageDevice
 		imageRootName=&quot;Local-System&quot;
 		if [ ! -z &quot;$UNIONFS_CONFIG&quot; ];then
 			unionFST=`echo $UNIONFS_CONFIG | cut -d , -f 3`
-			setupUnionFS $imageDisk&quot;3&quot; $imageDisk&quot;2&quot; $unionFST
+			setupUnionFS $(ddn $imageDisk 3) $(ddn $imageDisk 2) $unionFST
 		fi
 		if [ ! -z &quot;$COMBINED_IMAGE&quot; ];then
-			imageNextRootDevice=$imageDisk&quot;3&quot;
+			imageNextRootDevice=$(ddn $imageDisk 3)
 		fi
 	fi
 	#======================================
diff --git a/system/boot/ix86/oemboot/suse-dump b/system/boot/ix86/oemboot/suse-dump
index 1819bdb..d8c23cf 100755
--- a/system/boot/ix86/oemboot/suse-dump
+++ b/system/boot/ix86/oemboot/suse-dump
@@ -49,7 +49,7 @@ function OEMInstall {
 		export OEMInstallType=CD
 	else
 		Echo &quot;Found Stick: $stickRoot -&gt; $stickSerial&quot;
-		mkdir -p /cdrom &amp;&amp; mount $stickRoot&quot;2&quot; /cdrom
+		mkdir -p /cdrom &amp;&amp; mount $(ddn $stickRoot 2) /cdrom
 		export OEMInstallType=USB
 	fi
 	#======================================
@@ -264,7 +264,7 @@ function OEMInstall {
 	# Reread partition table
 	#--------------------------------------
 	blockdev --rereadpt $imageDevice
-	deviceTest=$imageDevice&quot;1&quot;
+	deviceTest=$(ddn $imageDevice 1)
 	if ! waitForStorageDevice $deviceTest;then
 		systemException \
 			&quot;Partition $deviceTest doesn't appear... fatal !&quot; \
diff --git a/system/boot/ix86/oemboot/suse-linuxrc b/system/boot/ix86/oemboot/suse-linuxrc
index 0c2567f..a622cb1 100755
--- a/system/boot/ix86/oemboot/suse-linuxrc
+++ b/system/boot/ix86/oemboot/suse-linuxrc
@@ -67,8 +67,8 @@ function setupDeviceNames {
 	#======================================
 	# Set default filesystem device names
 	#--------------------------------------
-	export imageRWDevice=$imageDiskDevice&quot;2&quot;
-	export imageRODevice=$imageDiskDevice&quot;1&quot;
+	export imageRWDevice=$(ddn $imageDiskDevice 2)
+	export imageRODevice=$(ddn $imageDiskDevice 1)
 	export imageIOWRDevice=$imageRWDevice
 	#======================================
 	# Check for LVM or standard boot
@@ -86,7 +86,7 @@ function setupDeviceNames {
 		export imageRWDevice=/dev/kiwiVG/LVRoot
 		export imageRODevice=/dev/kiwiVG/LVComp
 		export imageIOWRDevice=$imageRWDevice
-		export imageBootDevice=$imageDiskDevice&quot;2&quot;
+		export imageBootDevice=$(ddn $imageDiskDevice 2)
 		if [ ! -z &quot;$KIWI_RECOVERY&quot; ];then
 			export imageRecoveryDevice=/dev/kiwiVG/LVRecovery
 		fi
@@ -96,8 +96,8 @@ function setupDeviceNames {
 		# Standard setup
 		#--------------------------------------
 		if [ ! -z &quot;$KIWI_RECOVERY&quot; ];then
-			export imageRecoveryDevice=$imageDiskDevice&quot;4&quot;
-			export imageRootDevice=$imageDiskDevice&quot;2&quot;
+			export imageRecoveryDevice=$(ddn $imageDiskDevice 4)
+			export imageRootDevice=$(ddn $imageDiskDevice 2)
 		else
 			for i in 1 2;do
 				export imageRootDevice=$imageDiskDevice$i
@@ -426,7 +426,7 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ]; then
 		#--------------------------------------
 		mkdir /mnt/dmboot
 		bootid=2
-		export imageBootDevice=$imageDiskDevice&quot;3&quot;
+		export imageBootDevice=$(ddn $imageDiskDevice 3)
 		mount $imageBootDevice /mnt/dmboot
 		cp -a  /mnt/boot /mnt/dmboot
 		test -f /tmp/linux.vmx  &amp;&amp; mv /tmp/linux.vmx  /mnt/dmboot/boot
@@ -439,10 +439,10 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ]; then
 		# LUKS use second or third part as boot
 		#--------------------------------------
 		mkdir -p /mnt/luksboot
-		imageBootDevice=$imageDiskDevice&quot;2&quot;
+		imageBootDevice=$(ddn $imageDiskDevice 2)
 		bootid=1
 		if isFSTypeReadOnly;then
-			export imageBootDevice=$imageDiskDevice&quot;3&quot;
+			export imageBootDevice=$(ddn $imageDiskDevice 3)
 			bootid=2
 		fi
 		mount $imageBootDevice /mnt/luksboot
diff --git a/system/boot/ix86/oemboot/suse-repart b/system/boot/ix86/oemboot/suse-repart
index 5e7ae63..6326ddc 100755
--- a/system/boot/ix86/oemboot/suse-repart
+++ b/system/boot/ix86/oemboot/suse-repart
@@ -85,7 +85,7 @@ function OEMRepartStandard {
 	input=/part.input
 	rm -f $input
 	diskXMBytes=`partitionSize $imageDiskDevice`
-	diskPMBytes=`partitionSize $imageDiskDevice&quot;1&quot;`
+	diskPMBytes=`partitionSize $(ddn $imageDiskDevice 1)`
 	diskPMBytes=`expr $diskPMBytes / 1024`
 	diskXMBytes=`expr $diskXMBytes / 1024`
 	disk1MBytes=10240
@@ -260,13 +260,13 @@ function OEMRepartStandard {
 	# Update new device names
 	#--------------------------------------
 	if [ -z &quot;$DONT_PARTITION&quot; ];then
-		export imageRootDevice=$(luksOpen $imageDiskDevice&quot;2&quot;)
-		export imageSwapDevice=$imageDiskDevice&quot;1&quot;
+		export imageRootDevice=$(luksOpen $(ddn $imageDiskDevice 2))
+		export imageSwapDevice=$(ddn $imageDiskDevice 1)
 		if [ -z &quot;$OEM_WITHOUTHOME&quot; ];then
-			export imageHomeDevice=$imageDiskDevice&quot;3&quot;
+			export imageHomeDevice=$(ddn $imageDiskDevice 3)
 		fi
 		if [ ! -z &quot;$OEM_RECOVERY&quot; ];then
-			export imageRecoveryDevice=$imageDiskDevice&quot;4&quot;
+			export imageRecoveryDevice=$(ddn $imageDiskDevice 4)
 		fi
 		bootid=1
 		activateBootPartition
@@ -291,10 +291,10 @@ function OEMRepartOverlayed {
 	#====================================== 
 	# check for DM squash setup
 	#--------------------------------------
-	if mount $imageDiskDevice&quot;1&quot; /mnt &amp;&gt;/dev/null;then
+	if mount $(ddn $imageDiskDevice 1) /mnt &amp;&gt;/dev/null;then
 		if [ -f /mnt/fsdata.ext3 ];then
 			umount /mnt
-			mount $imageDiskDevice&quot;3&quot; /mnt
+			mount $(ddn $imageDiskDevice 3) /mnt
 			cp /mnt/boot/linux.vmx  /tmp
 			cp /mnt/boot/initrd.vmx /tmp
 			cp /mnt/boot/grub/mbrid /tmp
@@ -314,7 +314,7 @@ function OEMRepartOverlayed {
 	fi
 	diskXMBytes=`partitionSize $imageDiskDevice`
 	diskXMBytes=`expr $diskXMBytes / 1024`
-	disk1MBytes=`partitionSize $imageDiskDevice&quot;1&quot;`
+	disk1MBytes=`partitionSize $(ddn $imageDiskDevice 1)`
 	disk1MBytes=`expr $disk1MBytes / 1024`
 	disk2MBytes=`expr $diskXMBytes - $disk1MBytes - $swapsize - $bootXMBytes`
 	if [ $disk2MBytes -lt 100 ];then
@@ -381,15 +381,15 @@ function OEMRepartOverlayed {
 	# Update new device names
 	#--------------------------------------
 	if [ -z &quot;$DONT_PARTITION&quot; ];then
-		export imageRootDevice=$(luksOpen $imageDiskDevice&quot;1&quot;)
-		export imageIOWRDevice=$(luksOpen $imageDiskDevice&quot;2&quot; luksReadWrite)
+		export imageRootDevice=$(luksOpen $(ddn $imageDiskDevice 1))
+		export imageIOWRDevice=$(luksOpen $(ddn $imageDiskDevice 2) luksReadWrite)
 		export imageRWDevice=$imageIOWRDevice
 		export imageRODevice=$imageRootDevice
 		if [ ! $swapsize = 0 ];then
 			if [ &quot;$haveDMSquash&quot; = &quot;yes&quot; ];then
-				export imageSwapDevice=$imageDiskDevice&quot;4&quot;
+				export imageSwapDevice=$(ddn $imageDiskDevice 4)
 			else
-				export imageSwapDevice=$imageDiskDevice&quot;3&quot;
+				export imageSwapDevice=$(ddn $imageDiskDevice 3)
 			fi
 		fi
 		if [ &quot;$haveDMSquash&quot; = &quot;yes&quot; ];then
@@ -402,7 +402,7 @@ function OEMRepartOverlayed {
 		# Create bootfs if DM squash setup
 		#--------------------------------------
 		if [ &quot;$haveDMSquash&quot; = &quot;yes&quot; ];then
-			export imageBootDevice=$imageDiskDevice&quot;3&quot;
+			export imageBootDevice=$(ddn $imageDiskDevice 3)
 			if ! mke2fs -T ext2 -q $imageBootDevice &gt;/dev/null 2&gt;&amp;1;then
 				systemException &quot;Failed to create Boot filesystem&quot; &quot;reboot&quot;
 			fi
@@ -428,7 +428,7 @@ function OEMRepartCombined {
 	#====================================== 
 	# check for read-write partition
 	#--------------------------------------
-	if ! partitionSize $imageDiskDevice&quot;2&quot; &amp;&gt;/dev/null;then
+	if ! partitionSize $(ddn $imageDiskDevice 2) &amp;&gt;/dev/null;then
 		Echo &quot;No read-write partition in this split image&quot;
 		DONT_PARTITION=1
 	fi
@@ -439,9 +439,9 @@ function OEMRepartCombined {
 		swapXMBytes=$swapsize
 		diskXMBytes=`partitionSize $imageDiskDevice`
 		diskXMBytes=`expr $diskXMBytes / 1024`
-		disk1MBytes=`partitionSize $imageDiskDevice&quot;1&quot;`
+		disk1MBytes=`partitionSize $(ddn $imageDiskDevice 1)`
 		disk1MBytes=`expr $disk1MBytes / 1024`
-		disk2MBytes=`partitionSize $imageDiskDevice&quot;2&quot;`
+		disk2MBytes=`partitionSize $(ddn $imageDiskDevice 2)`
 		disk2MBytes=`expr $disk2MBytes / 1024`
 		diskXLBytes=`expr $diskXMBytes - $disk1MBytes - $disk2MBytes`
 		diskXABytes=`expr $diskXLBytes - $swapXMBytes`
@@ -499,9 +499,9 @@ function OEMRepartCombined {
 	# Update new device names
 	#--------------------------------------
 	if [ -z &quot;$DONT_PARTITION&quot; ];then
-		export imageRootDevice=$(luksOpen $imageDiskDevice&quot;1&quot;)
-		export imageSwapDevice=$imageDiskDevice&quot;3&quot;
-		export imageIOWRDevice=$(luksOpen $imageDiskDevice&quot;2&quot; luksReadWrite)
+		export imageRootDevice=$(luksOpen $(ddn $imageDiskDevice 1))
+		export imageSwapDevice=$(ddn $imageDiskDevice 3)
+		export imageIOWRDevice=$(luksOpen $(ddn $imageDiskDevice 2) luksReadWrite)
 		export imageRWDevice=$imageIOWRDevice
 		export imageRODevice=$imageRootDevice
 		bootid=1
@@ -551,8 +551,8 @@ function OEMRepartLVM {
 	bootid=1
 	activateBootPartition
 	vgchange -a y kiwiVG
-	pvcreate $imageDiskDevice&quot;3&quot;
-	vgextend kiwiVG $imageDiskDevice&quot;3&quot;
+	pvcreate $(ddn $imageDiskDevice 3)
+	vgextend kiwiVG $(ddn $imageDiskDevice 3)
 	VGFreeMBytes=`vgdisplay --short --unit B kiwiVG | cut -f2 -d/ | cut -f1 -dB`
 	VGFreeMBytes=`expr $VGFreeMBytes / 1000`
 	VGFreeMBytes=`expr $VGFreeMBytes / 1000`
@@ -618,7 +618,7 @@ function OEMRepartLuks {
 	# Store kiwi kernel and initrd
 	#--------------------------------------
 	if isFSTypeReadOnly;then
-		mount $imageDiskDevice&quot;3&quot; /mnt
+		mount $(ddn $imageDiskDevice 3) /mnt
 		cp /mnt/boot/linux.vmx  /tmp
 		cp /mnt/boot/initrd.vmx /tmp
 		cp /mnt/boot/grub/mbrid /tmp
@@ -634,7 +634,7 @@ function OEMRepartLuks {
 	fi
 	diskXMBytes=`partitionSize $imageDiskDevice`
 	diskXMBytes=`expr $diskXMBytes / 1024`
-	disk1MBytes=`partitionSize $imageDiskDevice&quot;1&quot;`
+	disk1MBytes=`partitionSize $(ddn $imageDiskDevice 1)`
 	disk1MBytes=`expr $disk1MBytes / 1024`
 	disk2MBytes=`expr $diskXMBytes - $disk1MBytes - $swapsize - $bootXMBytes`
 	if ! isFSTypeReadOnly;then
@@ -740,13 +740,13 @@ function OEMRepartLuks {
 			bootid=2
 		fi
 		activateBootPartition
-		export imageRootDevice=$(luksOpen $imageDiskDevice&quot;1&quot;)
-		export imageBootDevice=$imageDiskDevice&quot;2&quot;
-		export imageSwapDevice=$imageDiskDevice&quot;3&quot;
+		export imageRootDevice=$(luksOpen $(ddn $imageDiskDevice 1))
+		export imageBootDevice=$(ddn $imageDiskDevice 2)
+		export imageSwapDevice=$(ddn $imageDiskDevice 3)
 		if isFSTypeReadOnly;then
-			export imageBootDevice=$imageDiskDevice&quot;3&quot;
-			export imageSwapDevice=$imageDiskDevice&quot;4&quot;
-			export imageIOWRDevice=$(luksOpen $imageDiskDevice&quot;2&quot; luksReadWrite)
+			export imageBootDevice=$(ddn $imageDiskDevice 3)
+			export imageSwapDevice=$(ddn $imageDiskDevice 4)
+			export imageIOWRDevice=$(luksOpen $(ddn $imageDiskDevice 2) luksReadWrite)
 			export imageRWDevice=$imageIOWRDevice
 			export imageRODevice=$imageRootDevice
 		fi
diff --git a/system/boot/ix86/usbboot/suse-linuxrc b/system/boot/ix86/usbboot/suse-linuxrc
index a275814..8f38377 100755
--- a/system/boot/ix86/usbboot/suse-linuxrc
+++ b/system/boot/ix86/usbboot/suse-linuxrc
@@ -82,8 +82,8 @@ if [ $stickFound = 0 ];then
 	&quot;reboot&quot;
 fi
 Echo &quot;Searching for kiwiVG volume group...&quot;
-export stickRWDevice=$stickRoot&quot;2&quot;
-export stickRODevice=$stickRoot&quot;1&quot;
+export stickRWDevice=$(ddn $stickRoot 2)
+export stickRODevice=$(ddn $stickRoot 1)
 if searchVolumeGroup; then
 	export haveLVM=yes
 	if [ -e /dev/kiwiVG/LVComp ];then
@@ -93,7 +93,7 @@ if searchVolumeGroup; then
 	fi
 	export stickRWDevice=/dev/kiwiVG/LVRoot
 	export stickRODevice=/dev/kiwiVG/LVComp
-	export stickBootDevice=$stickRoot&quot;2&quot;
+	export stickBootDevice=$(ddn $stickRoot 2)
 fi
 
 #======================================
@@ -155,7 +155,7 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ];then
 		# DM use third partition as boot
 		#--------------------------------------
 		mkdir /mnt/dmboot
-		export imageBootDevice=$stickRoot&quot;3&quot;
+		export imageBootDevice=$(ddn $stickRoot 3)
 		mount $imageBootDevice /mnt/dmboot
 		cp -a  /mnt/boot /mnt/dmboot
 		rm -rf /mnt/boot
@@ -186,9 +186,9 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ];then
 		# LUKS use second or third part as boot
 		#--------------------------------------
 		mkdir /mnt/luksboot
-		export imageBootDevice=$stickRoot&quot;3&quot;
+		export imageBootDevice=$(ddn $stickRoot 3)
 		if [ ! -e $imageBootDevice ];then
-			imageBootDevice=$stickRoot&quot;2&quot;
+			imageBootDevice=$(ddn $stickRoot 2)
 		fi
 		mount $imageBootDevice /mnt/luksboot
 		if [ -z &quot;$UNIONFS_CONFIG&quot; ];then
diff --git a/system/boot/ix86/vmxboot/suse-linuxrc b/system/boot/ix86/vmxboot/suse-linuxrc
index 6bb093a..ac4fa84 100755
--- a/system/boot/ix86/vmxboot/suse-linuxrc
+++ b/system/boot/ix86/vmxboot/suse-linuxrc
@@ -128,9 +128,9 @@ Echo &quot;Found boot device: $imageDiskDevice&quot;
 #======================================
 # 8) Setup device names...
 #--------------------------------------
-export imageRootDevice=$imageDiskDevice&quot;1&quot;
-export imageRWDevice=$imageDiskDevice&quot;2&quot;
-export imageRODevice=$imageDiskDevice&quot;1&quot;
+export imageRootDevice=$(ddn $imageDiskDevice 1)
+export imageRWDevice=$(ddn $imageDiskDevice 2)
+export imageRODevice=$(ddn $imageDiskDevice 1)
 if [ -z &quot;$imageDiskDevice&quot; ];then
 	systemException \
 		&quot;Couldn't find any boot device... abort&quot; \
@@ -146,7 +146,7 @@ if searchVolumeGroup; then
 	fi
 	export imageRWDevice=/dev/kiwiVG/LVRoot
 	export imageRODevice=/dev/kiwiVG/LVComp
-	export imageBootDevice=$imageDiskDevice&quot;2&quot;
+	export imageBootDevice=$(ddn $imageDiskDevice 2)
 fi
 
 #======================================
@@ -208,7 +208,7 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ];then
 		# DM use third partition as boot
 		#--------------------------------------
 		mkdir /mnt/dmboot
-		export imageBootDevice=$imageDiskDevice&quot;3&quot;
+		export imageBootDevice=$(ddn $imageDiskDevice 3)
 		mount $imageBootDevice /mnt/dmboot
 		cp -a  /mnt/boot /mnt/dmboot
 		rm -rf /mnt/boot
@@ -239,9 +239,9 @@ if [ &quot;$LOCAL_BOOT&quot; = &quot;no&quot; ];then
 		# LUKS use second or third part as boot
 		#--------------------------------------
 		mkdir /mnt/luksboot
-		export imageBootDevice=$imageDiskDevice&quot;3&quot;
+		export imageBootDevice=$(ddn $imageDiskDevice 3)
 		if [ ! -e $imageBootDevice ];then
-			imageBootDevice=$imageDiskDevice&quot;2&quot;
+			imageBootDevice=$(ddn $imageDiskDevice 2)
 		fi
 		mount $imageBootDevice /mnt/luksboot
 		if [ -z &quot;$UNIONFS_CONFIG&quot; ];then


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001397.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. c6ddd9ae6e01ff4150445df8849743e851284c7a
</A></li>
	<LI>Next message: <A HREF="001399.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. ae66a0c815c50a593da64d70bda44dd7caebbf84
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1398">[ date ]</a>
              <a href="thread.html#1398">[ thread ]</a>
              <a href="subject.html#1398">[ subject ]</a>
              <a href="author.html#1398">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
