<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. c1c4116beb3ad539216cf4a2d1b24ddc10e64efa
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%20c1c4116beb3ad539216cf4a2d1b24ddc10e64efa&In-Reply-To=%3C200911171351.nAHDphB3029851%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001610.html">
   <LINK REL="Next"  HREF="001612.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. c1c4116beb3ad539216cf4a2d1b24ddc10e64efa</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%20c1c4116beb3ad539216cf4a2d1b24ddc10e64efa&In-Reply-To=%3C200911171351.nAHDphB3029851%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. c1c4116beb3ad539216cf4a2d1b24ddc10e64efa">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Tue Nov 17 14:51:43 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001610.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 497e924a51bce21b286ea743994d39ce2d55e67a
</A></li>
        <LI>Next message: <A HREF="001612.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-374-SuSE-11-1-SLE-SP-Devel,	updated. 73027a15da4043fbb8bcadda176a894cb9e50bf4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1611">[ date ]</a>
              <a href="thread.html#1611">[ thread ]</a>
              <a href="subject.html#1611">[ subject ]</a>
              <a href="author.html#1611">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  c1c4116beb3ad539216cf4a2d1b24ddc10e64efa (commit)
      from  497e924a51bce21b286ea743994d39ce2d55e67a (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit c1c4116beb3ad539216cf4a2d1b24ddc10e64efa
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Tue Nov 17 14:51:20 2009 +0100

    - added LVM feature to allow parts of the filesystem
      in a separate volume. The setup of volumes happens
      in the new &lt;lvmvolumes&gt; section

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/LaTex/Revision.txt b/doc/LaTex/Revision.txt
index 29c2214..f57ef38 100644
--- a/doc/LaTex/Revision.txt
+++ b/doc/LaTex/Revision.txt
@@ -1 +1 @@
-3.75
\ No newline at end of file
+3.76
\ No newline at end of file
diff --git a/doc/LaTex/description.tex b/doc/LaTex/description.tex
index c02dd42..4c734fc 100644
--- a/doc/LaTex/description.tex
+++ b/doc/LaTex/description.tex
@@ -234,7 +234,9 @@ describes the possible types and their attributes:
       either grub or syslinux as bootloader types. Setting the bootloader
       also works for vmx images but not for oem images. In case of an
       oem image only the distribution supported bootloader (grub) is
-      allowed.
+      allowed. The optional \textbf{lvm} attribute allows you to
+      activate LVM support and place the root filesystem into logical
+      volumes of the kiwiVG volume group
 \item \textbf{vmx}\\
       Use this type to create a virtual disk system along with the
       attributes \textbf{filesystem}, \textbf{boot=''vmxboot/suse-*''} and
@@ -244,6 +246,9 @@ describes the possible types and their attributes:
       kernel framebuffer mode. Detailed information about the possible
       values can be found in /usr/src/linux/Documentation/fb/vesafb.txt.
       The vga attribute also works for the image types usb and oem.
+      The optional \textbf{lvm} attribute allows you to
+      activate LVM support and place the root filesystem into logical
+      volumes of the kiwiVG volume group
 \item \textbf{oem}\\
       Use this type to create a preload virtual disk system along with
       the attributes \textbf{filesystem}, \textbf{boot=''oemboot/suse-*''} and
@@ -251,7 +256,9 @@ describes the possible types and their attributes:
       ''iso'' or ''usb'' KIWI will additionally create an installation
       media suitable for a CD/DVD or an USB stick. This installation media
       takes over the task of deploying the preload system onto the
-      storage devices which it detects at boot time.
+      storage devices which it detects at boot time. If the optional
+      \textbf{lvm} attribute is set the root filesystem of the oem system is 
+      placed into logical volumes of the kiwiVG volume group.
 \item \textbf{pxe}\\
       Use this type to create a network boot image along with the
       attributes \textbf{filesystem} and \textbf{boot=''netboot/suse-*''}
diff --git a/doc/LaTex/oem.tex b/doc/LaTex/oem.tex
index 3c01baf..09133eb 100644
--- a/doc/LaTex/oem.tex
+++ b/doc/LaTex/oem.tex
@@ -175,16 +175,36 @@ be specified:
 kiwi also provides support for LVM (Logical Volume Management). In this
 mode the disk partition table will include one lvm partition and one
 standard ext2 boot partition. kiwi creates the kiwiVG volume group and
-adds logical volumes as they are needed according to the image type and
-filesystem. After boot of the system the user has full control over the
-volume group and is free to change/resize/increas the group and the
-volumes inside. Support for LVM has been added for all image types which
-are disk based. This includes vmx,oem and usb. In order to use LVM for the
-oem type just add the \verb+--lvm+ option as part of the kiwi create step:
+adds logical volumes as they are needed and configured according to the
+image type and filesystem. After boot of the system the user has full
+control over the volume group and is free to change/resize/increas the
+group and the volumes inside. Support for LVM has been added for all
+image types which are disk based. This includes vmx,oem and usb.
+In order to use LVM for the oem type just add the \verb+--lvm+ option
+as part of the kiwi create step or add the attribute \textbf{lvm=''true''}
+as part of the \textbf{type} section in your config.xml file.
 
 \begin{Command}{12cm}
 \begin{verbatim}
-kiwi --create /tmp/myoem --type split \
+kiwi --create /tmp/myoem --type oem \
      -d /tmp/myoem-result --lvm
 \end{verbatim}
 \end{Command}
+
+With the optional \textbf{lvmvolumes} section you can set one or
+more top level directories into a separate volume. For example you
+want to put /usr and /var into different volumes add the following
+lvmvolumes section:
+
+\begin{Command}{12cm}
+\begin{verbatim}
+&lt;lvmvolumes&gt;
+   &lt;volume name=&quot;usr&quot; freespace=&quot;100M&quot;/&gt;
+   &lt;volume name=&quot;var&quot;/&gt;
+&lt;/lvmvolumes&gt;
+\end{verbatim}
+\end{Command}
+
+The optional freespace attribute let you add additional free space
+for that volume. If you don't set any freespace the volume will be
+about 80\% to 90\% full.
diff --git a/doc/LaTex/usb.tex b/doc/LaTex/usb.tex
index cea6500..bd5527f 100644
--- a/doc/LaTex/usb.tex
+++ b/doc/LaTex/usb.tex
@@ -181,12 +181,30 @@ If no split section is added the default split section from
 kiwi also provides support for LVM (Logical Volume Management). In this
 mode the disk partition table will include one lvm partition and one
 standard ext2 boot partition. kiwi creates the kiwiVG volume group and
-adds logical volumes as they are needed according to the image type and
-filesystem. After boot of the system the user has full control over the
-volume group and is free to change/resize/increas the group and the
-volumes inside. Support for LVM has been added for all image types which
-are disk based. This includes vmx,oem and usb. In order to use LVM for the
-usb type just add the \verb+--lvm+ option as part of the kiwi create
-step if the image is represented by an oem virtual disk or place the
-option when using the \verb+kiwi --bootstick+ approach
+adds logical volumes as they are needed and configured according to the
+image type and filesystem. After boot of the system the user has full
+control over the volume group and is free to change/resize/increas the
+group and the volumes inside. Support for LVM has been added for all
+image types which are disk based. This includes vmx,oem and usb.
+In order to use LVM for the usb type just add the \verb+--lvm+ option
+as part of the kiwi \verb+kiwi --bootstick+ deployment or add the
+attribute \textbf{lvm=''true''} as part of the \textbf{type} section
+in your config.xml file.
+
+The optional \textbf{lvmvolumes} section can be used to set one or
+more top level directories into a separate volume. For example you
+want to put /usr and /var into different volumes add the following
+lvmvolumes section:
 
+\begin{Command}{12cm}
+\begin{verbatim}
+&lt;lvmvolumes&gt;
+   &lt;volume name=&quot;usr&quot; freespace=&quot;100M&quot;/&gt;
+   &lt;volume name=&quot;var&quot;/&gt;
+&lt;/lvmvolumes&gt;
+\end{verbatim}
+\end{Command}
+
+The optional freespace attribute let you add additional free space
+for that volume. If you don't set any freespace the volume will be
+about 80\% to 90\% full.
diff --git a/doc/LaTex/vmx.tex b/doc/LaTex/vmx.tex
index cd1ee4f..061acde 100644
--- a/doc/LaTex/vmx.tex
+++ b/doc/LaTex/vmx.tex
@@ -134,12 +134,14 @@ Xen has a configuration file as well. Refer to chapter
 kiwi also provides support for LVM (Logical Volume Management). In this
 mode the disk partition table will include one lvm partition and one
 standard ext2 boot partition. kiwi creates the kiwiVG volume group and
-adds logical volumes as they are needed according to the image type and
-filesystem. After boot of the system the user has full control over the
-volume group and is free to change/resize/increas the group and the
-volumes inside. Support for LVM has been added for all image types which
-are disk based. This includes vmx,oem and usb. In order to use LVM for the
-vmx type just add the \verb+--lvm+ option as part of the kiwi create step:
+adds logical volumes as they are needed and configured according to the
+image type and filesystem. After boot of the system the user has full
+control over the volume group and is free to change/resize/increas the
+group and the volumes inside. Support for LVM has been added for all
+image types which are disk based. This includes vmx,oem and usb.
+In order to use LVM for the vmx type just add the \verb+--lvm+ option
+as part of the kiwi create step or add the attribute \textbf{lvm=''true''}
+as part of the \textbf{type} section in your config.xml file.
 
 \begin{Command}{12cm}
 \begin{verbatim}
@@ -147,3 +149,21 @@ kiwi --create /tmp/myvm --type vmx \
      -d /tmp/myvm-result --lvm
 \end{verbatim}
 \end{Command}
+
+With the optional \textbf{lvmvolumes} section you can set one or
+more top level directories into a separate volume. For example you
+want to put /usr and /var into different volumes add the following
+lvmvolumes section:
+
+\begin{Command}{12cm}
+\begin{verbatim}
+&lt;lvmvolumes&gt;
+   &lt;volume name=&quot;usr&quot; freespace=&quot;100M&quot;/&gt;
+   &lt;volume name=&quot;var&quot;/&gt;
+&lt;/lvmvolumes&gt;
+\end{verbatim}
+\end{Command}
+
+The optional freespace attribute let you add additional free space
+for that volume. If you don't set any freespace the volume will be
+about 80\% to 90\% full.
diff --git a/doc/kiwi-man/KIWI::config.sh.1 b/doc/kiwi-man/KIWI::config.sh.1
index 4abc7d4..be2eda0 100644
--- a/doc/kiwi-man/KIWI::config.sh.1
+++ b/doc/kiwi-man/KIWI::config.sh.1
@@ -1,54 +1,228 @@
 .\&quot;     Title: kiwi::config.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
-.\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 11/03/2009
+.\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
+.\&quot;      Date: Created: 11/17/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
+.\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::CONFIG\.SH&quot; &quot;1&quot; &quot;Created: 11/03/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 11/17/2009&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.\&quot; -----------------------------------------------------------------
+.\&quot; * (re)Define some macros
+.\&quot; -----------------------------------------------------------------
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; toupper - uppercase a string (locale-aware)
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de toupper
+.tr aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ
+\\$*
+.tr aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SH-xref - format a cross-reference to an SH section
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de SH-xref
+.ie n \{\
+.\}
+.toupper \\$*
+.el \{\
+\\$*
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SH - level-one heading that works better for non-TTY output
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de1 SH
+.\&quot; put an extra blank line of space above the head in non-TTY output
+.if t \{\
+.sp 1
+.\}
+.sp \\n[PD]u
+.nr an-level 1
+.set-an-margin
+.nr an-prevailing-indent \\n[IN]
+.fi
+.in \\n[an-margin]u
+.ti 0
+.HTML-TAG &quot;.NH \\n[an-level]&quot;
+.it 1 an-trap
+.nr an-no-space-flag 1
+.nr an-break-flag 1
+\.&quot; make the size of the head bigger
+.ps +3
+.ft B
+.ne (2v + 1u)
+.ie n \{\
+.\&quot; if n (TTY output), use uppercase
+.toupper \\$*
+.\}
+.el \{\
+.nr an-break-flag 0
+.\&quot; if not n (not TTY), use normal case (not uppercase)
+\\$1
+.in \\n[an-margin]u
+.ti 0
+.\&quot; if not n (not TTY), put a border/line under subheading
+.sp -.6
+\l'\n(.lu'
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SS - level-two heading that works better for non-TTY output
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de1 SS
+.sp \\n[PD]u
+.nr an-level 1
+.set-an-margin
+.nr an-prevailing-indent \\n[IN]
+.fi
+.in \\n[IN]u
+.ti \\n[SN]u
+.it 1 an-trap
+.nr an-no-space-flag 1
+.nr an-break-flag 1
+.ps \\n[PS-SS]u
+\.&quot; make the size of the head bigger
+.ps +2
+.ft B
+.ne (2v + 1u)
+.if \\n[.$] \&amp;\\$*
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; BB/BE - put background/screen (filled box) around block of text
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de BB
+.if t \{\
+.sp -.5
+.br
+.in +2n
+.ll -2n
+.gcolor red
+.di BX
+.\}
+..
+.de EB
+.if t \{\
+.if &quot;\\$2&quot;adjust-for-leading-newline&quot; \{\
+.sp -1
+.\}
+.br
+.di
+.in
+.ll
+.gcolor
+.nr BW \\n(.lu-\\n(.i
+.nr BH \\n(dn+.5v
+.ne \\n(BHu+.5v
+.ie &quot;\\$2&quot;adjust-for-leading-newline&quot; \{\
+\M[\\$1]\h'1n'\v'+.5v'\D'P \\n(BWu 0 0 \\n(BHu -\\n(BWu 0 0 -\\n(BHu'\M[]
+.\}
+.el \{\
+\M[\\$1]\h'1n'\v'-.5v'\D'P \\n(BWu 0 0 \\n(BHu -\\n(BWu 0 0 -\\n(BHu'\M[]
+.\}
+.in 0
+.sp -.5v
+.nf
+.BX
+.in
+.sp .5v
+.fi
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; BM/EM - put colored marker in margin next to block of text
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de BM
+.if t \{\
+.br
+.ll -2n
+.gcolor red
+.di BX
+.\}
+..
+.de EM
+.if t \{\
+.br
+.di
+.ll
+.gcolor
+.nr BH \\n(dn
+.ne \\n(BHu
+\M[\\$1]\D'P -.75n 0 0 \\n(BHu -(\\n[.i]u - \\n(INu - .75n) 0 0 -\\n(BHu'\M[]
+.in 0
+.nf
+.BX
+.in
+.fi
+.\}
+..
+.\&quot; -----------------------------------------------------------------
+.\&quot; * set default formatting
+.\&quot; -----------------------------------------------------------------
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
 .ad l
-.SH &quot;NAME&quot;
-KIWI::config.sh - Configuration File for KIWI image description
-.SH &quot;DESCRIPTION&quot;
-.PP
-The kiwi image description allows to have an optional config\.sh script in place\. This script should be designed to take over control of adding the image operating system configuration\. Configuration in that sense means stuff like activating services, creating configuration files, prepare an environment for a firstboot workflow, etc\. What you shouldn\'t do in config\.sh is breaking your systems integrity by for example removing packages or pieces of software\. Something like that can be done in images\.sh\. config\.sh is called
+.\&quot; -----------------------------------------------------------------
+.\&quot; * MAIN CONTENT STARTS HERE *
+.\&quot; -----------------------------------------------------------------
+.SH &quot;Name&quot;
+KIWI::config.sh \- Configuration File for KIWI image description
+.SH &quot;Description&quot;
+.PP
+The kiwi image description allows to have an optional config\&amp;.sh script in place\&amp;. This script should be designed to take over control of adding the image operating system configuration\&amp;. Configuration in that sense means stuff like activating services, creating configuration files, prepare an environment for a firstboot workflow, etc\&amp;. What you shouldn\'t do in config\&amp;.sh is breaking your systems integrity by for example removing packages or pieces of software\&amp;. Something like that can be done in images\&amp;.sh\&amp;. config\&amp;.sh is called
 \fIafter\fR
-the user and groups have been set up\. If there are SUSE Linux related YaST xml information these are validated before config\.sh is called too\. If you exit config\.sh with an exit code != 0 kiwi will exit with an error too\.
+the user and groups have been set up\&amp;. If there are SUSE Linux related YaST xml information these are validated before config\&amp;.sh is called too\&amp;. If you exit config\&amp;.sh with an exit code != 0 kiwi will exit with an error too\&amp;.
 .PP
-\fBExample\ 1.\ Template\fR
+\fBExample\ \&amp;1.\ \&amp;Template\fR
 .sp
+.if n \{\
 .RS 4
+.\}
+.fam C
+.ps -1
 .nf
+.if t \{\
+.sp -1
+.\}
+.BB lightgray adjust-for-leading-newline
+.sp -1
+
 #======================================
-# Functions\.\.\.
+# Functions\&amp;.\&amp;.\&amp;.
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
-test \-f /\.kconfig &amp;&amp; \. /\.kconfig
-test \-f /\.profile &amp;&amp; \. /\.profile
+test \-f /\&amp;.kconfig &amp;&amp; \&amp;. /\&amp;.kconfig
+test \-f /\&amp;.profile &amp;&amp; \&amp;. /\&amp;.profile
 
 #======================================
-# Greeting\.\.\.
+# Greeting\&amp;.\&amp;.\&amp;.
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
-echo &quot;Configure image: [$kiwi_iname]\.\.\.&quot;
+echo &quot;Configure image: [$kiwi_iname]\&amp;.\&amp;.\&amp;.&quot;
 
 #======================================
 # Call configuration code/functions
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
-\.\.\.
+\&amp;.\&amp;.\&amp;.
 
 #======================================
 # Exit safely
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
 exit
+.EB lightgray adjust-for-leading-newline
+.if t \{\
+.sp 1
+.\}
 .fi
+.fam
+.ps +1
+.if n \{\
 .RE
-.SH &quot;COMMON FUNCTIONS&quot;
+.\}
+.SH &quot;Common functions&quot;
 .PP
-The \.kconfig file allows to make use of a common set of functions\. Those which are SUSE Linux specific starts with the name
-\fIsuse\fR\. Those which are common to all linux systems starts with the name
-\fIbase\fR\. The following list describes which functions are available for config\.sh
+The \&amp;.kconfig file allows to make use of a common set of functions\&amp;. Those which are SUSE Linux specific starts with the name
+\fIsuse\fR\&amp;. Those which are common to all linux systems starts with the name
+\fIbase\fR\&amp;. The following list describes which functions are available for config\&amp;.sh
 .PP
 [baseCleanMount]
 .RS 4
@@ -77,22 +251,22 @@ Set up the linuxrc as init
 .PP
 [baseSetupBusyBox {\-f}]
 .RS 4
-activates busybox if installed for all links from the busybox/busybox\.links file \- you can choose custom apps to be forced into busybox with the &quot;\-f&quot; option as first parameter example: baseSetupBusyBox \-f /bin/zcat /bin/vi
+activates busybox if installed for all links from the busybox/busybox\&amp;.links file \- you can choose custom apps to be forced into busybox with the &quot;\-f&quot; option as first parameter example: baseSetupBusyBox \-f /bin/zcat /bin/vi
 .RE
 .PP
 [baseSetupInPlaceGITRepository]
 .RS 4
-Create an in place git repository of the root directory\. This process may take some time and you may expect problems with binary data handling
+Create an in place git repository of the root directory\&amp;. This process may take some time and you may expect problems with binary data handling
 .RE
 .PP
 [baseSetupInPlaceSVNRepository {path_list}]
 .RS 4
-Create an in place subversion repository for the specified directories\. A standard call could look like this baseSetupInPlaceSVNRepository /etc /srv /var/log
+Create an in place subversion repository for the specified directories\&amp;. A standard call could look like this baseSetupInPlaceSVNRepository /etc /srv /var/log
 .RE
 .PP
 [baseSetupPlainTextGITRepository]
 .RS 4
-Create an in place git repository of the root directory containing all plain/text files\.
+Create an in place git repository of the root directory containing all plain/text files\&amp;.
 .RE
 .PP
 [baseSetupUserPermissions]
@@ -127,7 +301,7 @@ remove all manual pages, except one given as parameter example: baseStripMans mo
 .PP
 [baseStripRPM]
 .RS 4
-remove rpms defined in config\.xml under image=delete section
+remove rpms defined in config\&amp;.xml under image=delete section
 .RE
 .PP
 [baseStripTools {list of toolpath} {list of tools}]
@@ -172,22 +346,22 @@ Call all postin scriptlets which among other things activates all required defau
 .PP
 [suseActivateServices]
 .RS 4
-Check all services in /etc/init\.d/ and activate them by calling suseInsertService
+Check all services in /etc/init\&amp;.d/ and activate them by calling suseInsertService
 .RE
 .PP
 [suseCloneRunlevel {runlevel}]
 .RS 4
-Clone the given runlevel to work in the same way as the default runlevel 3\.
+Clone the given runlevel to work in the same way as the default runlevel 3\&amp;.
 .RE
 .PP
 [suseConfig]
 .RS 4
-Setup keytable language and timezone if specified in config\.xml and call SuSEconfig afterwards
+Setup keytable language and timezone if specified in config\&amp;.xml and call SuSEconfig afterwards
 .RE
 .PP
 [suseInsertService {servicename}]
 .RS 4
-Recursively insert a service\. If there is a service required for this service it will be inserted first\. The suse insserv program is used here
+Recursively insert a service\&amp;. If there is a service required for this service it will be inserted first\&amp;. The suse insserv program is used here
 .RE
 .PP
 [suseRemoveService {servicename}]
@@ -202,55 +376,55 @@ Activate/Deactivate a service by using the chkconfig program The function requir
 .PP
 [suseServiceDefaultOn]
 .RS 4
-Activates the following services to be on by default using the chkconfig program: boot\.rootfsck boot\.cleanup boot\.localfs boot\.localnet boot\.clock policykitd dbus consolekt haldaemon network atd syslog cron kbd
+Activates the following services to be on by default using the chkconfig program: boot\&amp;.rootfsck boot\&amp;.cleanup boot\&amp;.localfs boot\&amp;.localnet boot\&amp;.clock policykitd dbus consolekt haldaemon network atd syslog cron kbd
 .RE
 .PP
 [suseSetupProductInformation]
 .RS 4
-This function will use zypper to search for the installed product and install all product specific packages\. This function only makes sense if zypper is used as packagemanager
+This function will use zypper to search for the installed product and install all product specific packages\&amp;. This function only makes sense if zypper is used as packagemanager
 .RE
 .PP
 [suseStripPackager {\-a}]
 .RS 4
 Remove smart o zypper packages and db files Also remove rpm package and db if &quot;\-a&quot; given
 .RE
-.SH &quot;PROFILE ENVIRONMENT VARIABLES&quot;
+.SH &quot;Profile environment variables&quot;
 .PP
-The \.profile environment file contains a specific set of variables which are listed below\. Some of the functions above makes use of the variables\.
+The \&amp;.profile environment file contains a specific set of variables which are listed below\&amp;. Some of the functions above makes use of the variables\&amp;.
 .PP
 [$kiwi_compressed]
 .RS 4
-The value of the compressed attribute set in the type element in config\.xml
+The value of the compressed attribute set in the type element in config\&amp;.xml
 .RE
 .PP
 [$kiwi_delete]
 .RS 4
-A list of all packages which are part of the packages section with type=\'delete\' in config\.xml
+A list of all packages which are part of the packages section with type=\'delete\' in config\&amp;.xml
 .RE
 .PP
 [$kiwi_drivers]
 .RS 4
-A comma seperated list of the driver entries as listed in the drivers section of the config\.xml\. Similar variables exists for the usbdrivers and scsidrivers sections
+A comma seperated list of the driver entries as listed in the drivers section of the config\&amp;.xml\&amp;. Similar variables exists for the usbdrivers and scsidrivers sections
 .RE
 .PP
 [$kiwi_iname]
 .RS 4
-The name of the image as listed in config\.xml
+The name of the image as listed in config\&amp;.xml
 .RE
 .PP
 [$kiwi_iversion]
 .RS 4
-The image version string major\.minor\.release
+The image version string major\&amp;.minor\&amp;.release
 .RE
 .PP
 [$kiwi_keytable]
 .RS 4
-The contents of the keytable setup as done in config\.xml
+The contents of the keytable setup as done in config\&amp;.xml
 .RE
 .PP
 [$kiwi_language]
 .RS 4
-The contents of the locale setup as done in config\.xml
+The contents of the locale setup as done in config\&amp;.xml
 .RE
 .PP
 [$kiwi_profiles]
@@ -260,22 +434,21 @@ A list of profiles used to build this image
 .PP
 [$kiwi_size]
 .RS 4
-The predefined size value for this image\. This is not the computed size but only the optional size value of the preferences section in config\.xml
+The predefined size value for this image\&amp;. This is not the computed size but only the optional size value of the preferences section in config\&amp;.xml
 .RE
 .PP
 [$kiwi_timezone]
 .RS 4
-The contents of the timezone setup as done in config\.xml
+The contents of the timezone setup as done in config\&amp;.xml
 .RE
 .PP
 [$kiwi_type]
 .RS 4
-The basic image type\. Can be a simply filesystem image type of ext2 ext3 reiserfs squashfs cpio or one of the following complex image types: iso split usb vmx oem xen pxe
+The basic image type\&amp;. Can be a simply filesystem image type of ext2 ext3 reiserfs squashfs cpio or one of the following complex image types: iso split usb vmx oem xen pxe
 .RE
-.SH &quot;AUTHOR&quot;
+.SH &quot;Author&quot;
 .PP
-\fBMarcus Sch&#195;&#164;fer\fR &lt;\&amp;ms (AT) suse\.de\&amp;&gt;
-.sp -1n
-.IP &quot;&quot; 4
+\fBMarcus Sch&#195;&#164;fer\fR &lt;\&amp;ms (AT) suse\&amp;.de\&amp;&gt;
+.RS 4
 Developer
-
+.RE
diff --git a/doc/kiwi-man/KIWI::images.sh.1 b/doc/kiwi-man/KIWI::images.sh.1
index eeae87a..5fda53e 100644
--- a/doc/kiwi-man/KIWI::images.sh.1
+++ b/doc/kiwi-man/KIWI::images.sh.1
@@ -1,52 +1,226 @@
 .\&quot;     Title: kiwi::images.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
-.\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 11/03/2009
+.\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
+.\&quot;      Date: Created: 11/17/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
+.\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::IMAGES\.SH&quot; &quot;1&quot; &quot;Created: 11/03/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 11/17/2009&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.\&quot; -----------------------------------------------------------------
+.\&quot; * (re)Define some macros
+.\&quot; -----------------------------------------------------------------
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; toupper - uppercase a string (locale-aware)
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de toupper
+.tr aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ
+\\$*
+.tr aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SH-xref - format a cross-reference to an SH section
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de SH-xref
+.ie n \{\
+.\}
+.toupper \\$*
+.el \{\
+\\$*
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SH - level-one heading that works better for non-TTY output
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de1 SH
+.\&quot; put an extra blank line of space above the head in non-TTY output
+.if t \{\
+.sp 1
+.\}
+.sp \\n[PD]u
+.nr an-level 1
+.set-an-margin
+.nr an-prevailing-indent \\n[IN]
+.fi
+.in \\n[an-margin]u
+.ti 0
+.HTML-TAG &quot;.NH \\n[an-level]&quot;
+.it 1 an-trap
+.nr an-no-space-flag 1
+.nr an-break-flag 1
+\.&quot; make the size of the head bigger
+.ps +3
+.ft B
+.ne (2v + 1u)
+.ie n \{\
+.\&quot; if n (TTY output), use uppercase
+.toupper \\$*
+.\}
+.el \{\
+.nr an-break-flag 0
+.\&quot; if not n (not TTY), use normal case (not uppercase)
+\\$1
+.in \\n[an-margin]u
+.ti 0
+.\&quot; if not n (not TTY), put a border/line under subheading
+.sp -.6
+\l'\n(.lu'
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SS - level-two heading that works better for non-TTY output
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de1 SS
+.sp \\n[PD]u
+.nr an-level 1
+.set-an-margin
+.nr an-prevailing-indent \\n[IN]
+.fi
+.in \\n[IN]u
+.ti \\n[SN]u
+.it 1 an-trap
+.nr an-no-space-flag 1
+.nr an-break-flag 1
+.ps \\n[PS-SS]u
+\.&quot; make the size of the head bigger
+.ps +2
+.ft B
+.ne (2v + 1u)
+.if \\n[.$] \&amp;\\$*
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; BB/BE - put background/screen (filled box) around block of text
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de BB
+.if t \{\
+.sp -.5
+.br
+.in +2n
+.ll -2n
+.gcolor red
+.di BX
+.\}
+..
+.de EB
+.if t \{\
+.if &quot;\\$2&quot;adjust-for-leading-newline&quot; \{\
+.sp -1
+.\}
+.br
+.di
+.in
+.ll
+.gcolor
+.nr BW \\n(.lu-\\n(.i
+.nr BH \\n(dn+.5v
+.ne \\n(BHu+.5v
+.ie &quot;\\$2&quot;adjust-for-leading-newline&quot; \{\
+\M[\\$1]\h'1n'\v'+.5v'\D'P \\n(BWu 0 0 \\n(BHu -\\n(BWu 0 0 -\\n(BHu'\M[]
+.\}
+.el \{\
+\M[\\$1]\h'1n'\v'-.5v'\D'P \\n(BWu 0 0 \\n(BHu -\\n(BWu 0 0 -\\n(BHu'\M[]
+.\}
+.in 0
+.sp -.5v
+.nf
+.BX
+.in
+.sp .5v
+.fi
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; BM/EM - put colored marker in margin next to block of text
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de BM
+.if t \{\
+.br
+.ll -2n
+.gcolor red
+.di BX
+.\}
+..
+.de EM
+.if t \{\
+.br
+.di
+.ll
+.gcolor
+.nr BH \\n(dn
+.ne \\n(BHu
+\M[\\$1]\D'P -.75n 0 0 \\n(BHu -(\\n[.i]u - \\n(INu - .75n) 0 0 -\\n(BHu'\M[]
+.in 0
+.nf
+.BX
+.in
+.fi
+.\}
+..
+.\&quot; -----------------------------------------------------------------
+.\&quot; * set default formatting
+.\&quot; -----------------------------------------------------------------
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
 .ad l
-.SH &quot;NAME&quot;
-KIWI::images.sh - Configuration File for KIWI image description
-.SH &quot;DESCRIPTION&quot;
+.\&quot; -----------------------------------------------------------------
+.\&quot; * MAIN CONTENT STARTS HERE *
+.\&quot; -----------------------------------------------------------------
+.SH &quot;Name&quot;
+KIWI::images.sh \- Configuration File for KIWI image description
+.SH &quot;Description&quot;
 .PP
-The kiwi image description allows to have an optional images\.sh script in place\. This script is called at the beginning of the kiwi create step\. It is allowed to remove software there to shrink down the size of the image\. Most often images\.sh is used for boot images because they needs to be small\. As images\.sh is called in the create step you should be aware to design the script in a way that it can be called multiple times without shooting itself into its knee\. As kiwi allows to create different image types from one previosly prepared tree one needs to take into account that images\.sh can be called more than one time\. If you exit images\.sh with an exit code != 0 kiwi will exit with an error too\.
+The kiwi image description allows to have an optional images\&amp;.sh script in place\&amp;. This script is called at the beginning of the kiwi create step\&amp;. It is allowed to remove software there to shrink down the size of the image\&amp;. Most often images\&amp;.sh is used for boot images because they needs to be small\&amp;. As images\&amp;.sh is called in the create step you should be aware to design the script in a way that it can be called multiple times without shooting itself into its knee\&amp;. As kiwi allows to create different image types from one previosly prepared tree one needs to take into account that images\&amp;.sh can be called more than one time\&amp;. If you exit images\&amp;.sh with an exit code != 0 kiwi will exit with an error too\&amp;.
 .PP
-\fBExample\ 1.\ Template\fR
+\fBExample\ \&amp;1.\ \&amp;Template\fR
 .sp
+.if n \{\
 .RS 4
+.\}
+.fam C
+.ps -1
 .nf
+.if t \{\
+.sp -1
+.\}
+.BB lightgray adjust-for-leading-newline
+.sp -1
+
 #======================================
-# Functions\.\.\.
+# Functions\&amp;.\&amp;.\&amp;.
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
-test \-f /\.kconfig &amp;&amp; \. /\.kconfig
-test \-f /\.profile &amp;&amp; \. /\.profile
+test \-f /\&amp;.kconfig &amp;&amp; \&amp;. /\&amp;.kconfig
+test \-f /\&amp;.profile &amp;&amp; \&amp;. /\&amp;.profile
 
 #======================================
-# Greeting\.\.\.
+# Greeting\&amp;.\&amp;.\&amp;.
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
-echo &quot;Configure image: [$kiwi_iname]\.\.\.&quot;
+echo &quot;Configure image: [$kiwi_iname]\&amp;.\&amp;.\&amp;.&quot;
 
 #======================================
 # Call configuration code/functions
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
-\.\.\.
+\&amp;.\&amp;.\&amp;.
 
 #======================================
 # Exit safely
 #\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
 exit
+.EB lightgray adjust-for-leading-newline
+.if t \{\
+.sp 1
+.\}
 .fi
+.fam
+.ps +1
+.if n \{\
 .RE
-.SH &quot;COMMON FUNCTIONS&quot;
+.\}
+.SH &quot;Common functions&quot;
 .PP
-The \.kconfig file allows to make use of a common set of functions\. Those which are SUSE Linux specific starts with the name
-\fIsuse\fR\. Those which are common to all linux systems starts with the name
-\fIbase\fR\. The following list describes which functions are available for images\.sh
+The \&amp;.kconfig file allows to make use of a common set of functions\&amp;. Those which are SUSE Linux specific starts with the name
+\fIsuse\fR\&amp;. Those which are common to all linux systems starts with the name
+\fIbase\fR\&amp;. The following list describes which functions are available for images\&amp;.sh
 .PP
 [baseCleanMount]
 .RS 4
@@ -60,27 +234,27 @@ Return the name(s) of profiles used to build this image
 .PP
 [baseGetPackagesForDeletion]
 .RS 4
-Return the list of packages setup in the packages type=\'delete\' section of the config\.xml used to build this image
+Return the list of packages setup in the packages type=\'delete\' section of the config\&amp;.xml used to build this image
 .RE
 .PP
 [baseSetupOEMPartition]
 .RS 4
-Writes the file /config\.oempartition depending on the following config\.xml parameters: oem\-reboot, oem\-swapsize, oem\-systemsize, oem\-home,oem\-swap,oem\-boot\-title,oem\-recovery, oem\-kiwi\-initrd\. kiwi takes the information from config\.xml and creates the config\.oempartition file as part of the automatically created boot image (initrd)\. The information must be available as part of the boot image because it controls the OEM repartition workflow on first boot of an OEM image\. Detailed information about the meaning of each option can be found in the OEM chapter in the kiwi cookbook
+Writes the file /config\&amp;.oempartition depending on the following config\&amp;.xml parameters: oem\-reboot, oem\-swapsize, oem\-systemsize, oem\-home,oem\-swap,oem\-boot\-title,oem\-recovery, oem\-kiwi\-initrd\&amp;. kiwi takes the information from config\&amp;.xml and creates the config\&amp;.oempartition file as part of the automatically created boot image (initrd)\&amp;. The information must be available as part of the boot image because it controls the OEM repartition workflow on first boot of an OEM image\&amp;. Detailed information about the meaning of each option can be found in the OEM chapter in the kiwi cookbook
 .RE
 .PP
 [suseGFXBoot {theme} {loadertyp}]
 .RS 4
-This function requires the gfxboot and at least one bootsplash\-theme\-* package to be installed in order to work correctly\. The function creates from this package data a graphics boot screen for the isolinux and grub boot loaders\. Additionally it creates the bootsplash files for the resolutions 800x600 1024x768 and 1280x1024
+This function requires the gfxboot and at least one bootsplash\-theme\-* package to be installed in order to work correctly\&amp;. The function creates from this package data a graphics boot screen for the isolinux and grub boot loaders\&amp;. Additionally it creates the bootsplash files for the resolutions 800x600 1024x768 and 1280x1024
 .RE
 .PP
 [suseStripKernel]
 .RS 4
-This function removes all kernel drivers which are not listed in the *drivers sections of the config\.xml file
+This function removes all kernel drivers which are not listed in the *drivers sections of the config\&amp;.xml file
 .RE
 .PP
 [suseStripInitrd]
 .RS 4
-This function removes a whole bunch of tools binaries and libraries which are not required in order to boot a suse system with kiwi\.
+This function removes a whole bunch of tools binaries and libraries which are not required in order to boot a suse system with kiwi\&amp;.
 .RE
 .PP
 [Rm {list of files}]
@@ -102,38 +276,38 @@ Helper function to print a message to the controling terminal
 .RS 4
 Helper function to print a message if the variable DEBUG is set to 1
 .RE
-.SH &quot;PROFILE ENVIRONMENT VARIABLES&quot;
+.SH &quot;Profile environment variables&quot;
 .PP
-The \.profile environment file contains a specific set of variables which are listed below\. Some of the functions above makes use of the variables\.
+The \&amp;.profile environment file contains a specific set of variables which are listed below\&amp;. Some of the functions above makes use of the variables\&amp;.
 .PP
 [$kiwi_iname]
 .RS 4
-The name of the image as listed in config\.xml
+The name of the image as listed in config\&amp;.xml
 .RE
 .PP
 [$kiwi_iversion]
 .RS 4
-The image version string major\.minor\.release
+The image version string major\&amp;.minor\&amp;.release
 .RE
 .PP
 [$kiwi_keytablee]
 .RS 4
-The contents of the keytable setup as done in config\.xml
+The contents of the keytable setup as done in config\&amp;.xml
 .RE
 .PP
 [$kiwi_language]
 .RS 4
-The contents of the locale setup as done in config\.xml
+The contents of the locale setup as done in config\&amp;.xml
 .RE
 .PP
 [$kiwi_timezone]
 .RS 4
-The contents of the timezone setup as done in config\.xml
+The contents of the timezone setup as done in config\&amp;.xml
 .RE
 .PP
 [$kiwi_delete]
 .RS 4
-A list of all packages which are part of the packages section with type=\'delete\' in config\.xml
+A list of all packages which are part of the packages section with type=\'delete\' in config\&amp;.xml
 .RE
 .PP
 [$kiwi_profiles]
@@ -143,27 +317,26 @@ A list of profiles used to build this image
 .PP
 [$kiwi_drivers]
 .RS 4
-A comma seperated list of the driver entries as listed in the drivers section of the config\.xml\. Similar variables exists for the usbdrivers and scsidrivers sections
+A comma seperated list of the driver entries as listed in the drivers section of the config\&amp;.xml\&amp;. Similar variables exists for the usbdrivers and scsidrivers sections
 .RE
 .PP
 [$kiwi_size]
 .RS 4
-The predefined size value for this image\. This is not the computed size but only the optional size value of the preferences section in config\.xml
+The predefined size value for this image\&amp;. This is not the computed size but only the optional size value of the preferences section in config\&amp;.xml
 .RE
 .PP
 [$kiwi_compressed]
 .RS 4
-The value of the compressed attribute set in the type element in config\.xml
+The value of the compressed attribute set in the type element in config\&amp;.xml
 .RE
 .PP
 [$kiwi_type]
 .RS 4
-The basic image type\. Can be a simply filesystem image type of ext2 ext3 reiserfs squashfs cpio or one of the following complex image types: iso split usb vmx oem xen pxe
+The basic image type\&amp;. Can be a simply filesystem image type of ext2 ext3 reiserfs squashfs cpio or one of the following complex image types: iso split usb vmx oem xen pxe
 .RE
-.SH &quot;AUTHOR&quot;
+.SH &quot;Author&quot;
 .PP
-\fBMarcus Sch&#195;&#164;fer\fR &lt;\&amp;ms (AT) suse\.de\&amp;&gt;
-.sp -1n
-.IP &quot;&quot; 4
+\fBMarcus Sch&#195;&#164;fer\fR &lt;\&amp;ms (AT) suse\&amp;.de\&amp;&gt;
+.RS 4
 Developer
-
+.RE
diff --git a/doc/kiwi-man/kiwi.1 b/doc/kiwi-man/kiwi.1
index 74181b6..043a580 100644
--- a/doc/kiwi-man/kiwi.1
+++ b/doc/kiwi-man/kiwi.1
@@ -1,200 +1,390 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Schaefer &lt;ms (AT) suse.de&gt;
-.\&quot; Generator: DocBook XSL Stylesheets v1.73.2 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 11/03/2009
+.\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
+.\&quot;      Date: Created: 11/17/2009
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
+.\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 11/03/2009&quot; &quot;KIWI v3\.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 11/17/2009&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.\&quot; -----------------------------------------------------------------
+.\&quot; * (re)Define some macros
+.\&quot; -----------------------------------------------------------------
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; toupper - uppercase a string (locale-aware)
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de toupper
+.tr aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ
+\\$*
+.tr aabbccddeeffgghhiijjkkllmmnnooppqqrrssttuuvvwwxxyyzz
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SH-xref - format a cross-reference to an SH section
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de SH-xref
+.ie n \{\
+.\}
+.toupper \\$*
+.el \{\
+\\$*
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SH - level-one heading that works better for non-TTY output
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de1 SH
+.\&quot; put an extra blank line of space above the head in non-TTY output
+.if t \{\
+.sp 1
+.\}
+.sp \\n[PD]u
+.nr an-level 1
+.set-an-margin
+.nr an-prevailing-indent \\n[IN]
+.fi
+.in \\n[an-margin]u
+.ti 0
+.HTML-TAG &quot;.NH \\n[an-level]&quot;
+.it 1 an-trap
+.nr an-no-space-flag 1
+.nr an-break-flag 1
+\.&quot; make the size of the head bigger
+.ps +3
+.ft B
+.ne (2v + 1u)
+.ie n \{\
+.\&quot; if n (TTY output), use uppercase
+.toupper \\$*
+.\}
+.el \{\
+.nr an-break-flag 0
+.\&quot; if not n (not TTY), use normal case (not uppercase)
+\\$1
+.in \\n[an-margin]u
+.ti 0
+.\&quot; if not n (not TTY), put a border/line under subheading
+.sp -.6
+\l'\n(.lu'
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; SS - level-two heading that works better for non-TTY output
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de1 SS
+.sp \\n[PD]u
+.nr an-level 1
+.set-an-margin
+.nr an-prevailing-indent \\n[IN]
+.fi
+.in \\n[IN]u
+.ti \\n[SN]u
+.it 1 an-trap
+.nr an-no-space-flag 1
+.nr an-break-flag 1
+.ps \\n[PS-SS]u
+\.&quot; make the size of the head bigger
+.ps +2
+.ft B
+.ne (2v + 1u)
+.if \\n[.$] \&amp;\\$*
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; BB/BE - put background/screen (filled box) around block of text
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de BB
+.if t \{\
+.sp -.5
+.br
+.in +2n
+.ll -2n
+.gcolor red
+.di BX
+.\}
+..
+.de EB
+.if t \{\
+.if &quot;\\$2&quot;adjust-for-leading-newline&quot; \{\
+.sp -1
+.\}
+.br
+.di
+.in
+.ll
+.gcolor
+.nr BW \\n(.lu-\\n(.i
+.nr BH \\n(dn+.5v
+.ne \\n(BHu+.5v
+.ie &quot;\\$2&quot;adjust-for-leading-newline&quot; \{\
+\M[\\$1]\h'1n'\v'+.5v'\D'P \\n(BWu 0 0 \\n(BHu -\\n(BWu 0 0 -\\n(BHu'\M[]
+.\}
+.el \{\
+\M[\\$1]\h'1n'\v'-.5v'\D'P \\n(BWu 0 0 \\n(BHu -\\n(BWu 0 0 -\\n(BHu'\M[]
+.\}
+.in 0
+.sp -.5v
+.nf
+.BX
+.in
+.sp .5v
+.fi
+.\}
+..
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.\&quot; BM/EM - put colored marker in margin next to block of text
+.\&quot; ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+.de BM
+.if t \{\
+.br
+.ll -2n
+.gcolor red
+.di BX
+.\}
+..
+.de EM
+.if t \{\
+.br
+.di
+.ll
+.gcolor
+.nr BH \\n(dn
+.ne \\n(BHu
+\M[\\$1]\D'P -.75n 0 0 \\n(BHu -(\\n[.i]u - \\n(INu - .75n) 0 0 -\\n(BHu'\M[]
+.in 0
+.nf
+.BX
+.in
+.fi
+.\}
+..
+.\&quot; -----------------------------------------------------------------
+.\&quot; * set default formatting
+.\&quot; -----------------------------------------------------------------
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
 .ad l
-.SH &quot;NAME&quot;
-kiwi - Creating Operating System Images
-.SH &quot;SYNOPSIS&quot;
-.HP 5
+.\&quot; -----------------------------------------------------------------
+.\&quot; * MAIN CONTENT STARTS HERE *
+.\&quot; -----------------------------------------------------------------
+.SH &quot;Name&quot;
+kiwi \- Creating Operating System Images
+.SH &quot;Synopsis&quot;
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-l | \-\-list}
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-o | \-\-clone} \fIimage\-path\fR {\-d} \fIdestination\fR
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-b | \-\-build} \fIimage\-path\fR {\-d} \fIdestination\fR
-.SH &quot;BASICS&quot;
+.fam
+.SH &quot;Basics&quot;
 .PP
-KIWI is a complete imaging solution that is based on an image description\. Such a description is represented by a directory which includes at least one
-\fIconfig\.xml\fR
-file and may as well include other files like scripts or configuration data\. The kiwi\-templates package provides example descriptions based on a JeOS system\. JeOS means Just enough Operating System\. KIWI provides image templates based on that axiom which means a JeOS is a small, text only based image including a predefined remote source setup to allow installation of missing software components at a later point in time\.
+KIWI is a complete imaging solution that is based on an image description\&amp;. Such a description is represented by a directory which includes at least one
+\FCconfig\&amp;.xml\F[]
+file and may as well include other files like scripts or configuration data\&amp;. The kiwi\-templates package provides example descriptions based on a JeOS system\&amp;. JeOS means Just enough Operating System\&amp;. KIWI provides image templates based on that axiom which means a JeOS is a small, text only based image including a predefined remote source setup to allow installation of missing software components at a later point in time\&amp;.
 .PP
 Detailed description of the kiwi image system exists in the system design document in
-\fI\%<A HREF="file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\.">file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\.</A> KIWI always operates in two steps\. The kiwi \-\-build option just combines both steps into one to make it easier to start with kiwi\. The first step is the preparation step and if that step was successful, a creation step follows which is able to create different image output types\. If you have started with an example and want to add you own changes it might be a good idea to clone of from this example\. This can be done by simply copying the entire image description or you can let kiwi do that for you by using the kiwi \-\-clone command\.
-.PP
-In the preparation step, you prepare a directory including the contents of your new filesystem based on one or more software package source(s) The creation step is based on the result of the preparation step and uses the contents of the new image root tree to create the output image\. If the image type ISO was requested, the output image would be a file with the suffix
-\fI\.iso\fR
-representing a live system on CD or DVD\. Other than that kiwi is able to create images for virtual and para\-virtual (Xen) environments as well as for USB stick, PXE network clients and OEM customized Linux systems\.
-.SH &quot;IMAGE PREPARATION AND CREATION&quot;
-.HP 5
+\m[blue]\fB\%<A HREF="file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\m[">file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\m[</A>]\&amp;. KIWI always operates in two steps\&amp;. The kiwi \-\-build option just combines both steps into one to make it easier to start with kiwi\&amp;. The first step is the preparation step and if that step was successful, a creation step follows which is able to create different image output types\&amp;. If you have started with an example and want to add you own changes it might be a good idea to clone of from this example\&amp;. This can be done by simply copying the entire image description or you can let kiwi do that for you by using the kiwi \-\-clone command\&amp;.
+.PP
+In the preparation step, you prepare a directory including the contents of your new filesystem based on one or more software package source(s) The creation step is based on the result of the preparation step and uses the contents of the new image root tree to create the output image\&amp;. If the image type ISO was requested, the output image would be a file with the suffix
+\FC\&amp;.iso\F[]
+representing a live system on CD or DVD\&amp;. Other than that kiwi is able to create images for virtual and para\-virtual (Xen) environments as well as for USB stick, PXE network clients and OEM customized Linux systems\&amp;.
+.SH &quot;Image Preparation and Creation&quot;
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-p | \-\-prepare} \fIimage\-path\fR
 .br
 [\-r | \-\-root\fIimage\-root\fR]
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-c | \-\-create} \fIimage\-root\fR
 .br
 {\-d | \-\-destdir\fIdestination\fR} [\-\-type\ \fIimage\-type\fR]
-.SH &quot;IMAGE UPGRADE&quot;
-.PP
-If the image root tree is stored and not removed, it can be used for upgrading the image according to the changes made in the repositories used for this image\. If a distributor provides an update channel for package updates and an image
-\fIconfig\.xml\fR
-includes this update channel as repository, it is useful to store the image root tree and upgrade the tree according to changes on the update channel\. Given that the root tree exists it\'s also possible to add or remove software and recreate the image of the desired type
-.HP 5
+.fam
+.SH &quot;Image Upgrade&quot;
+.PP
+If the image root tree is stored and not removed, it can be used for upgrading the image according to the changes made in the repositories used for this image\&amp;. If a distributor provides an update channel for package updates and an image
+\FCconfig\&amp;.xml\F[]
+includes this update channel as repository, it is useful to store the image root tree and upgrade the tree according to changes on the update channel\&amp;. Given that the root tree exists it\'s also possible to add or remove software and recreate the image of the desired type
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-u | \-\-upgrade} \fIimage\-root\fR [\-\-add\-package\fIname\fR]
-.SH &quot;SYSTEM TO IMAGE MIGRATION&quot;
+.fam
+.SH &quot;System to Image Migration&quot;
 .PP
-The migration module allows you to migrate your currently running system into an image description\. The module will check for files not managed by a package manager and it will suggest a repository from which this operating system could be rebuild\. The result is quite useful but in most cases a manual fine tuning is required\. This includes the repository selection and the unmanaged files along with the configuration details of your currently running operating system\.
-.HP 5
+The migration module allows you to migrate your currently running system into an image description\&amp;. The module will check for files not managed by a package manager and it will suggest a repository from which this operating system could be rebuild\&amp;. The result is quite useful but in most cases a manual fine tuning is required\&amp;. This includes the repository selection and the unmanaged files along with the configuration details of your currently running operating system\&amp;.
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-m | \-\-migrate} \fIname\fR \-\-destdir\ \fIdestination\-path\fR [\-\-exclude\ \fIdirectory\fR...] [\-\-report]
-.SH &quot;IMAGE POSTPROCESSING MODES&quot;
+.fam
+.SH &quot;Image Postprocessing Modes&quot;
 .PP
-The KIWI post\-processing modes are used for special image deployment tasks, like installing the image on a USB stick\. So to say they are the third step after preparation and creation\. kiwi calls the postprocessing modules automatically according to the specified output image type and attributes but it\'s also possible to call them manually\.
-.HP 5
+The KIWI post\-processing modes are used for special image deployment tasks, like installing the image on a USB stick\&amp;. So to say they are the third step after preparation and creation\&amp;. kiwi calls the postprocessing modules automatically according to the specified output image type and attributes but it\'s also possible to call them manually\&amp;.
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-bootstick\ \fIinitrd\fR [\-\-bootstick\-system\ \fIsystemImage\fR] [\-\-bootstick\-device\ \fIdevice\fR]
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-bootvm\ \fIinitrd\fR \-\-bootvm\-system\ \fIsystemImage\fR [\-\-bootvm\-disksize\ \fIsize\fR] [\-\-bootvm\-format\ \fIformat\fR]
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-bootcd\ \fIinitrd\fR
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-installcd\ \fIinitrd\fR \-\-installcd\-system\ \fIvmx\-system\-image\fR
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-installstick\ \fIinitrd\fR \-\-installstick\-system\ \fIvmx\-system\-image\fR
-.SH &quot;TESTSUITE&quot;
+.fam
+.SH &quot;Testsuite&quot;
 .PP
-The KIWI test suite is useful to perform basic quality checks on the image root directory\. The test cases are stored in subdirectories below
-\fI/usr/share/kiwi/tests\fR\.
-.HP 5
+The KIWI test suite is useful to perform basic quality checks on the image root directory\&amp;. The test cases are stored in subdirectories below
+\FC/usr/share/kiwi/tests\F[]\&amp;.
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-testsuite\ \fIimage\-root\fR [\-\-test\ \fIname\fR...]
-.SH &quot;HELPER TOOLS&quot;
+.fam
+.SH &quot;Helper Tools&quot;
 .PP
 The helper tools provide optional functions like creating a crypted password string for the users section of the
-\fIconfig\.xml\fR
-file or signing the image description with an md5sum hash as well as adding splash data to the boot image used by the bootloader and the testsuite mode which allows testing the integrity of the new root tree\.
-.HP 5
+\FCconfig\&amp;.xml\F[]
+file or signing the image description with an md5sum hash as well as adding splash data to the boot image used by the bootloader and the testsuite mode which allows testing the integrity of the new root tree\&amp;.
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-createpassword
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-createhash\ \fIimage\-path\fR
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR {\-i | \-\-info} \fIImagePath\fR {\-\-select\ \fI\ repo\-patterns|patterns|types|sources|size|profiles|packages\ \fR}
-.HP 5
+.fam
+.fam C
+.HP \w'\fBkiwi\fR\ 'u
 \fBkiwi\fR \-\-setup\-splash\ \fIinitrd\fR
+.fam
 .PP
 The following list describes the helper tools more detailed
 .PP
 [\fB\-\-createpassword\fR]
 .RS 4
-Create a crypted password hash and prints it on the console\. The user can use the string as value for the pwd attribute in the XML users section
+Create a crypted password hash and prints it on the console\&amp;. The user can use the string as value for the pwd attribute in the XML users section
 .RE
 .PP
 [\fB\-\-createhash \fR\fB\fIimage\-path\fR\fR ]
 .RS 4
-Sign your image description with a md5sum\. The result is written to a file named
-\fI\.checksum\.md\fR
+Sign your image description with a md5sum\&amp;. The result is written to a file named
+\FC\&amp;.checksum\&amp;.md\F[]
 and is checked if kiwi creates an image from this description
 .RE
 .PP
 [ \fB\-i\fR | \fB\-\-info \fR\fB\fIimage\-path\fR\fR \fB\-\-select \fR\fB\fIselection\fR\fR ]
 .RS 4
-List general information about the image description\. So far you can get information about the available patterns in the configured repositories with
+List general information about the image description\&amp;. So far you can get information about the available patterns in the configured repositories with
 \fIrepo\-patterns\fR, a list of used patterns for this image with
 \fIpatterns\fR, a list of supported image types with
 \fItypes\fR, a list of source URL\'s with
 \fIsources\fR, an estimation about the install size and the size of the packages marked as to be deleted with
 \fIsize\fR, a list of profiles with
 \fIprofiles\fR, and a list of solved packages to become installed with
-\fIpackages\fR\.
+\fIpackages\fR\&amp;.
 .RE
 .PP
 [\fB\-\-setup\-splash \fR\fB\fIinitrd\fR\fR ]
 .RS 4
-Create splash screen from the data inside the initrd and re\-create the initrd with the splash screen attached to the initrd cpio archive\. This enables the kernel to load the splash screen at boot time\. If splashy is used only a link to the original initrd will be created
+Create splash screen from the data inside the initrd and re\-create the initrd with the splash screen attached to the initrd cpio archive\&amp;. This enables the kernel to load the splash screen at boot time\&amp;. If splashy is used only a link to the original initrd will be created
 .RE
-.SH &quot;GLOBAL OPTIONS&quot;
+.SH &quot;Global Options&quot;
 .PP
 [\fB\-\-base\-root\fR \fIbase\-path\fR]
 .RS 4
-Refers to an already prepared root tree\. Kiwi will use this tree to skip the first stage of the prepare step and run the second stage directly\.
+Refers to an already prepared root tree\&amp;. Kiwi will use this tree to skip the first stage of the prepare step and run the second stage directly\&amp;.
 .RE
 .PP
 [\fB\-\-base\-root\-mode\fR \fIcopy|union|recycle\fR]
 .RS 4
-Specifies the overlay mode for the base root tree\. This can be either a copy of the tree, a union mount or the tree itself\. The last mode (recycle) will modify the base root tree which might make it obsolete as base root for other kiwi calls
+Specifies the overlay mode for the base root tree\&amp;. This can be either a copy of the tree, a union mount or the tree itself\&amp;. The last mode (recycle) will modify the base root tree which might make it obsolete as base root for other kiwi calls
 .RE
 .PP
 [\fB\-\-add\-profile\fR \fIprofile\-name\fR]
 .RS 4
-Use the specified profile\. A profile is a part of the XML image description and therefore can enhance each section with additional information\. For example adding packages\.
+Use the specified profile\&amp;. A profile is a part of the XML image description and therefore can enhance each section with additional information\&amp;. For example adding packages\&amp;.
 .RE
 .PP
 [\fB\-\-set\-repo\fR \fIURL\fR]
 .RS 4
-Set/Overwrite repo URL for the first listed repo\. The change is temporary and will not be written to the XML file\.
+Set/Overwrite repo URL for the first listed repo\&amp;. The change is temporary and will not be written to the XML file\&amp;.
 .RE
 .PP
 [\fB\-\-set\-repotype\fR \fItype\fR]
 .RS 4
-Set/Overwrite repo type for the first listed repo\. The supported repo types depends on the packagemanager\. Commonly supported are rpm\-md, rpm\-dir and yast2\. The change is temporary and will not be written to the XML file\.
+Set/Overwrite repo type for the first listed repo\&amp;. The supported repo types depends on the packagemanager\&amp;. Commonly supported are rpm\-md, rpm\-dir and yast2\&amp;. The change is temporary and will not be written to the XML file\&amp;.
 .RE
 .PP
 [\fB\-\-set\-repoalias\fR \fIname\fR]
 .RS 4
-Set/Overwrite alias name for the first listed repo\. Alias names are optional free form text\. If not set the source attribute value is used and builds the alias name by replacing each \'/\' with a \'_\'\. An alias name should be set if the source argument doesn\'t really explain what this repository contains\. The change is temporary and will not be written to the XML file\.
+Set/Overwrite alias name for the first listed repo\&amp;. Alias names are optional free form text\&amp;. If not set the source attribute value is used and builds the alias name by replacing each \'/\' with a \'_\'\&amp;. An alias name should be set if the source argument doesn\'t really explain what this repository contains\&amp;. The change is temporary and will not be written to the XML file\&amp;.
 .RE
 .PP
 [\fB\-\-set\-repoprio\fR \fInumber\fR]
 .RS 4
-Set/Overwrite priority for the first listed repo\. Works with the smart packagemanager only\. The Channel priority assigned to all packages available in this channel (0 if not set)\. If the exact same package is available in more than one channel, the highest priority is used\.
+Set/Overwrite priority for the first listed repo\&amp;. Works with the smart packagemanager only\&amp;. The Channel priority assigned to all packages available in this channel (0 if not set)\&amp;. If the exact same package is available in more than one channel, the highest priority is used\&amp;.
 .RE
 .PP
 [\fB\-\-add\-repo \fR\fB\fIURL\fR\fR, \fB\-\-add\-repotype \fR\fB\fItype\fR\fR \fB\-\-add\-repoalias \fR\fB\fIname\fR\fR \fB\-\-add\-repoprio \fR\fB\fInumber\fR\fR ]
 .RS 4
-Add the given repository and type for this run of an image prepare or upgrade process\. Multiple
+Add the given repository and type for this run of an image prepare or upgrade process\&amp;. Multiple
 \fB\-\-add\-repo\fR/\fB\-\-add\-repotype\fR
-options are possible\. The change will not be written to the
-\fIconfig\.xml\fR
+options are possible\&amp;. The change will not be written to the
+\FCconfig\&amp;.xml\F[]
 file
 .RE
 .PP
 [\fB\-\-ignore\-repos\fR]
 .RS 4
-Ignore all repositories specified so far, in XML or elsewhere\. This option should be used in conjunction with subsequent calls to
+Ignore all repositories specified so far, in XML or elsewhere\&amp;. This option should be used in conjunction with subsequent calls to
 \fB\-\-add\-repo\fR
-to specify repositories at the commandline that override previous specifications\.
+to specify repositories at the commandline that override previous specifications\&amp;.
 .RE
 .PP
 [\fB\-\-logfile \fR\fB\fIFilename\fR\fR | \fBterminal\fR]
 .RS 4
 Write to the log file
 \fIFilename\fR
-instead of the terminal\.
+instead of the terminal\&amp;.
 .RE
 .PP
 [\fB\-\-gzip\-cmd \fR\fB\fIcmd\fR\fR]
 .RS 4
-Specify an alternate command to run when compressing boot and system images\. Command must accept
+Specify an alternate command to run when compressing boot and system images\&amp;. Command must accept
 \fBgzip\fR
-options\.
+options\&amp;.
 .RE
 .PP
 [\fB\-\-log\-port \fR\fB\fIPortNumber\fR\fR]
 .RS 4
-Set the log server port\. By default port 9000 is used\. If multiple KIWI processes runs on one system it\'s recommended to set the logging port per process\.
+Set the log server port\&amp;. By default port 9000 is used\&amp;. If multiple KIWI processes runs on one system it\'s recommended to set the logging port per process\&amp;.
 .RE
 .PP
 [\fB\-\-package\-manager \fR\fB\fIsmart|zypper\fR\fR ]
 .RS 4
-Set the package manager to use for this image\. If set it will temporarly overwrite the value set in the xml description\.
+Set the package manager to use for this image\&amp;. If set it will temporarly overwrite the value set in the xml description\&amp;.
 .RE
 .PP
 [\fB\-A\fR | \fB\-\-target\-arch \fR\fB\fIi586|x86_64|armv5tel|ppc\fR\fR ]
 .RS 4
-Set a special target\-architecture\. This overrides the used architecture for the image\-packages in zypp\.conf\. When used with smart this option doesn\'t have any effect\.
+Set a special target\-architecture\&amp;. This overrides the used architecture for the image\-packages in zypp\&amp;.conf\&amp;. When used with smart this option doesn\'t have any effect\&amp;.
 .RE
 .PP
 [\fB\-\-debug\fR]
@@ -206,34 +396,34 @@ Prints a stack trace in case of internal errors
 .RS 4
 Controls the verbosity level for the instsource module
 .RE
-.SH &quot;IMAGE PREPARATION OPTIONS&quot;
+.SH &quot;Image Preparation Options&quot;
 .PP
 [\fB\-r\fR | \fB\-\-root \fR\fB\fIRootPath\fR\fR]
 .RS 4
-Set up the physical extend, chroot system below the given root\-path path\. If no
+Set up the physical extend, chroot system below the given root\-path path\&amp;. If no
 \fB\-\-root\fR
 option is given, KIWI will search for the attribute defaultroot in
-\fIconfig\.xml\fR\. If no root directory is known, a
+\FCconfig\&amp;.xml\F[]\&amp;. If no root directory is known, a
 \fBmktmp\fR
-directory will be created and used as root directory\.
+directory will be created and used as root directory\&amp;.
 .RE
 .PP
 [\fB\-\-force\-new\-root\fR]
 .RS 4
-Force creation of new root directory\. If the directory already exists, it is deleted\.
+Force creation of new root directory\&amp;. If the directory already exists, it is deleted\&amp;.
 .RE
-.SH &quot;IMAGE UPGRADE/PREPARATION OPTIONS&quot;
+.SH &quot;Image Upgrade/Preparation Options&quot;
 .PP
 [\fB\-\-add\-package\fR \fIpackage\fR ]
 .RS 4
-Add the given package name to the list of image packages multiple \-\-add\-package options are possible\. The change will not be written to the xml description\.
+Add the given package name to the list of image packages multiple \-\-add\-package options are possible\&amp;. The change will not be written to the xml description\&amp;.
 .RE
 .PP
 [\fB\-\-del\-package\fR \fIpackage\fR ]
 .RS 4
-Removes the given package by adding it the list of packages to become removed\. The change will not be written to the xml description\.
+Removes the given package by adding it the list of packages to become removed\&amp;. The change will not be written to the xml description\&amp;.
 .RE
-.SH &quot;IMAGE CREATION OPTIONS&quot;
+.SH &quot;Image Creation Options&quot;
 .PP
 [\fB\-d\fR | \fB\-\-destdir \fR\fB\fIDestinationPath\fR\fR]
 .RS 4
@@ -242,24 +432,24 @@ Specify destination directory to store the image file(s) If not specified, KIWI
 which can be specified in the
 \fIpreferences\fR
 section of the
-\fIconfig\.xml\fR
-file\. If it exists its value is used as destination directory\. If no destination information can be found, an error occurs\.
+\FCconfig\&amp;.xml\F[]
+file\&amp;. If it exists its value is used as destination directory\&amp;. If no destination information can be found, an error occurs\&amp;.
 .RE
 .PP
 [\fB\-t\fR | \fB\-\-type \fR\fB\fIImagetype\fR\fR]
 .RS 4
-Specify the output image type to use for this image\. Each type is described in a
+Specify the output image type to use for this image\&amp;. Each type is described in a
 \fItype\fR
-section of the preferences section\. At least one type has to be specified in the
-\fIconfig\.xml\fR
-description\. By default, the types specifying the
+section of the preferences section\&amp;. At least one type has to be specified in the
+\FCconfig\&amp;.xml\F[]
+description\&amp;. By default, the types specifying the
 \fIprimary\fR
-attribute will be used\. If there is no primary attribute set, the first type section of the preferences section is the primary type\. The types are only evaluated when kiwi runs the
+attribute will be used\&amp;. If there is no primary attribute set, the first type section of the preferences section is the primary type\&amp;. The types are only evaluated when kiwi runs the
 \fB\-\-create\fR
-step\. With the option
+step\&amp;. With the option
 \fB\-\-type\fR
 one can distinguish between the types stored in
-\fIconfig\.xml\fR
+\FCconfig\&amp;.xml\F[]
 .RE
 .PP
 [\fB\-s\fR | \fB\-\-strip\fR]
@@ -272,22 +462,22 @@ Strip shared objects and executables only make sense in combination with
 .RS 4
 Search in
 \fIDirectory\fR
-for pre\-built boot images\.
+for pre\-built boot images\&amp;.
 .RE
 .PP
 [\fB\-\-isocheck\fR]
 .RS 4
-in case of an iso image the checkmedia program generates a md5sum into the iso header\. If the \-\-isocheck option is specified a new boot menu entry will be generated which allows to check this media
+in case of an iso image the checkmedia program generates a md5sum into the iso header\&amp;. If the \-\-isocheck option is specified a new boot menu entry will be generated which allows to check this media
 .RE
 .PP
 [\fB\-\-lvm\fR]
 .RS 4
-Use the logical volume manager to control the disk\. The partition table will include one lvm partition and one standard ext2 boot partition\. Use of this option makes sense for the create step only and also only for the image types: vmx, oem and usb
+Use the logical volume manager to control the disk\&amp;. The partition table will include one lvm partition and one standard ext2 boot partition\&amp;. Use of this option makes sense for the create step only and also only for the image types: vmx, oem and usb
 .RE
 .PP
 [\fB\-\-fs\-blocksize \fR\fB\fInumber\fR\fR ]
 .RS 4
-When calling kiwi in creation mode this option will set the block size in bytes\. For ISO images with the old style ramdisk setup a blocksize of 4096 bytes is required
+When calling kiwi in creation mode this option will set the block size in bytes\&amp;. For ISO images with the old style ramdisk setup a blocksize of 4096 bytes is required
 .RE
 .PP
 [\fB\-\-fs\-journalsize \fR\fB\fInumber\fR\fR ]
@@ -297,55 +487,54 @@ When calling kiwi in creation mode this option will set the journal size in mega
 .PP
 [\fB\-\-fs\-inodesize \fR\fB\fInumber\fR\fR ]
 .RS 4
-When calling kiwi in creation mode this option will set the inode size in bytes\. This option has no effect if the reiser filesystem is used
+When calling kiwi in creation mode this option will set the inode size in bytes\&amp;. This option has no effect if the reiser filesystem is used
 .RE
 .PP
 [\fB\-\-fs\-inoderatio \fR\fB\fInumber\fR\fR ]
 .RS 4
-Set the bytes/inode ratio\. This option has no effect if the reiser filesystem is used
+Set the bytes/inode ratio\&amp;. This option has no effect if the reiser filesystem is used
 .RE
 .PP
 [\fB\-\-partitioner \fR\fB\fIfdisk|parted\fR\fR ]
 .RS 4
-Select the tool to create partition tables\. Supported are fdisk (sfdisk) and parted\. By default fdisk is used
+Select the tool to create partition tables\&amp;. Supported are fdisk (sfdisk) and parted\&amp;. By default fdisk is used
 .RE
 .PP
 [\fB\-\-check\-kernel\fR]
 .RS 4
-Activates check for matching kernels between boot and system image\. The kernel check also tries to fix the boot image if no matching kernel was found\.
+Activates check for matching kernels between boot and system image\&amp;. The kernel check also tries to fix the boot image if no matching kernel was found\&amp;.
 .RE
-.SH &quot;FOR MORE INFORMATION&quot;
+.SH &quot;For More Information&quot;
 .PP
 More information about KIWI, its files can be found at:
 .PP
-\fI\%<A HREF="http://en.opensuse.org/Build_Service/KIWI/Cookbook\fR">http://en.opensuse.org/Build_Service/KIWI/Cookbook\fR</A>
+\m[blue]\fB\%<A HREF="http://en.opensuse.org/Build_Service/KIWI/Cookbook\fR\m[">http://en.opensuse.org/Build_Service/KIWI/Cookbook\fR\m[</A>]
 .RS 4
 KIWI wiki
 .RE
 .PP
-\fIconfig\.xml\fR
+\FCconfig\&amp;.xml\F[]
 .RS 4
-The configuration XML file that contains every aspect for the image creation\.
+The configuration XML file that contains every aspect for the image creation\&amp;.
 .RE
 .PP
-\fI\%<A HREF="file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR">file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR</A>
+\m[blue]\fB\%<A HREF="file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\m[">file:///usr/share/doc/packages/kiwi/kiwi.pdf\fR\m[</A>]
 .RS 4
-The system design document which describes some details about the building process\.
+The system design document which describes some details about the building process\&amp;.
 .RE
 .PP
-\fI\%<A HREF="file:///usr/share/doc/packages/kiwi/schema/kiwi.xsd.html\fR">file:///usr/share/doc/packages/kiwi/schema/kiwi.xsd.html\fR</A>
+\m[blue]\fB\%<A HREF="file:///usr/share/doc/packages/kiwi/schema/kiwi.xsd.html\fR\m[">file:///usr/share/doc/packages/kiwi/schema/kiwi.xsd.html\fR\m[</A>]
 .RS 4
-The KIWI RelaxNG XML Schema documentation\.
+The KIWI RelaxNG XML Schema documentation\&amp;.
 .RE
 .PP
-\fI\%<A HREF="file:///usr/share/doc/packages/kiwi/schema/test.xsd.html\fR">file:///usr/share/doc/packages/kiwi/schema/test.xsd.html\fR</A>
+\m[blue]\fB\%<A HREF="file:///usr/share/doc/packages/kiwi/schema/test.xsd.html\fR\m[">file:///usr/share/doc/packages/kiwi/schema/test.xsd.html\fR\m[</A>]
 .RS 4
-The KIWI RelaxNG XML Schema documentation\.
+The KIWI RelaxNG XML Schema documentation\&amp;.
 .RE
-.SH &quot;AUTHOR&quot;
+.SH &quot;Author&quot;
 .PP
-\fBMarcus Schaefer\fR &lt;\&amp;ms (AT) suse\.de\&amp;&gt;
-.sp -1n
-.IP &quot;&quot; 4
+\fBMarcus Schaefer\fR &lt;\&amp;ms (AT) suse\&amp;.de\&amp;&gt;
+.RS 4
 Developer
-
+.RE
diff --git a/doc/kiwi.pdf b/doc/kiwi.pdf
index 6e1c66a..6dd9914 100644
Binary files a/doc/kiwi.pdf and b/doc/kiwi.pdf differ
diff --git a/modules/KIWIBoot.pm b/modules/KIWIBoot.pm
index 4dc760a..6ff7cb6 100644
--- a/modules/KIWIBoot.pm
+++ b/modules/KIWIBoot.pm
@@ -554,20 +554,9 @@ sub setupBootStick {
 	my $result;
 	my $hald;
 	my $xml;
+	my %lvmparts;
 	my $root;
 	#==========================================
-	# use lvm together with system image only
-	#------------------------------------------
-	if (! defined $system) {
-		undef $lvm;
-	}
-	#==========================================
-	# add boot space if lvm based
-	#------------------------------------------
-	if ($lvm) {
-		$lvmbootMB = 40;
-	}
-	#==========================================
 	# check if system is tree or image file
 	#------------------------------------------
 	if ( -d $system ) {
@@ -605,6 +594,50 @@ sub setupBootStick {
 	#------------------------------------------
 	my %type = %{$xml-&gt;getImageTypeAndAttributes()};
 	#==========================================
+	# use lvm together with system image only
+	#------------------------------------------
+	if (! defined $system) {
+		undef $type{lvm};
+		undef $lvm;
+	}
+	#==========================================
+	# Check for LVM...
+	#------------------------------------------
+	if (($type{lvm} =~ /true|yes/i) || ($lvm)) {
+		#==========================================
+		# add boot space if lvm based
+		#------------------------------------------
+		$lvm = 1;
+		$lvmbootMB  = 60;
+		$this-&gt;{lvm}= $lvm;
+		#==========================================
+		# check and set LVM volumes setup
+		#------------------------------------------
+		%lvmparts = $xml -&gt; getLVMVolumes();
+		if (%lvmparts) {
+			if ( ! -d $system ) {
+				$kiwi -&gt; error (
+					&quot;LVM volumes setup requires root tree but got image file&quot;
+				);
+				$kiwi -&gt; failed ();
+				$this -&gt; cleanTmp ();
+				return undef;
+			}
+			foreach my $vol (keys %lvmparts) {
+				#==========================================
+				# check directory per volume
+				#------------------------------------------
+				my $pname  = $vol; $pname =~ s/_/\//g;
+				if (! -d &quot;$system/$pname&quot;) {
+					$kiwi -&gt; error (&quot;Directory $system/$pname does not exist&quot;);
+					$kiwi -&gt; failed ();
+					$this -&gt; cleanTmp ();
+					return undef;
+				}
+			}
+		}
+	}
+	#==========================================
 	# check for device mapper snapshot / clicfs
 	#------------------------------------------
 	if (($type{filesystem} eq &quot;dmsquash&quot;) || ($type{filesystem} eq &quot;clicfs&quot;)) {
@@ -631,7 +664,7 @@ sub setupBootStick {
 	# add boot space if syslinux based
 	#------------------------------------------
 	if ($bootloader eq &quot;syslinux&quot;) {
-		$syslbootMB= 40;
+		$syslbootMB= 60;
 	}
 	#==========================================
 	# check image split portion
@@ -941,11 +974,17 @@ sub setupBootStick {
 		# Umount possible mounted stick partitions
 		#------------------------------------------
 		$this -&gt; umountDevice ($stick);
-		$status = qxx ( &quot;/sbin/blockdev --rereadpt $stick 2&gt;&amp;1&quot; );
-		$result = $? &gt;&gt; 8;
+		for (my $try=0;$try&gt;=2;$try++) {
+			$status = qxx ( &quot;/sbin/blockdev --rereadpt $stick 2&gt;&amp;1&quot; );
+			$result = $? &gt;&gt; 8;
+			if ($result != 0) {
+				sleep (1); next;
+			}
+			last;
+		}
 		if ($result != 0) {
 			$kiwi -&gt; failed ();
-			$kiwi -&gt; error  (&quot;Couldn't reread partition table: $!&quot;);
+			$kiwi -&gt; error  (&quot;Couldn't reread partition table: $status&quot;);
 			$kiwi -&gt; failed ();
 			$this -&gt; cleanDbus();
 			$this -&gt; cleanTmp ();
@@ -964,7 +1003,7 @@ sub setupBootStick {
 		#------------------------------------------
 		if ($lvm) {
 			%deviceMap = $this -&gt; setVolumeGroup (
-				\%deviceMap,$stick,$syszip,$haveSplit
+				\%deviceMap,$stick,$syszip,$haveSplit,\%lvmparts
 			);
 			if (! %deviceMap) {
 				$this -&gt; cleanDbus();
@@ -1042,66 +1081,11 @@ sub setupBootStick {
 		#==========================================
 		# Create fs on system image partition
 		#------------------------------------------
-		my %FSopts = main::checkFSOptions();
-		SWITCH: for ($FSTypeRO) {
-			/^ext2/     &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating ext2 root filesystem&quot;);
-				my $fsopts = $FSopts{ext2};
-				$fsopts.= &quot;-F&quot;;
-				if ($this-&gt;{inodes}) {
-					$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
-				}
-				$status = qxx (&quot;/sbin/mke2fs $fsopts $deviceMap{1} 2&gt;&amp;1&quot;);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			/^ext3/     &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating ext3 root filesystem&quot;);
-				my $fsopts = $FSopts{ext3};
-				$fsopts.= &quot;-j -F&quot;;
-				if ($this-&gt;{inodes}) {
-					$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
-				}
-				$status = qxx (&quot;/sbin/mke2fs $fsopts $deviceMap{1} 2&gt;&amp;1&quot;);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			/^ext4/     &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating ext4 root filesystem&quot;);
-				my $fsopts = $FSopts{ext4};
-				$fsopts.= &quot;-j -F&quot;;
-				if ($this-&gt;{inodes}) {
-					$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
-				}
-				$status = qxx (&quot;/sbin/mke2fs $fsopts $deviceMap{1} 2&gt;&amp;1&quot;);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			/^reiserfs/ &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating reiserfs root filesystem&quot;);
-				my $fsopts = $FSopts{reiserfs};
-				$fsopts.= &quot;-f&quot;;
-				$status = qxx (
-					&quot;/sbin/mkreiserfs $fsopts $deviceMap{1} 2&gt;&amp;1&quot;
-				);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			$kiwi -&gt; error  (&quot;Unsupported filesystem type: $FSTypeRO&quot;);
-			$kiwi -&gt; failed ();
-			$this -&gt; cleanDbus();
-			$this -&gt; cleanTmp ();
-			return undef;
-		};
-		if ($result != 0) {
-			$kiwi -&gt; failed ();
-			$kiwi -&gt; error  (&quot;Couldn't create $FSTypeRO filesystem: $status&quot;);
-			$kiwi -&gt; failed ();
+		if (! $this -&gt; setupFilesystem ($FSTypeRO,$deviceMap{1},&quot;root&quot;)) {
 			$this -&gt; cleanDbus();
 			$this -&gt; cleanTmp ();
 			return undef;
 		}
-		$kiwi -&gt; done();
 		#==========================================
 		# Mount system image partition
 		#------------------------------------------
@@ -1114,6 +1098,34 @@ sub setupBootStick {
 			return undef;
 		}
 		#==========================================
+		# Create LVM volumes filesystems
+		#------------------------------------------
+		if (($lvm) &amp;&amp; (%lvmparts)) {
+			my $VGroup = &quot;kiwiVG&quot;;
+			foreach my $name (keys %lvmparts) {
+				my $device = &quot;/dev/$VGroup/LV$name&quot;;
+				my $pname  = $name; $pname =~ s/_/\//g;
+				$status = qxx (&quot;mkdir -p $loopdir/$pname 2&gt;&amp;1&quot;);
+				$result = $? &gt;&gt; 8;
+				if ($result != 0) {
+					$kiwi -&gt; error (&quot;Can't create mount point $loopdir/$pname&quot;);
+					$this -&gt; cleanDbus();
+					$this -&gt; cleanLoop ();
+					return undef;
+				}
+				if (! $this -&gt; setupFilesystem ($FSTypeRO,$device,$pname)) {
+					$this -&gt; cleanDbus();
+					$this -&gt; cleanLoop ();
+					return undef;
+				}
+				if (! main::mount ($device, &quot;$loopdir/$pname&quot;)) {
+					$this -&gt; cleanDbus();
+					$this -&gt; cleanLoop ();
+					return undef;
+				}
+			}
+		}
+		#==========================================
 		# Copy root tree to virtual disk
 		#------------------------------------------
 		$kiwi -&gt; info (&quot;Copying system image tree on stick&quot;);
@@ -2083,12 +2095,7 @@ sub setupBootDisk {
 	my $status;
 	my $destdir;
 	my $xml;
-	#==========================================
-	# add boot space if lvm based
-	#------------------------------------------
-	if ($lvm) {
-		$lvmbootMB = 40;
-	}
+	my %lvmparts;
 	#==========================================
 	# check if image type is oem
 	#------------------------------------------
@@ -2139,6 +2146,55 @@ sub setupBootDisk {
 	#------------------------------------------
 	my %type = %{$xml-&gt;getImageTypeAndAttributes()};
 	#==========================================
+	# Check for LVM...
+	#------------------------------------------
+	if (($type{lvm} =~ /true|yes/i) || ($lvm)) {
+		#==========================================
+		# add boot space if lvm based
+		#------------------------------------------
+		$lvm = 1;
+		$lvmbootMB  = 60;
+		$this-&gt;{lvm}= $lvm;
+		#==========================================
+		# check and set LVM volumes setup
+		#------------------------------------------
+		%lvmparts = $xml -&gt; getLVMVolumes();
+		if (%lvmparts) {
+			if ( ! -d $system ) {
+				$kiwi -&gt; error (
+					&quot;LVM volumes setup requires root tree but got image file&quot;
+				);
+				$kiwi -&gt; failed ();
+				$this -&gt; cleanTmp ();
+				return undef;
+			}
+			foreach my $vol (keys %lvmparts) {
+				#==========================================
+				# check directory per volume
+				#------------------------------------------
+				my $pname  = $vol; $pname =~ s/_/\//g;
+				if (! -d &quot;$system/$pname&quot;) {
+					$kiwi -&gt; error (&quot;LVM: No such directory $system/$pname&quot;);
+					$kiwi -&gt; failed ();
+					$this -&gt; cleanTmp ();
+					return undef;
+                }
+				#==========================================
+				# increase total size per volume
+				#------------------------------------------
+				my $freespace = 0;
+				if ($lvmparts{$vol}) {
+					$freespace = $lvmparts{$vol};
+				}
+				$vmsize = $this-&gt;{vmmbyte} + 30 + $freespace;
+				$vmsize = sprintf (&quot;%.0f&quot;, $vmsize);
+				$this-&gt;{vmmbyte} = $vmsize;
+				$vmsize = $vmsize.&quot;M&quot;;
+				$this-&gt;{vmsize}  = $vmsize;
+			}
+		}
+	}
+	#==========================================
 	# check for device mapper snapshot / clicfs
 	#------------------------------------------
 	if (($type{filesystem} eq &quot;dmsquash&quot;) || ($type{filesystem} eq &quot;clicfs&quot;)) {
@@ -2164,7 +2220,7 @@ sub setupBootDisk {
 	# add boot space if syslinux based
 	#------------------------------------------
 	if ($bootloader eq &quot;syslinux&quot;) {
-		$syslbootMB = 40;
+		$syslbootMB = 60;
 	}
 	#==========================================
 	# build disk name and label from xml data
@@ -2202,8 +2258,8 @@ sub setupBootDisk {
 	#==========================================
 	# increase vmsize if single boot partition
 	#------------------------------------------
-	if (($dmbootMB) || ($syslbootMB)) {
-		$vmsize = $this-&gt;{vmmbyte} + (($dmbootMB + $syslbootMB) * 1.3);
+	if (($dmbootMB) || ($syslbootMB) || ($lvmbootMB)) {
+		$vmsize = $this-&gt;{vmmbyte} + (($dmbootMB+$syslbootMB+$lvmbootMB) * 1.3);
 		$vmsize = sprintf (&quot;%.0f&quot;, $vmsize);
 		$this-&gt;{vmmbyte} = $vmsize;
 		$vmsize = $vmsize.&quot;M&quot;;
@@ -2412,7 +2468,7 @@ sub setupBootDisk {
 		#------------------------------------------
 		if ($lvm) {
 			%deviceMap = $this -&gt; setVolumeGroup (
-				\%deviceMap,$this-&gt;{loop},$syszip,$haveSplit
+				\%deviceMap,$this-&gt;{loop},$syszip,$haveSplit,\%lvmparts
 			);
 			if (! %deviceMap) {
 				$this -&gt; cleanLoop ();
@@ -2572,75 +2628,43 @@ sub setupBootDisk {
 		#==========================================
 		# Create fs on system image partition
 		#------------------------------------------
-		my %FSopts = main::checkFSOptions();
-		SWITCH: for ($FSTypeRO) {
-			/^ext2/     &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating ext2 root filesystem&quot;);
-				my $fsopts = $FSopts{ext2};
-				$fsopts.= &quot;-F&quot;;
-				if ($this-&gt;{inodes}) {
-					$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
-				}
-				$status = qxx (&quot;/sbin/mke2fs $fsopts $root 2&gt;&amp;1&quot;);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			/^ext3/     &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating ext3 root filesystem&quot;);
-				my $fsopts = $FSopts{ext3};
-				$fsopts.= &quot;-j -F&quot;;
-				if ($this-&gt;{inodes}) {
-					$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
-				}
-				$status = qxx (&quot;/sbin/mke2fs $fsopts $root 2&gt;&amp;1&quot;);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			/^ext4/     &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating ext4 root filesystem&quot;);
-				my $fsopts = $FSopts{ext4};
-				$fsopts.= &quot;-j -F&quot;;
-				if ($this-&gt;{inodes}) {
-					$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
-				}
-				$status = qxx (&quot;/sbin/mke2fs $fsopts $root 2&gt;&amp;1&quot;);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			/^reiserfs/ &amp;&amp; do {
-				$kiwi -&gt; info (&quot;Creating reiserfs root filesystem&quot;);
-				my $fsopts = $FSopts{reiserfs};
-				$fsopts.= &quot;-f&quot;;
-				$status = qxx (
-					&quot;/sbin/mkreiserfs $fsopts $root 2&gt;&amp;1&quot;
-				);
-				$result = $? &gt;&gt; 8;
-				last SWITCH;
-			};
-			$kiwi -&gt; error  (&quot;Unsupported filesystem type: $FSTypeRO&quot;);
-			$kiwi -&gt; failed ();
-			$this -&gt; cleanTmp ();
-			return undef;
-		};
-		if ($result != 0) {
-			$kiwi -&gt; failed ();
-			$kiwi -&gt; error  (&quot;Couldn't create $FSTypeRO filesystem: $status&quot;);
-			$kiwi -&gt; failed ();
+		if (! $this -&gt; setupFilesystem ($FSTypeRO,$root,&quot;root&quot;)) {
 			$this -&gt; cleanTmp ();
 			return undef;
 		}
-		$kiwi -&gt; done();
 		#==========================================
 		# Mount system image partition
 		#------------------------------------------
-		if (! main::mount($root, $loopdir)) {
-			$kiwi -&gt; failed ();
-			$kiwi -&gt; error  (&quot;Couldn't mount partition: $status&quot;);
-			$kiwi -&gt; failed ();
+		if (! main::mount ($root, $loopdir)) {
 			$this -&gt; cleanLoop ();
 			return undef;
 		}
 		#==========================================
+		# Create LVM volumes filesystems
+		#------------------------------------------
+		if (($lvm) &amp;&amp; (%lvmparts)) {
+			my $VGroup = &quot;kiwiVG&quot;;
+			foreach my $name (keys %lvmparts) {
+				my $device = &quot;/dev/$VGroup/LV$name&quot;;
+				my $pname  = $name; $pname =~ s/_/\//g;
+				$status = qxx (&quot;mkdir -p $loopdir/$pname 2&gt;&amp;1&quot;);
+				$result = $? &gt;&gt; 8;
+				if ($result != 0) {
+					$kiwi -&gt; error (&quot;Can't create mount point $loopdir/$pname&quot;);
+					$this -&gt; cleanLoop ();
+					return undef;
+				}
+				if (! $this -&gt; setupFilesystem ($FSTypeRO,$device,$pname)) {
+					$this -&gt; cleanLoop ();
+					return undef;
+				}
+				if (! main::mount ($device, &quot;$loopdir/$pname&quot;)) {
+					$this -&gt; cleanLoop ();
+					return undef;
+				}
+			}
+		}
+		#==========================================
 		# Copy root tree to virtual disk
 		#------------------------------------------
 		$kiwi -&gt; info (&quot;Copying system image tree on virtual disk&quot;);
@@ -4537,8 +4561,11 @@ sub setVolumeGroup {
 	my $device    = shift;
 	my $syszip    = shift;
 	my $haveSplit = shift;
+	my $parts     = shift;
 	my $kiwi      = $this-&gt;{kiwi};
+	my $system    = $this-&gt;{system};
 	my %deviceMap = %{$map};
+	my %lvmparts  = %{$parts};
 	my $VGroup    = &quot;kiwiVG&quot;;
 	my %newmap;
 	my $status;
@@ -4578,8 +4605,30 @@ sub setVolumeGroup {
 			$VGroup,$device,[&quot;LVComp&quot;,&quot;LVRoot&quot;]
 		);
 	} else {
-		$status = qxx (&quot;lvcreate -l 100%FREE -n LVRoot $VGroup 2&gt;&amp;1&quot;);
-		$result = $? &gt;&gt; 8;
+		if (%lvmparts) {
+			foreach my $name (keys %lvmparts) {
+				my $pname = $name; $pname =~ s/_/\//g;
+				my $freespace = 0;
+				if ($lvmparts{$name}) {
+					$freespace = $lvmparts{$name};
+				}
+				my $lvsize = qxx (
+					&quot;du -s --block-size=1 $system/$pname | cut -f1&quot;
+				);
+				chomp $lvsize;
+				$lvsize /= 1048576;
+				$lvsize = int ( 30 + $lvsize + $freespace);
+				$status = qxx (&quot;lvcreate -L $lvsize -n LV$name $VGroup 2&gt;&amp;1&quot;);
+				$result = $? &gt;&gt; 8;
+				if ($result != 0) {
+					last;
+				}
+			}
+		}
+		if ($result == 0) {
+			$status = qxx (&quot;lvcreate -l 100%FREE -n LVRoot $VGroup 2&gt;&amp;1&quot;);
+			$result = $? &gt;&gt; 8;
+		}
 		if ($result != 0) {
 			$kiwi -&gt; failed ();
 			$kiwi -&gt; error  (&quot;Logical volume(s) setup failed: $status&quot;);
@@ -4737,4 +4786,77 @@ sub umountDevice {
 	return $this;
 }
 
+#==========================================
+# setupFilesystem
+#------------------------------------------
+sub setupFilesystem {
+	# ...
+	# create filesystem according to selected type
+	# ----
+	my $this   = shift;
+	my $fstype = shift;
+	my $device = shift;
+	my $name   = shift;
+	my $kiwi   = $this-&gt;{kiwi};
+	my %FSopts = main::checkFSOptions();
+	my $result;
+	my $status;
+	SWITCH: for ($fstype) {
+		/^ext2/     &amp;&amp; do {
+			$kiwi -&gt; info (&quot;Creating ext2 $name filesystem&quot;);
+			my $fsopts = $FSopts{ext2};
+			$fsopts.= &quot;-F&quot;;
+			if ($this-&gt;{inodes}) {
+				$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
+			}
+			$status = qxx (&quot;/sbin/mke2fs $fsopts $device 2&gt;&amp;1&quot;);
+			$result = $? &gt;&gt; 8;
+			last SWITCH;
+		};
+		/^ext3/     &amp;&amp; do {
+			$kiwi -&gt; info (&quot;Creating ext3 $name filesystem&quot;);
+			my $fsopts = $FSopts{ext3};
+			$fsopts.= &quot;-j -F&quot;;
+			if ($this-&gt;{inodes}) {
+				$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
+			}
+			$status = qxx (&quot;/sbin/mke2fs $fsopts $device 2&gt;&amp;1&quot;);
+			$result = $? &gt;&gt; 8;
+			last SWITCH;
+		};
+		/^ext4/     &amp;&amp; do {
+			$kiwi -&gt; info (&quot;Creating ext4 $name filesystem&quot;);
+			my $fsopts = $FSopts{ext4};
+			$fsopts.= &quot;-j -F&quot;;
+			if ($this-&gt;{inodes}) {
+				$fsopts.= &quot; -N $this-&gt;{inodes}&quot;;
+			}
+			$status = qxx (&quot;/sbin/mke2fs $fsopts $device 2&gt;&amp;1&quot;);
+			$result = $? &gt;&gt; 8;
+			last SWITCH;
+		};
+		/^reiserfs/ &amp;&amp; do {
+			$kiwi -&gt; info (&quot;Creating reiserfs $name filesystem&quot;);
+			my $fsopts = $FSopts{reiserfs};
+			$fsopts.= &quot;-f&quot;;
+			$status = qxx (
+				&quot;/sbin/mkreiserfs $fsopts $device 2&gt;&amp;1&quot;
+			);
+			$result = $? &gt;&gt; 8;
+			last SWITCH;
+		};
+		$kiwi -&gt; error  (&quot;Unsupported filesystem type: $fstype&quot;);
+		$kiwi -&gt; failed ();
+		return undef;
+	};
+	if ($result != 0) {
+		$kiwi -&gt; failed ();
+		$kiwi -&gt; error  (&quot;Couldn't create $fstype filesystem: $status&quot;);
+		$kiwi -&gt; failed ();
+		return undef;
+	}
+	$kiwi -&gt; done();
+	return $this;
+}
+
 1; 
diff --git a/modules/KIWILinuxRC.sh b/modules/KIWILinuxRC.sh
index 171a722..f5ef2d3 100644
--- a/modules/KIWILinuxRC.sh
+++ b/modules/KIWILinuxRC.sh
@@ -1561,6 +1561,19 @@ function updateRootDeviceFstab {
 	else
 		echo &quot;/dev/root / defaults 0 0&quot; &gt;&gt; $nfstab
 	fi
+	#======================================
+	# check for LVM volume setup
+	#--------------------------------------
+	if [ &quot;$haveLVM&quot; = &quot;yes&quot; ];then
+		for i in find /dev/kiwiVG/LV*;do
+			local volume=$(echo $i | cut -c15-)
+			local mpoint=$(echo $volume | tr _ /)
+			if [ ! $volume = &quot;Root&quot; ] &amp;&amp; [ ! $volume = &quot;Comp&quot; ];then
+				echo &quot;/dev/kiwiVG/LV$volume /$mpoint $FSTYPE defaults 0 0&quot; \
+				&gt;&gt; $nfstab
+			fi
+		done
+	fi
 }
 #======================================
 # updateSwapDeviceFstab
@@ -3744,6 +3757,15 @@ function mountSystemStandard {
 	else
 		mount $mountDevice /mnt &gt;/dev/null
 	fi
+	if [ &quot;$haveLVM&quot; = &quot;yes&quot; ];then
+		for i in find /dev/kiwiVG/LV*;do
+			local volume=$(echo $i | cut -c15-)
+			local mpoint=$(echo $volume | tr _ /)
+			if [ ! $volume = &quot;Root&quot; ] &amp;&amp; [ ! $volume = &quot;Comp&quot; ];then
+				mount /dev/kiwiVG/LV$volume /mnt/$mpoint
+			fi
+		done
+	fi
 	return $?
 }
 #======================================
diff --git a/modules/KIWISchema.rnc b/modules/KIWISchema.rnc
index cb61e72..5517633 100644
--- a/modules/KIWISchema.rnc
+++ b/modules/KIWISchema.rnc
@@ -83,7 +83,7 @@ div {
 		[
 		db:para [
 			&quot;Each KIWI configuration file consists of a root element\x{a}&quot; ~
-			&quot;        image.&quot;
+			&quot;image.&quot;
 		]
 		]
 		element image {
@@ -99,7 +99,8 @@ div {
 			k.split? &amp;
 			k.packages* &amp;
 			k.vmwareconfig? &amp;
-			k.xenconfig?
+			k.xenconfig? &amp;
+			k.lvmvolumes?
 		}
 }
 
@@ -1165,6 +1166,10 @@ div {
 # common element &lt;type&gt;
 #
 div {
+	k.type.lvm.attribute =
+		## Specify whether LVM should be used or not. This is effective
+		## for the types oem,usb and vmx
+		attribute lvm { xsd:boolean }
 	k.type.baseroot.attribute =
 		## Specify the path to a pre created base root system.
 		attribute baseroot { text }
@@ -1266,6 +1271,7 @@ div {
 		## Specifies the primary type (choose KIWI option type)
 		attribute primary { xsd:boolean }
 	k.type.attlist =
+		k.type.lvm.attribute? &amp;
 		k.type.checkprebuilt.attribute? &amp;
 		k.type.bootprofile.attribute? &amp;
 		k.type.bootkernel.attribute? &amp;
@@ -1295,6 +1301,57 @@ div {
 }
 
 #==========================================
+# common element &lt;volume&gt;
+#
+div {
+	k.volume.name.attribute =
+		## volume name. The name has to be the same like the directory
+		## name of the toplevel root directory. ONLY top level root
+		## directory names are allowed like srv or opt.
+		attribute name { text }
+	k.volume.freespace.attribute =
+		## free space to be added to this volume. The value is
+		## used as MB by default but you can add &quot;M&quot; and/or &quot;G&quot; as
+		## prefix
+		attribute freespace { text }
+	k.volume.attlist =
+		k.volume.freespace.attribute? &amp;
+		k.volume.name.attribute
+	k.volume =
+		## Specify which parts of the filesystem should be
+		## on a extra volume.
+		[
+		db:para [
+			&quot;Specify which parts of the filesystem should be onextra\x{a}&quot;
+			&quot;a extra volume.&quot;
+		]
+		]
+		element volume {
+			k.volume.attlist,
+			empty
+		}
+}
+
+
+#==========================================
+# common element &lt;lvmvolumes&gt;
+#
+div {
+	k.lvmvolumes.attlist = empty
+	k.lvmvolumes =
+		## Specify LVM volumes other than the root volume
+		[
+		db:para [
+			&quot;Specify LVM volumes other than the root volume.&quot;
+		]
+		]
+		element lvmvolumes {
+			k.lvmvolumes.attlist &amp;
+			k.volume+
+		}
+}
+
+#==========================================
 # common element &lt;union&gt;
 #
 div {
diff --git a/modules/KIWISchema.rng b/modules/KIWISchema.rng
index 7296b5d..41390ee 100644
--- a/modules/KIWISchema.rng
+++ b/modules/KIWISchema.rng
@@ -125,7 +125,7 @@ named /etc/ImageID&lt;/a:documentation&gt;
       &lt;element name=&quot;image&quot;&gt;
         &lt;a:documentation&gt;The root element of the configuration file		&lt;/a:documentation&gt;
         &lt;db:para&gt;Each KIWI configuration file consists of a root element
-        image.&lt;/db:para&gt;
+image.&lt;/db:para&gt;
         &lt;interleave&gt;
           &lt;ref name=&quot;k.image.attlist&quot;/&gt;
           &lt;ref name=&quot;k.description&quot;/&gt;
@@ -162,6 +162,9 @@ named /etc/ImageID&lt;/a:documentation&gt;
           &lt;optional&gt;
             &lt;ref name=&quot;k.xenconfig&quot;/&gt;
           &lt;/optional&gt;
+          &lt;optional&gt;
+            &lt;ref name=&quot;k.lvmvolumes&quot;/&gt;
+          &lt;/optional&gt;
         &lt;/interleave&gt;
       &lt;/element&gt;
     &lt;/define&gt;
@@ -1591,6 +1594,13 @@ the correct timezone and copy it to /etc/localtime.&lt;/db:para&gt;
     
   --&gt;
   &lt;div&gt;
+    &lt;define name=&quot;k.type.lvm.attribute&quot;&gt;
+      &lt;attribute name=&quot;lvm&quot;&gt;
+        &lt;a:documentation&gt;Specify whether LVM should be used or not. This is effective
+for the types oem,usb and vmx&lt;/a:documentation&gt;
+        &lt;data type=&quot;boolean&quot;/&gt;
+      &lt;/attribute&gt;
+    &lt;/define&gt;
     &lt;define name=&quot;k.type.baseroot.attribute&quot;&gt;
       &lt;attribute name=&quot;baseroot&quot;&gt;
         &lt;a:documentation&gt;Specify the path to a pre created base root system.&lt;/a:documentation&gt;
@@ -1771,6 +1781,9 @@ vmx/oem types only.&lt;/a:documentation&gt;
     &lt;define name=&quot;k.type.attlist&quot;&gt;
       &lt;interleave&gt;
         &lt;optional&gt;
+          &lt;ref name=&quot;k.type.lvm.attribute&quot;/&gt;
+        &lt;/optional&gt;
+        &lt;optional&gt;
           &lt;ref name=&quot;k.type.checkprebuilt.attribute&quot;/&gt;
         &lt;/optional&gt;
         &lt;optional&gt;
@@ -1842,6 +1855,67 @@ vmx/oem types only.&lt;/a:documentation&gt;
   &lt;/div&gt;
   &lt;!--
     ==========================================
+    common element &lt;volume&gt;
+    
+  --&gt;
+  &lt;div&gt;
+    &lt;define name=&quot;k.volume.name.attribute&quot;&gt;
+      &lt;attribute name=&quot;name&quot;&gt;
+        &lt;a:documentation&gt;volume name. The name has to be the same like the directory
+name of the toplevel root directory. ONLY top level root
+directory names are allowed like srv or opt.&lt;/a:documentation&gt;
+      &lt;/attribute&gt;
+    &lt;/define&gt;
+    &lt;define name=&quot;k.volume.freespace.attribute&quot;&gt;
+      &lt;attribute name=&quot;freespace&quot;&gt;
+        &lt;a:documentation&gt;free space to be added to this volume. The value is
+used as MB by default but you can add &quot;M&quot; and/or &quot;G&quot; as
+prefix&lt;/a:documentation&gt;
+      &lt;/attribute&gt;
+    &lt;/define&gt;
+    &lt;define name=&quot;k.volume.attlist&quot;&gt;
+      &lt;interleave&gt;
+        &lt;optional&gt;
+          &lt;ref name=&quot;k.volume.freespace.attribute&quot;/&gt;
+        &lt;/optional&gt;
+        &lt;ref name=&quot;k.volume.name.attribute&quot;/&gt;
+      &lt;/interleave&gt;
+    &lt;/define&gt;
+    &lt;define name=&quot;k.volume&quot;&gt;
+      &lt;element name=&quot;volume&quot;&gt;
+        &lt;a:documentation&gt;Specify which parts of the filesystem should be
+on a extra volume.&lt;/a:documentation&gt;
+        &lt;db:para&gt;Specify which parts of the filesystem should be onextra
+a extra volume.&lt;/db:para&gt;
+        &lt;ref name=&quot;k.volume.attlist&quot;/&gt;
+        &lt;empty/&gt;
+      &lt;/element&gt;
+    &lt;/define&gt;
+  &lt;/div&gt;
+  &lt;!--
+    ==========================================
+    common element &lt;lvmvolumes&gt;
+    
+  --&gt;
+  &lt;div&gt;
+    &lt;define name=&quot;k.lvmvolumes.attlist&quot;&gt;
+      &lt;empty/&gt;
+    &lt;/define&gt;
+    &lt;define name=&quot;k.lvmvolumes&quot;&gt;
+      &lt;element name=&quot;lvmvolumes&quot;&gt;
+        &lt;a:documentation&gt;Specify LVM volumes other than the root volume&lt;/a:documentation&gt;
+        &lt;db:para&gt;Specify LVM volumes other than the root volume.&lt;/db:para&gt;
+        &lt;interleave&gt;
+          &lt;ref name=&quot;k.lvmvolumes.attlist&quot;/&gt;
+          &lt;oneOrMore&gt;
+            &lt;ref name=&quot;k.volume&quot;/&gt;
+          &lt;/oneOrMore&gt;
+        &lt;/interleave&gt;
+      &lt;/element&gt;
+    &lt;/define&gt;
+  &lt;/div&gt;
+  &lt;!--
+    ==========================================
     common element &lt;union&gt;
     
   --&gt;
diff --git a/modules/KIWIXML.pm b/modules/KIWIXML.pm
index 1d11301..16d627f 100644
--- a/modules/KIWIXML.pm
+++ b/modules/KIWIXML.pm
@@ -153,6 +153,7 @@ sub new {
 	my $profilesNodeList;
 	my $vmwarecNodeList;
 	my $xenconfNodeList;
+	my $volumesNodeList;
 	eval {
 		$systemTree = $systemXML
 			-&gt; parse_file ( $controlFile );
@@ -169,6 +170,7 @@ sub new {
 		$instsrcNodeList = $systemTree -&gt; getElementsByTagName (&quot;instsource&quot;);
 		$vmwarecNodeList = $systemTree -&gt; getElementsByTagName (&quot;vmwareconfig&quot;);
 		$xenconfNodeList = $systemTree -&gt; getElementsByTagName (&quot;xenconfig&quot;);
+		$volumesNodeList = $systemTree -&gt; getElementsByTagName (&quot;lvmvolumes&quot;);
 		$partitionsNodeList = $systemTree 
 			-&gt; getElementsByTagName (&quot;partitions&quot;);
 		$configfileNodeList = $systemTree 
@@ -383,6 +385,7 @@ sub new {
 	$this-&gt;{profilesNodeList}   = $profilesNodeList;
 	$this-&gt;{vmwarecNodeList}    = $vmwarecNodeList;
 	$this-&gt;{xenconfNodeList}    = $xenconfNodeList;
+	$this-&gt;{volumesNodeList}    = $volumesNodeList;
 	$this-&gt;{reqProfiles}        = $reqProfiles;
 	$this-&gt;{havemd5File}        = $havemd5File;
 	$this-&gt;{arch}               = $arch;
@@ -758,6 +761,7 @@ sub getImageTypeAndAttributes {
 		}
 		$record{type}          = $node -&gt; string_value();
 		$record{luks}          = $node -&gt; getAttribute(&quot;luks&quot;);
+		$record{lvm}           = $node -&gt; getAttribute(&quot;lvm&quot;);
 		$record{compressed}    = $node -&gt; getAttribute(&quot;compressed&quot;);
 		$record{boot}          = $node -&gt; getAttribute(&quot;boot&quot;);
 		$record{volid}         = $node -&gt; getAttribute(&quot;volid&quot;);
@@ -2329,6 +2333,48 @@ sub getPackageAttributes {
 }
 
 #==========================================
+# getLVMVolumes
+#------------------------------------------
+sub getLVMVolumes {
+	# ...
+	# Create list of LVM volume names for sub volume
+	# setup. Each volume name will end up in an own
+	# LVM volume when the LVM setup is requested
+	# ---
+	my $this = shift;
+	my $kiwi = $this-&gt;{kiwi};
+	my $node = $this-&gt;{volumesNodeList} -&gt; get_node(1);
+	my %result = ();
+	if (! defined $node) {
+		return %result;
+	}
+	my @vollist = $node -&gt; getElementsByTagName (&quot;volume&quot;);
+	foreach my $volume (@vollist) {
+		my $name = $volume -&gt; getAttribute (&quot;name&quot;);
+		my $free = $volume -&gt; getAttribute (&quot;freespace&quot;);
+		if (($free) &amp;&amp; ($free =~ /(\d+)([MG]*)/)) {
+			my $byte = int $1;
+			my $unit = $2;
+			if ($unit eq &quot;G&quot;) {
+				$free = $byte * 1024;
+			} else {
+				# no or unknown unit, assume MB...
+				$free = $byte;
+			}
+		}
+		$name =~ s/^\///;
+		if ($name =~ /^(proc|sys|dev|boot|mnt|lib|bin|sbin|etc|lost\+found)/) {
+			$kiwi -&gt; warning (&quot;LVM: Directory $name is not allowed&quot;);
+			$kiwi -&gt; skipped ();
+			next;
+		}
+		$name =~ s/\//_/g;
+		$result{$name} = $free;
+	}
+	return %result;
+}
+
+#==========================================
 # getVMwareConfig
 #------------------------------------------
 sub getVMwareConfig {
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index b7a99ef..3fa0613 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -3,6 +3,9 @@ Mon Nov 16 10:47:04 CET 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 
 - v3.76
 - don't require preinit to call init (bnc #521456)
+- added LVM feature to allow parts of the filesystem
+  in a separate volume. The setup of volumes happens
+  in the new &lt;lvmvolumes&gt; section
 
 -------------------------------------------------------------------
 Mon Nov  9 11:21:27 CET 2009 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001610.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 497e924a51bce21b286ea743994d39ce2d55e67a
</A></li>
	<LI>Next message: <A HREF="001612.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-374-SuSE-11-1-SLE-SP-Devel,	updated. 73027a15da4043fbb8bcadda176a894cb9e50bf4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1611">[ date ]</a>
              <a href="thread.html#1611">[ thread ]</a>
              <a href="subject.html#1611">[ subject ]</a>
              <a href="author.html#1611">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
