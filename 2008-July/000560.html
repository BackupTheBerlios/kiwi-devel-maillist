<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] r1476 - in kiwi-head: doc/examples	doc/examples/suse-ec2-guest doc/examples/suse-ec2-guest/root	doc/examples/suse-ec2-guest/root/etc	doc/examples/suse-ec2-guest/root/etc/init.d	doc/examples/suse-ec2-guest/root/etc/sysconfig	doc/examples/suse-ec2-guest/root/etc/sysconfig/network rpm
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2008-July/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20r1476%20-%20in%20kiwi-head%3A%20doc/examples%0A%09doc/examples/suse-ec2-guest%20doc/examples/suse-ec2-guest/root%0A%09doc/examples/suse-ec2-guest/root/etc%0A%09doc/examples/suse-ec2-guest/root/etc/init.d%0A%09doc/examples/suse-ec2-guest/root/etc/sysconfig%0A%09doc/examples/suse-ec2-guest/root/etc/sysconfig/network%20rpm&In-Reply-To=%3C200807231213.m6NCDhLp017649%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000559.html">
   <LINK REL="Next"  HREF="000561.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] r1476 - in kiwi-head: doc/examples	doc/examples/suse-ec2-guest doc/examples/suse-ec2-guest/root	doc/examples/suse-ec2-guest/root/etc	doc/examples/suse-ec2-guest/root/etc/init.d	doc/examples/suse-ec2-guest/root/etc/sysconfig	doc/examples/suse-ec2-guest/root/etc/sysconfig/network rpm</H1>
    <B>marcus_schaefer at mail.berlios.de</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20r1476%20-%20in%20kiwi-head%3A%20doc/examples%0A%09doc/examples/suse-ec2-guest%20doc/examples/suse-ec2-guest/root%0A%09doc/examples/suse-ec2-guest/root/etc%0A%09doc/examples/suse-ec2-guest/root/etc/init.d%0A%09doc/examples/suse-ec2-guest/root/etc/sysconfig%0A%09doc/examples/suse-ec2-guest/root/etc/sysconfig/network%20rpm&In-Reply-To=%3C200807231213.m6NCDhLp017649%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] r1476 - in kiwi-head: doc/examples	doc/examples/suse-ec2-guest doc/examples/suse-ec2-guest/root	doc/examples/suse-ec2-guest/root/etc	doc/examples/suse-ec2-guest/root/etc/init.d	doc/examples/suse-ec2-guest/root/etc/sysconfig	doc/examples/suse-ec2-guest/root/etc/sysconfig/network rpm">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Wed Jul 23 14:13:43 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000559.html">[Kiwi-devel] r1475 - in kiwi-head: modules rpm
</A></li>
        <LI>Next message: <A HREF="000561.html">[Kiwi-devel] kiwi goes Amazon :-)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#560">[ date ]</a>
              <a href="thread.html#560">[ thread ]</a>
              <a href="subject.html#560">[ subject ]</a>
              <a href="author.html#560">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: marcus_schaefer
Date: 2008-07-23 14:13:22 +0200 (Wed, 23 Jul 2008)
New Revision: 1476

Added:
   kiwi-head/doc/examples/suse-ec2-guest.readme
   kiwi-head/doc/examples/suse-ec2-guest/
   kiwi-head/doc/examples/suse-ec2-guest/config.sh
   kiwi-head/doc/examples/suse-ec2-guest/config.xml
   kiwi-head/doc/examples/suse-ec2-guest/root/
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/group
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/init.d/
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/init.d/amazon
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/inittab
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/passwd
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/shadow
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/config
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/dhcp
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-eth0
   kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-lo
Modified:
   kiwi-head/rpm/kiwi.changes
Log:

- added ec2 example for suse 11.0: suse-ec2-guest (bnc #367138)



Added: kiwi-head/doc/examples/suse-ec2-guest/config.sh
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/config.sh	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/config.sh	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,51 @@
+#!/bin/bash
+#================
+# FILE          : config.sh
+#----------------
+# PROJECT       : OpenSuSE KIWI Image System
+# COPYRIGHT     : (c) 2006 SUSE LINUX Products GmbH. All rights reserved
+#               :
+# AUTHOR        : Marcus Schaefer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>&gt;
+#               :
+# BELONGS TO    : Operating System images
+#               :
+# DESCRIPTION   : configuration script for SUSE based
+#               : operating systems
+#               :
+#               :
+# STATUS        : BETA
+#----------------
+#======================================
+# Functions...
+#--------------------------------------
+test -f /.kconfig &amp;&amp; . /.kconfig
+test -f /.profile &amp;&amp; . /.profile
+
+#======================================
+# Greeting...
+#--------------------------------------
+echo &quot;Configure image: [$kiwi_iname]...&quot;
+
+#======================================
+# Activate services
+#--------------------------------------
+suseActivateDefaultServices
+suseInsertService boot.device-mapper
+suseInsertService amazon
+
+#======================================
+# SuSEconfig
+#--------------------------------------
+suseConfig
+
+#======================================
+# clone runlevel 3 to 4
+#--------------------------------------
+suseCloneRunlevel 4
+
+#======================================
+# Umount kernel filesystems
+#--------------------------------------
+baseCleanMount
+
+exit 0


Property changes on: kiwi-head/doc/examples/suse-ec2-guest/config.sh
___________________________________________________________________
Name: svn:executable
   + *

Added: kiwi-head/doc/examples/suse-ec2-guest/config.xml
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/config.xml	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/config.xml	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,48 @@
+&lt;?xml version=&quot;1.0&quot;?&gt;
+&lt;image schemeversion=&quot;2.4&quot; name=&quot;suse-11.0-ec2-guest&quot;&gt;
+	&lt;description type=&quot;system&quot;&gt;
+		&lt;author&gt;Marcus Schaefer&lt;/author&gt;
+		&lt;contact&gt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&lt;/contact&gt;
+		&lt;specification&gt;openSUSE Amazon ec2 11.0 test system&lt;/specification&gt;
+	&lt;/description&gt;
+	&lt;preferences&gt;
+		&lt;type primary=&quot;true&quot;
+			  ec2accountnr=&quot;12345678911&quot;
+			  ec2privatekeyfile=&quot;Path to EC2 private key file&quot;
+			  ec2certfile=&quot;Path to EC2 public certificate file&quot;
+		&gt;ec2&lt;/type&gt;
+		&lt;type filesystem=&quot;ext3&quot; boot=&quot;vmxboot/suse-11.0&quot;&gt;vmx&lt;/type&gt;
+		&lt;type filesystem=&quot;ext3&quot; boot=&quot;xenboot/suse-11.0&quot;&gt;xen&lt;/type&gt;
+		&lt;version&gt;1.1.2&lt;/version&gt;
+		&lt;packagemanager&gt;smart&lt;/packagemanager&gt;
+		&lt;rpm-check-signatures&gt;False&lt;/rpm-check-signatures&gt;
+	&lt;/preferences&gt;
+	&lt;repository type=&quot;yast2&quot;&gt;
+		&lt;source path=&quot;/image/CDs/full-11.0-i386&quot;/&gt;
+		&lt;!--&lt;source path=&quot;<A HREF="opensuse://openSUSE:11.0/standard/">opensuse://openSUSE:11.0/standard/</A>&quot;/&gt;--&gt;
+	&lt;/repository&gt;
+	&lt;packages type=&quot;image&quot;&gt;
+		&lt;package name=&quot;kernel-default&quot;/&gt;
+		&lt;package name=&quot;kernel-xen&quot;/&gt;
+		&lt;package name=&quot;bootsplash&quot;/&gt;
+		&lt;package name=&quot;bootsplash-branding-openSUSE&quot;/&gt;
+		&lt;package name=&quot;vim&quot;/&gt;
+		&lt;opensusePattern name=&quot;base&quot;/&gt;
+	&lt;/packages&gt;
+	&lt;packages type=&quot;xen&quot;&gt;
+		&lt;package name=&quot;kernel-xen&quot;/&gt;
+		&lt;package name=&quot;xen&quot;/&gt;
+	&lt;/packages&gt;
+	&lt;packages type=&quot;vmware&quot;&gt;
+	&lt;/packages&gt;
+	&lt;xenconfig memory=&quot;512&quot;&gt;
+		&lt;xendisk device=&quot;/dev/sda&quot;/&gt;
+	&lt;/xenconfig&gt;
+	&lt;vmwareconfig memory=&quot;512&quot;&gt;
+		&lt;vmwaredisk controller=&quot;ide&quot; id=&quot;0&quot;/&gt;
+	&lt;/vmwareconfig&gt;
+	&lt;packages type=&quot;bootstrap&quot;&gt;
+		&lt;package name=&quot;filesystem&quot;/&gt; 
+		&lt;package name=&quot;glibc-locale&quot;/&gt;
+	&lt;/packages&gt;
+&lt;/image&gt;

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/group
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/group	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/group	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,50 @@
+root:*:0:
+bin:*:1:daemon
+daemon:*:2:
+sys:*:3:
+tty:*:5:
+disk:*:6:
+lp:*:7:
+www:*:8:
+kmem:*:9:
+wheel:*:10:
+mail:*:12:
+news:*:13:
+uucp:*:14:
+shadow:*:15:
+dialout:*:16:
+audio:*:17:ms
+floppy:*:19:
+cdrom:*:20:
+console:*:21:
+utmp:*:22:
+public:*:32:
+video:*:33:ms
+games:*:40:
+xok:*:41:
+trusted:*:42:
+modem:*:43:
+ftp:*:49:
+man:*:62:
+users:*:100:
+nobody:*:65533:nobody
+nogroup:*:65534:nobody
+named:!:44:
+radiusd:!:101:
+ntadmin:!:71:
+at:!:25:
+ldap:!:70:
+sshd:!:65:
+postfix:!:51:
+maildrop:!:59:
+privoxy:!:102:
+mailman:!:67:
+distcc:!:103:
+quagga:!:104:
+messagebus:!:105:
+icecream:!:106:
+haldaemon:!:107:
+ntp:!:108:
+suse-ncc:!:109:
+gdm:!:414:
++:::

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/init.d/amazon
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/init.d/amazon	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/init.d/amazon	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,101 @@
+#!/bin/sh
+# Copyright (c) 2008 SuSE Linux AG, Nuernberg, Germany.
+# All rights reserved.
+#
+# Author: Amazon EC2 team
+# Author: Marcus Sch&#228;fer
+#
+# /etc/init.d/amazon
+#
+#   and it's symbolic link
+#
+# /usr/sbin/rcamazon
+#
+### BEGIN INIT INFO
+# Provides:       amazon
+# Required-Start: $network
+# Should-Start:
+# Required-Stop:
+# Should-Stop:
+# Default-Start:  3 5
+# Default-Stop: 
+# Description:    Fetch ec2 certificates    
+# Short-Description: Fetch ec2 certificates 
+### END INIT INFO
+
+. /etc/rc.status
+
+# First reset status of this service
+rc_reset
+
+# root's public keys
+PUB_KEY_URI=<A HREF="http://169.254.169.254/1.0/meta-data/public-keys/0/openssh-key">http://169.254.169.254/1.0/meta-data/public-keys/0/openssh-key</A>
+PUB_KEY_FROM_HTTP=/tmp/openssh_id.pub
+PUB_KEY_FROM_EPHEMERAL=/mnt/openssh_id.pub
+ROOT_AUTHORIZED_KEYS=/root/.ssh/authorized_keys
+
+# We need somewhere to put the keys.
+if [ ! -d /root/.ssh ] ; then
+	mkdir -p /root/.ssh
+	chmod 700 /root/.ssh
+fi
+
+# Fetch credentials function...
+function fetchCredentials {
+	curl --retry 3 --retry-delay 0 --silent \
+		--fail -o $PUB_KEY_FROM_HTTP $PUB_KEY_URI
+	if [ $? -eq 0 -a -e $PUB_KEY_FROM_HTTP ] ; then
+		if ! grep -q -f $PUB_KEY_FROM_HTTP $ROOT_AUTHORIZED_KEYS;then
+			cat $PUB_KEY_FROM_HTTP &gt;&gt; $ROOT_AUTHORIZED_KEYS
+			echo &quot;New key added to authrozied keys file from parameters&quot; |\
+				logger -t &quot;ec2&quot;
+		fi
+		chmod 600 $ROOT_AUTHORIZED_KEYS
+		rm -f $PUB_KEY_FROM_HTTP
+	elif [ -e $PUB_KEY_FROM_EPHEMERAL ] ; then
+		# Try back to ephemeral store if http failed.
+		# NOTE: This usage is deprecated and will be removed in the future
+		if ! grep -q -f $PUB_KEY_FROM_EPHEMERAL $ROOT_AUTHORIZED_KEYS; then
+			cat $PUB_KEY_FROM_EPHEMERAL &gt;&gt; $ROOT_AUTHORIZED_KEYS
+			echo &quot;New key added to authrozied keys file from ephemeral store&quot;|\
+				logger -t &quot;ec2&quot;
+		fi
+		chmod 600 $ROOT_AUTHORIZED_KEYS
+		chmod 600 $PUB_KEY_FROM_EPHEMERAL
+	fi
+	if [ -e /mnt/openssh_id.pub ] ; then
+		if ! grep -q -f /mnt/openssh_id.pub /root/.ssh/authorized_keys; then
+			cat /mnt/openssh_id.pub &gt;&gt; /root/.ssh/authorized_keys
+			 echo &quot;New key added to authrozied keys file from ephemeral store&quot;|\
+				logger -t &quot;ec2&quot;
+		fi
+		chmod 600 /root/.ssh/authorized_keys
+	fi
+}
+
+case &quot;$1&quot; in
+	start)
+		echo -n &quot;Fetching Amazon EC2 certificates...&quot;
+		fetchCredentials
+		rc_status -v
+		;;
+	stop)
+		echo -n &quot;Fetching Amazon EC2 certificates...&quot;
+		rc_status -v
+		;;
+	try-restart)
+		$0 status &gt;/dev/null &amp;&amp;  $0 restart
+		rc_status
+		;;
+	restart)
+		$0 stop
+		$0 start
+		rc_status
+		;;
+	*)
+		echo &quot;Usage: $0 {start|stop|try-restart|restart}&quot;
+		exit 1
+		;;
+esac
+rc_exit
+


Property changes on: kiwi-head/doc/examples/suse-ec2-guest/root/etc/init.d/amazon
___________________________________________________________________
Name: svn:executable
   + *

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/inittab
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/inittab	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/inittab	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,98 @@
+#
+# /etc/inittab
+#
+# Copyright (c) 1996-2002 SuSE Linux AG, Nuernberg, Germany.  All rights reserved.
+#
+# Author: Florian La Roche, 1996
+# Please send feedback to <A HREF="http://www.suse.de/feedback">http://www.suse.de/feedback</A>
+#
+# This is the main configuration file of /sbin/init, which
+# is executed by the kernel on startup. It describes what
+# scripts are used for the different run-levels.
+#
+# All scripts for runlevel changes are in /etc/init.d/.
+#
+# This file may be modified by SuSEconfig unless CHECK_INITTAB
+# in /etc/sysconfig/suseconfig is set to &quot;no&quot;
+#
+
+# The default runlevel is defined here
+id:5:initdefault:
+
+# First script to be executed, if not booting in emergency (-b) mode
+si::bootwait:/etc/init.d/boot
+
+# /etc/init.d/rc takes care of runlevel handling
+#
+# runlevel 0  is  System halt   (Do not use this for initdefault!)
+# runlevel 1  is  Single user mode
+# runlevel 2  is  Local multiuser without remote network (e.g. NFS)
+# runlevel 3  is  Full multiuser with network
+# runlevel 4  is  Not used
+# runlevel 5  is  Full multiuser with network and xdm
+# runlevel 6  is  System reboot (Do not use this for initdefault!)
+#
+l0:0:wait:/etc/init.d/rc 0
+l1:1:wait:/etc/init.d/rc 1
+l2:2:wait:/etc/init.d/rc 2
+l3:3:wait:/etc/init.d/rc 3
+#l4:4:wait:/etc/init.d/rc 4
+l5:5:wait:/etc/init.d/rc 5
+l6:6:wait:/etc/init.d/rc 6
+
+# what to do in single-user mode
+ls:S:wait:/etc/init.d/rc S
+~~:S:respawn:/sbin/sulogin
+
+# what to do when CTRL-ALT-DEL is pressed
+ca::ctrlaltdel:/sbin/shutdown -r -t 4 now
+
+# special keyboard request (Alt-UpArrow)
+# look into the kbd-0.90 docs for this
+kb::kbrequest:/bin/echo &quot;Keyboard Request -- edit /etc/inittab to let this work.&quot;
+
+# what to do when power fails/returns
+pf::powerwait:/etc/init.d/powerfail start
+pn::powerfailnow:/etc/init.d/powerfail now
+#pn::powerfail:/etc/init.d/powerfail now
+po::powerokwait:/etc/init.d/powerfail stop
+
+# for ARGO UPS
+sh:12345:powerfail:/sbin/shutdown -h now THE POWER IS FAILING
+
+# getty-programs for the normal runlevels
+# &lt;id&gt;:&lt;runlevels&gt;:&lt;action&gt;:&lt;process&gt;
+# The &quot;id&quot; field  MUST be the same as the last
+# characters of the device (after &quot;tty&quot;).
+1:2345:respawn:/sbin/mingetty --noclear tty1
+2:2345:respawn:/sbin/mingetty tty2
+3:2345:respawn:/sbin/mingetty tty3
+4:2345:respawn:/sbin/mingetty tty4
+5:2345:respawn:/sbin/mingetty tty5
+6:2345:respawn:/sbin/mingetty tty6
+#
+#S0:12345:respawn:/sbin/agetty -L 9600 ttyS0 vt102
+#cons:1235:respawn:/sbin/smart_agetty -L 38400 console
+
+#
+#  Note: Do not use tty7 in runlevel 3, this virtual line
+#  is occupied by the programm xdm.
+#
+
+#  This is for the package xdmsc, after installing and
+#  and configuration you should remove the comment character
+#  from the following line:
+#7:3:respawn:+/etc/init.d/rx tty7
+
+
+# modem getty.
+# mo:235:respawn:/usr/sbin/mgetty -s 38400 modem
+
+# fax getty (hylafax)
+# mo:35:respawn:/usr/lib/fax/faxgetty /dev/modem
+
+# vbox (voice box) getty
+# I6:35:respawn:/usr/sbin/vboxgetty -d /dev/ttyI6
+# I7:35:respawn:/usr/sbin/vboxgetty -d /dev/ttyI7
+
+# end of /etc/inittab

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/passwd
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/passwd	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/passwd	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,33 @@
+bin:x:1:1:bin:/bin:/bin/bash
+daemon:x:2:2:Daemon:/sbin:/bin/bash
+ftp:x:40:49:FTP account:/srv/ftp:/bin/bash
+games:x:12:100:Games account:/var/games:/bin/bash
+lp:x:4:7:Printing daemon:/var/spool/lpd:/bin/bash
+mail:x:8:12:Mailer daemon:/var/spool/clientmqueue:/bin/false
+nobody:x:65534:65533:nobody:/var/lib/nobody:/bin/bash
+root:x:0:0:root:/root:/bin/bash
+wwwrun:x:30:8:WWW daemon apache:/var/lib/wwwrun:/bin/false
+mdnsd:x:78:65534:mDNSResponder runtime user:/var/lib/mdnsd:/bin/false
+pop:x:67:100:POP admin:/var/lib/pop:/bin/false
+haldaemon:x:100:101:User for haldaemon:/var/run/hal:/bin/false
+mailman:x:72:67:GNU mailing list manager:/var/lib/mailman:/bin/bash
+dhcpd:x:101:65534:DHCP server daemon:/var/lib/dhcp:/bin/false
+sshd:x:71:65:SSH daemon:/var/lib/sshd:/bin/false
+man:x:13:62:Manual pages viewer:/var/cache/man:/bin/bash
+news:x:9:13:News system:/etc/news:/bin/bash
+uucp:x:10:14:Unix-to-Unix CoPy system:/etc/uucp:/bin/bash
+at:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bash
+named:x:44:44:Name server daemon:/var/lib/named:/bin/false
+messagebus:x:102:102:User for D-BUS:/var/run/dbus:/bin/false
+radiusd:x:103:103:Radius daemon:/var/lib/radiusd:/bin/false
+icecream:x:104:104:Icecream Daemon:/var/cache/icecream:/bin/false
+irc:x:39:65534:IRC daemon:/usr/lib/ircd:/bin/bash
+mysql:x:60:105:MySQL database admin:/var/lib/mysql:/bin/bash
+ldap:x:76:70:User for OpenLDAP:/var/lib/ldap:/bin/bash
+postfix:x:51:51:Postfix Daemon:/var/spool/postfix:/bin/false
+privoxy:x:105:106:Daemon user for privoxy:/var/lib/privoxy:/bin/false
+quagga:x:106:107:Quagga routing daemon:/var/run/quagga:/bin/false
+squid:x:31:65534:WWW-proxy squid:/var/cache/squid:/bin/false
+ntp:x:74:108:NTP daemon:/var/lib/ntp:/bin/false
+gdm:x:50:414:Gnome Display Manager daemon:/var/lib/gdm:/bin/false
++::::::

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/shadow
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/shadow	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/shadow	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,12 @@
+root:$2a$10$EzkAqKW0xEtQAnUb7gN/ne1XxycRNMbLQ0fVtKVZlmkR6a7rrxd42:13325::::::
+bin:*:13325::::::
+daemon:*:13325::::::
+lp:*:13325::::::
+mail:*:13325::::::
+news:*:13325::::::
+uucp:*:13325::::::
+games:*:13325::::::
+man:*:13325::::::
+wwwrun:*:13325::::::
+ftp:*:13325::::::
+nobody:*:13325::::::

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/config
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/config	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/config	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,236 @@
+## Path:	Network/Hardware/Config
+## Description:	Set some general network configuration
+## Type:	string(&quot;&quot;,&quot;-&quot;,&quot;+&quot;)
+## Default:	&quot;+&quot;
+## ServiceRestart: network
+#
+# DEFAULT_BROADCAST is used when no individual BROADCAST is set. It can get one
+# of the following values:
+# &quot;&quot;  : don't set a broadcast address
+# &quot;-&quot; : use IPADDR with all host bits deleted
+# &quot;+&quot; : use IPADDR with all host bits set
+DEFAULT_BROADCAST=&quot;+&quot;
+
+## Type:	yesno
+## Default:	yes
+# sometimes we want some script to be executed after an interface has been
+# brought up, or before an interface is taken down. 
+# default dir is /etc/sysconfig/network/if-up.d for POST_UP and
+# /etc/sysconfig/network/if-down.d for PRE_DOWN
+GLOBAL_POST_UP_EXEC=&quot;yes&quot;
+GLOBAL_PRE_DOWN_EXEC=&quot;yes&quot;
+
+## Type:        yesno
+## Default:     no
+# If ifup should check if an ip address is already in use, set this to yes.
+# Make sure that packet sockets (CONFIG_PACKET) are supported in the kernel,
+# since this feature uses arping, which depends on that.
+# Also be aware that this takes one second per interface; consider that when
+# setting up a lot of interfaces. 
+CHECK_DUPLICATE_IP=&quot;no&quot;
+
+## Type:        yesno
+## Default:     no
+# Switch on/off debug messages for all network configuration stuff. If set to no
+# most scripts can enable it locally with &quot;-o debug&quot;.
+DEBUG=&quot;no&quot;
+
+## Type:        yesno
+## Default:     yes
+# All error and info messages from network and hardware configuration scripts go
+# to stderr. Most tools that call sysconfig scripts (udev, rcnetwork, scpm,
+# YaST) catch these messages and can log them. So some messages appear twice in
+# syslog. If you don't like that, then set USE_SYSLOG=no.
+USE_SYSLOG=&quot;yes&quot;
+
+## Type:        yesno
+## Default:     yes
+# There are some services (ppp, ippp, dhcp-client, pcmcia, hotplug) that have to
+# change the /etc/resolv.conf dynamically at certain times.  E.g. if ppp/ippp
+# establishes a connection and is supplied by the peer with a list of
+# nameservers. Or pcmcia needs to set the correct nameserver for the choosen
+# configuration scheme. If you don't like these services to change
+# /etc/resolv.conf at all, then set this variable to &quot;no&quot;.
+# If unsure, leave it at the default (which is &quot;yes&quot;).
+#
+MODIFY_RESOLV_CONF_DYNAMICALLY=&quot;yes&quot;
+
+## Type:        yesno
+## Default:     no
+# Like MODIFY_RESOLV_CONF_DYNAMICALLY, except it modifies /etc/named.conf.
+# If unsure, leave it at the default (which is &quot;no&quot;).
+#
+MODIFY_NAMED_CONF_DYNAMICALLY=&quot;no&quot;
+
+# Handling of network connections
+# ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
+# These features are designed for the convenience of the experienced
+# user. If you encounter problems you don't understand then switch
+# them off. That is the default.
+# Please do not complain if you get troubles. But if you want help to
+# make them smarter write to &lt;<A HREF="http://www.suse.de/feedback">http://www.suse.de/feedback</A>&gt;.
+
+## Type:	yesno
+## Default:	no
+#
+# If you are interested in the connections and nfs mounts that use a
+# network interface, you can set CONNECTION_SHOW_WHEN_IFSTATUS=&quot;yes&quot;.
+# Then you will see them with 'ifstatus &lt;interface&gt;' (or 'ifstatus
+# &lt;config&gt;')
+# This one _should_ never harm ;)
+#
+CONNECTION_SHOW_WHEN_IFSTATUS=&quot;no&quot;
+
+## Type:	yesno
+## Default:	no
+#
+# If an interface should be set down only if there are no active
+# connections, then use CONNECTION_CHECK_BEFORE_IFDOWN=&quot;yes&quot;
+#
+CONNECTION_CHECK_BEFORE_IFDOWN=&quot;no&quot;
+
+## Type:	yesno
+## Default:	no
+#
+# If these connetions (without the nfs mounts) should be closed when
+# shutting down an interface, set CONNECTION_CLOSE_BEFORE_IFDOWN=&quot;yes&quot;.
+# WARNING: Be aware that this may terminate applications which need
+# one of these connections!
+#
+CONNECTION_CLOSE_BEFORE_IFDOWN=&quot;no&quot;
+
+## Type:	yesno
+## Default:	no
+#
+# If you are a mobile laptop user and like even nfs mounts to be
+# closed when you leave your current workplace, then set
+# CONNECTION_UMOUNT_NFS_BEFORE_IFDOWN=&quot;yes&quot;. This does only work
+# if CONNECTION_CLOSE_BEFORE_IFDOWN=&quot;yes&quot;, too.
+# WARNING: Be aware that this may terminate applications which use
+# these nfs mounts as working directory. Be very carefull if your home
+# is mounted via nfs!!!
+# WARNING: This may even lead to hanging ifdown processes if there are
+# processes that could not be terminated. If you are using
+# hotpluggable devices (pcmcia, usb, firewire), first shut them down
+# before unplugging!
+#
+CONNECTION_UMOUNT_NFS_BEFORE_IFDOWN=&quot;no&quot;
+
+## Type:	yesno
+## Default:	no
+#
+# If terminating processes that use a connection or nfs mount is not
+# enough, then they can be killed after an unsuccesfull termination.
+# If you want that set CONNECTION_SEND_KILL_SIGNAL=&quot;yes&quot;
+#
+CONNECTION_SEND_KILL_SIGNAL=&quot;no&quot;
+
+## Type:        string
+## Default:     &quot;&quot;
+#
+# Here you may specify which interfaces have to be up and configured properly
+# after 'rcnetwork start'. rcconfig will return 'failed' if any of these
+# interfaces is not up. You may use interface names as well but better use
+# hardware descriptions of the devices (eth-id-&lt;macaddress&gt; or eth-bus-...  See
+# man ifup for 'hardware description'). The network start script will wait for
+# these interfaces, but not longer as set in WAIT_FOR_INTERFACES.
+# You need not to add dialup or tunnel interfaces here, only physical devices.
+# The interface 'lo' is always considered to be mandatory and can be omitted.
+#
+# If this variable is empty, rcnetwork tries to derive the list of mandatory
+# devices automatically from the list of existing configurations. Configurations
+# with names bus-pcmcia or bus-usb or with STARTMODE=hotplug are skipped. (try
+# '/etc/init.d/rc5.d/S*network start -o debug fake | grep MANDAT')
+MANDATORY_DEVICES=&quot;&quot;
+
+## Type:	integer
+## Default:	20
+#
+# Some interfaces need some time to come up or come asynchronously via hotplug.
+# WAIT_FOR_INTERFACES is a global wait for all mandatory interfaces in
+# seconds. If empty no wait occurs.
+#
+WAIT_FOR_INTERFACES=&quot;20&quot;
+
+## Type:	yesno
+## Default:	yes
+#
+# With this variable you can determine if the SuSEfirewall when enabled
+# should get started when network interfaces are started.
+FIREWALL=&quot;yes&quot;
+
+## Type:        string
+## Default:     &quot;eth*[0-9]|tr*[0-9]|wlan[0-9]|ath[0-9]&quot;
+#
+# Automatically add a linklocal route to the matching interfaces.
+# This string is used in a bash &quot;case&quot; statement, so it may contain
+# '*', '[', ']'  and '|' meta-characters.
+#
+LINKLOCAL_INTERFACES=&quot;eth*[0-9]|tr*[0-9]|wlan[0-9]|ath[0-9]&quot;
+
+## Type:        string
+## Default:     &quot;-f -I&quot;
+#
+# Set default options for ifplugd. You may also set them in an ifcfg-* file
+# individually. Have a look at 'man ifplug' for details. We let ifplugd set the
+# interface UP when starting, because there are many interfaces where link beat
+# cannot be detected otherwise. If you want the interface to stay down then add
+# the option '-a'.
+#
+IFPLUGD_OPTIONS=&quot;-f -I&quot;
+
+## Type:        yesno
+## Default:     yes
+#
+# Forces all interfaces eth* ath* wlan* and ra* to be persistent via udev.
+# See /usr/share/doc/package/sysconfig/README.Persistent_Interface_Names for
+# details. 
+#
+FORCE_PERSISTENT_NAMES=yes
+
+## Type:        string
+## Default:     &quot;&quot;
+# If you need a special nameserver that should always be prepended to the list
+# of dynamically changed nameservers, you may add it here.
+#
+MODIFY_RESOLV_CONF_STATIC_DNS=&quot;&quot;
+
+## Type:        yesno
+## Default:     no
+#
+# Instead of the usual network setup (now called 'NetControl') you may also use
+# 'NetworkManager' to control your interfaces.
+#
+# NetControl is what you were used to in SUSE Linux up to now. It has a wide
+# range of configurations means for setting up any number of different virtual
+# and real interfaces. It should be used if you:
+# - want a static network setup
+# - have many interfaces
+# - need VLAN, bonding, bridging, multiple IP addresses
+# - must restrict network control to root
+# It may also switch interfaces automatically, but lacks a usable GUI for normal
+# users.
+#
+# NetworkManager lets the user control interfaces and switches automatically if
+# network interfaces lose/gain physical connection. It should be used if you:
+# - move between networks frequently
+# - want a GUI for network control
+# Especially on mobile computers that use mainly one wired and one wireless
+# interface NetworkManager will please you.
+#
+# If you are used to SCPM then you might probably stay with NetControl. But at
+# least try NetworkManager, because it can replace SCPM in some usage scenarios.
+# 
+NETWORKMANAGER=no
+
+## Type:        yesno
+## Default:     yes
+#
+# When using NetworkManager you may want to trigger special actions when an
+# interface comes up. NetworkManagerDispatcher is a daemon that listens to
+# dbus-messages that tell that an interface is up/down and triggers whatever
+# you like. Read more about it in the manpage to NetworkManagerDispatcher.
+#
+# This variable has no effect if NETWORKMANAGER=no
+#
+NM_DISPATCHER=yes

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/dhcp
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/dhcp	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/dhcp	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,21 @@
+DHCLIENT_DEBUG=&quot;no&quot;
+DHCLIENT_SET_HOSTNAME=&quot;yes&quot;
+DHCLIENT_MODIFY_RESOLV_CONF=&quot;yes&quot;
+DHCLIENT_SET_DEFAULT_ROUTE=&quot;yes&quot;
+DHCLIENT_MODIFY_NTP_CONF=&quot;no&quot;
+DHCLIENT_MODIFY_NIS_CONF=&quot;no&quot;
+DHCLIENT_SET_DOMAINNAME=&quot;no&quot;
+DHCLIENT_KEEP_SEARCHLIST=&quot;no&quot;
+DHCLIENT_LEASE_TIME=&quot;&quot;
+DHCLIENT_TIMEOUT=&quot;999999&quot;
+DHCLIENT_REBOOT_TIMEOUT=&quot;&quot;
+DHCLIENT_HOSTNAME_OPTION=&quot;AUTO&quot;
+DHCLIENT_CLIENT_ID=&quot;&quot;
+DHCLIENT_VENDOR_CLASS_ID=&quot;&quot;
+DHCLIENT_RELEASE_BEFORE_QUIT=&quot;no&quot;
+DHCLIENT_SCRIPT_EXE=&quot;&quot;
+DHCLIENT_ADDITIONAL_OPTIONS=&quot;&quot;
+DHCLIENT_SLEEP=&quot;0&quot;
+DHCLIENT_WAIT_AT_BOOT=&quot;15&quot;
+DHCLIENT_UDP_CHECKSUM=&quot;no&quot;
+DHCLIENT_MODIFY_SMB_CONF=&quot;yes&quot;

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-eth0
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-eth0	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-eth0	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,4 @@
+BOOTPROTO='dhcp'
+MTU=''
+REMOTE_IPADDR=''
+STARTMODE='onboot'

Added: kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-lo
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-lo	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest/root/etc/sysconfig/network/ifcfg-lo	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,7 @@
+# Loopback (lo) configuration
+IPADDR=127.0.0.1
+NETMASK=255.0.0.0
+NETWORK=127.0.0.0
+BROADCAST=127.255.255.255
+STARTMODE=onboot
+USERCONTROL=no

Added: kiwi-head/doc/examples/suse-ec2-guest.readme
===================================================================
--- kiwi-head/doc/examples/suse-ec2-guest.readme	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/doc/examples/suse-ec2-guest.readme	2008-07-23 12:13:22 UTC (rev 1476)
@@ -0,0 +1,93 @@
+KIWI Image Description Example
+==============================
+* An ec2 image is a xen image for the Amazon EC2 web service.
+  The image is a filesystem based image file which is turned into 
+  an Amazon bundle by using the Amazon provided tools. In order
+  to be able to create such an image your system must have the
+  Amazon tools installed. It is also required that you have
+  an Amazon web service account as well as an Amazon ec2 account.
+  Further information on the prerequirements can be found here:
+
+    <A HREF="http://docs.amazonwebservices.com/AmazonEC2/gsg/2006-06-26/">http://docs.amazonwebservices.com/AmazonEC2/gsg/2006-06-26/</A> 
+
+How to build this Example
+==============================
+* Open the file:
+
+     /usr/share/doc/packages/kiwi/examples/suse-ec2-guest/config.xml
+
+  and fill in your Amazon account information for:
+
+     a) ec2accountnr=&quot;EC2 User ID&quot;
+     b) ec2privatekeyfile=&quot;Path to EC2 private key file&quot;
+     c) ec2certfile=&quot;Path to EC2 public certificate file&quot;
+
+  If you are not sure how to get that information please refer
+  to the EC2 documentation at Amazon as shown in the link above
+
+  kiwi --prepare /usr/share/doc/packages/kiwi/examples/suse-ec2-guest \
+       --root /tmp/myec2
+
+  kiwi --create /tmp/myec2 --type ec2 -d /tmp/myec2-result
+
+How to test this Example
+==============================
+* In order to test this example you need to upload and register the
+  generated image (bundle in Amazon terminology) first. How to do that
+  is also explained more detailed in the Amazon documentation:
+
+  ec2-upload-bundle -b &lt;your-bucket&gt; \
+    -a &lt;AWS Key ID&gt; -s &lt;AWS secret Key ID&gt; \
+    -m /tmp/myec2-result/suse-11.0-ec2-guest.i686-1.1.2.ami.manifest.xml
+
+  ec2-register &lt;your-bucket&gt;/suse-11.0-ec2-guest.i686-1.1.2.ami.manifest.xml
+
+  After that you got an Amazon ID (ami) for your image which you need
+  later to run the instance.
+  
+* Next you need to create a private/public key pair for later key
+  based access to your image
+
+  ec2-add-keypair your-gsg-keypair
+
+  The private key returned needs to be saved in a local file so that
+  you can use it later. Using your favorite text editor, create a file
+  named id_rsa-your-gsg-keypair and paste everything between
+  (and including) the &quot;-----BEGIN RSA PRIVATE KEY-----&quot; and
+  &quot;-----END RSA PRIVATE KEY-----&quot; lines into it.
+
+* Last step is to run the instance with a specific kernel and initrd.
+  The kernel and initrd images have already been provided by SUSE and
+  can only be maintained and uploaded to Amazon by a trusted party.
+  For openSUSE 11.0 I have created that images with the following
+  reference ID's
+
+  ari-fc8e6a95    =&gt; initrd image for openSUSE 11.0
+  aki-fe8e6a97    =&gt; kernel image for openSUSE 11.0 
+
+  Run your image by calling:
+
+  ec2-run-instances ami-... \
+      --kernel  aki-fe8e6a97 \
+      --ramdisk ari-fc8e6a95 \
+      -k your-gsg-keypair
+
+  You can check the machine state by calling:
+
+  ec2-describe-instances
+
+  The output of the command will tell you the name of the machine if
+  everything went ok. If you can see that information you are able to
+  ssh into your new ami. If you can't you should check if you allowed
+  port 22 to be used with your account: 
+
+  ec2-authorize default -p 22
+  
+  Login and feel happy :-)
+ 
+Login Details
+==============================
+* User root pwd: linux
+* Or as suggested in the Amazon documentation with
+  your private key file
+

Modified: kiwi-head/rpm/kiwi.changes
===================================================================
--- kiwi-head/rpm/kiwi.changes	2008-07-23 10:36:15 UTC (rev 1475)
+++ kiwi-head/rpm/kiwi.changes	2008-07-23 12:13:22 UTC (rev 1476)
@@ -2,6 +2,7 @@
 Wed Jul 23 11:49:05 CEST 2008 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 
 - v2.60
+- added ec2 example for suse 11.0: suse-ec2-guest (bnc #367138)
 - fixed KIWIMigrate according to current scheme (bnc #411088)
 - allow redirection of the log messages to a console set
   by the kernel parameter kiwistderr=... (bnc #411304)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000559.html">[Kiwi-devel] r1475 - in kiwi-head: modules rpm
</A></li>
	<LI>Next message: <A HREF="000561.html">[Kiwi-devel] kiwi goes Amazon :-)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#560">[ date ]</a>
              <a href="thread.html#560">[ thread ]</a>
              <a href="subject.html#560">[ subject ]</a>
              <a href="author.html#560">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
