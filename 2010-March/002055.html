<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3974a153125f65658769be8b7c95b378e86a15e4
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2010-March/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%203974a153125f65658769be8b7c95b378e86a15e4&In-Reply-To=%3C201003221021.o2MAL0kt003474%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002054.html">
   <LINK REL="Next"  HREF="002056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3974a153125f65658769be8b7c95b378e86a15e4</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%203974a153125f65658769be8b7c95b378e86a15e4&In-Reply-To=%3C201003221021.o2MAL0kt003474%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 3974a153125f65658769be8b7c95b378e86a15e4">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Mon Mar 22 11:21:00 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002054.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 343150163c7ce880807d0f9592a3e8a205ce97dc
</A></li>
        <LI>Next message: <A HREF="002056.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. e1ba8a20595f207e04edbb42b46ecb2207d411ce
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2055">[ date ]</a>
              <a href="thread.html#2055">[ thread ]</a>
              <a href="subject.html#2055">[ subject ]</a>
              <a href="author.html#2055">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  3974a153125f65658769be8b7c95b378e86a15e4 (commit)
      from  343150163c7ce880807d0f9592a3e8a205ce97dc (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 3974a153125f65658769be8b7c95b378e86a15e4
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Mon Mar 22 11:20:50 2010 +0100

    - v4.25
    - added bootnext program which implements a small boot loader
      needed for the 'boot from hard disk' menu entry on usb media.
      It basically loads the mbr from the first drive that is
      not the usb stick. Thanks to Steffen Winterfeldt who
      implemented this (bnc #583212)

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/LaTex/Revision.txt b/doc/LaTex/Revision.txt
index 928fd02..658b9bf 100644
--- a/doc/LaTex/Revision.txt
+++ b/doc/LaTex/Revision.txt
@@ -1 +1 @@
-4.23
\ No newline at end of file
+4.25
\ No newline at end of file
diff --git a/doc/kiwi-man/KIWI::config.sh.1 b/doc/kiwi-man/KIWI::config.sh.1
index 33659d1..7969397 100644
--- a/doc/kiwi-man/KIWI::config.sh.1
+++ b/doc/kiwi-man/KIWI::config.sh.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::config.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 03/15/2010
+.\&quot;      Date: Created: 03/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 03/15/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::CONFIG\&amp;.SH&quot; &quot;1&quot; &quot;Created: 03/22/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/KIWI::images.sh.1 b/doc/kiwi-man/KIWI::images.sh.1
index 9c17804..b6838f8 100644
--- a/doc/kiwi-man/KIWI::images.sh.1
+++ b/doc/kiwi-man/KIWI::images.sh.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi::images.sh
 .\&quot;    Author: Marcus Sch&#195;&#164;fer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 03/15/2010
+.\&quot;      Date: Created: 03/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 03/15/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI::IMAGES\&amp;.SH&quot; &quot;1&quot; &quot;Created: 03/22/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi-man/kiwi.1 b/doc/kiwi-man/kiwi.1
index 6c86099..2f6a0cb 100644
--- a/doc/kiwi-man/kiwi.1
+++ b/doc/kiwi-man/kiwi.1
@@ -1,12 +1,12 @@
 .\&quot;     Title: kiwi
 .\&quot;    Author: Marcus Schaefer &lt;ms (AT) suse.de&gt;
 .\&quot; Generator: DocBook XSL Stylesheets v1.74.0 &lt;<A HREF="http://docbook.sf.net/">http://docbook.sf.net/</A>&gt;
-.\&quot;      Date: Created: 03/15/2010
+.\&quot;      Date: Created: 03/22/2010
 .\&quot;    Manual: KIWI Manualpage
 .\&quot;    Source: KIWI v3.65
 .\&quot;  Language: English
 .\&quot;
-.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/15/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
+.TH &quot;KIWI&quot; &quot;1&quot; &quot;Created: 03/22/2010&quot; &quot;KIWI v3\&amp;.65&quot; &quot;KIWI Manualpage&quot;
 .\&quot; -----------------------------------------------------------------
 .\&quot; * (re)Define some macros
 .\&quot; -----------------------------------------------------------------
diff --git a/doc/kiwi.pdf b/doc/kiwi.pdf
index 57c9088..2da08cb 100644
Binary files a/doc/kiwi.pdf and b/doc/kiwi.pdf differ
diff --git a/kiwi.pl b/kiwi.pl
index f227d97..5e05a98 100755
--- a/kiwi.pl
+++ b/kiwi.pl
@@ -45,7 +45,7 @@ use KIWITest;
 #============================================
 # Globals (Version)
 #--------------------------------------------
-our $Version       = &quot;4.24&quot;;
+our $Version       = &quot;4.25&quot;;
 our $Publisher     = &quot;SUSE LINUX Products GmbH&quot;;
 our $Preparer      = &quot;KIWI - <A HREF="http://kiwi.berlios.de">http://kiwi.berlios.de</A>&quot;;
 our $openSUSE      = &quot;<A HREF="http://download.opensuse.org">http://download.opensuse.org</A>&quot;;
diff --git a/modules/KIWIBoot.pm b/modules/KIWIBoot.pm
index a018da4..cd83f49 100644
--- a/modules/KIWIBoot.pm
+++ b/modules/KIWIBoot.pm
@@ -3716,9 +3716,18 @@ sub setupBootLoaderConfiguration {
 		} elsif ($type =~ /^KIWI USB/) {
 			print FD &quot;gfxmenu (hd0,0)/boot/message\n&quot;;
 			print FD &quot;title Boot from Hard Disk\n&quot;;
-			print FD &quot; chainloader (hd0)+1\n&quot;;
+			print FD &quot; chainloader (hd0,0)/boot/grub/bootnext\n&quot;;
 			$title = $this -&gt; makeLabel (&quot;Install/Restore $label&quot;);
 			print FD &quot;title $title\n&quot;;
+			my $bootnext = $this -&gt; addBootNext (
+				&quot;$tmpdir/boot/grub/bootnext&quot;, hex $this-&gt;{mbrid}
+			);
+			if (! defined $bootnext) {
+				$kiwi -&gt; failed ();
+				$kiwi -&gt; error  (&quot;Failed to write bootnext\n&quot;);
+				$kiwi -&gt; failed ();
+				return undef;
+			}
 		} else {
 			$title = $this -&gt; makeLabel (&quot;$label [ $type ]&quot;);
 			print FD &quot;gfxmenu (hd0,$bootpart)/boot/message\n&quot;;
@@ -4929,4 +4938,64 @@ sub setupFilesystem {
 	return $this;
 }
 
+#==========================================
+# addBootNext
+#------------------------------------------
+sub addBootNext {
+	# ...
+	# Write boot program that boots the firsts drive that
+	# does _not_ have our mbr id. The boot program source which
+	# creates $bootnext below is added in the git repo below
+	# tools/bootnext
+	# ---
+	my $this = shift;
+	my $file = shift;
+	my $id   = shift;
+	my $bn;
+	my $bootnext =
+		&quot;\x8c\xc8\x8e\xd0\x31\xe4\x8e\xd8\x8e\xc0\xfc\xfb\xbe\x00\x7c\xbf&quot; .
+		&quot;\x00\x60\xb9\x00\x01\xf3\xa5\xea\x1c\x60\x00\x00\xb4\x08\x31\xff&quot; .
+		&quot;\xb2\x80\xcd\x13\x73\x02\xb2\x01\x80\xfa\x01\xb0\x80\x10\xc2\x88&quot; .
+		&quot;\x16\x29\x61\xa2\x2a\x61\xe8\x8b\x00\x73\x10\xa0\x2a\x61\x40\x3a&quot; .
+		&quot;\x06\x29\x61\x72\xee\xbe\x2d\x61\xe9\xb3\x00\x80\x3e\x2a\x61\x80&quot; .
+		&quot;\x74\x03\xe8\x07\x00\xb2\x80\xea\x00\x7c\x00\x00\xa1\x13\x04\x48&quot; .
+		&quot;\xa3\x13\x04\xc1\xe0\x06\x2d\x00\x06\x66\x8b\x16\x4c\x00\x66\x89&quot; .
+		&quot;\x16\x25\x61\x50\x68\x89\x60\x66\x8f\x06\x4c\x00\x50\x07\xbe\x00&quot; .
+		&quot;\x60\x89\xf7\xb9\x00\x01\xf3\xa5\xc3\x9c\x2e\x88\x16\x2b\x61\x2e&quot; .
+		&quot;\x88\x26\x2c\x61\x2e\x3a\x16\x2a\x61\x75\x04\xb2\x80\xeb\x0a\x80&quot; .
+		&quot;\xfa\x80\x75\x05\x2e\x8a\x16\x2a\x61\x2e\xff\x1e\x25\x61\x50\x9f&quot; .
+		&quot;\x67\x88\x64\x24\x06\x58\x2e\x80\x3e\x2c\x61\x08\x74\x05\x2e\x8a&quot; .
+		&quot;\x16\x2b\x61\xcf\xe8\x10\x00\x72\x0d\x66\xa1\xb8\x61\x66\x3b\x06&quot; .
+		&quot;\xb8\x7d\xf9\x74\x01\xf8\xc3\xb8\x01\x02\xb9\x01\x00\xb6\x00\x8a&quot; .
+		&quot;\x16\x2a\x61\xbb\x00\x7c\xcd\x13\x72\x13\x66\x83\x3e\x00\x7c\x00&quot; .
+		&quot;\xf9\x74\x0a\x81\x3e\xfe\x7d\x55\xaa\xf9\x75\x01\xf8\xc3\xe8\x15&quot; .
+		&quot;\x00\xbe\x44\x61\xe8\x0f\x00\xb4\x00\xcd\x16\xbe\x41\x61\xe8\x05&quot; .
+		&quot;\x00\xcd\x19\xf4\xeb\xfd\xac\x08\xc0\x74\x09\xbb\x07\x00\xb4\x0e&quot; .
+		&quot;\xcd\x10\xeb\xf2\xc3\x00\x00\x00\x00\x00\x00\x00\x00\x4e\x6f\x20&quot; .
+		&quot;\x6f\x70\x65\x72\x61\x74\x69\x6e\x67\x20\x73\x79\x73\x74\x65\x6d&quot; .
+		&quot;\x2e\x0d\x0a\x00\x0a\x50\x72\x65\x73\x73\x20\x61\x20\x6b\x65\x79&quot; .
+		&quot;\x20\x74\x6f\x20\x72\x65\x62\x6f\x6f\x74\x2e\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
+		&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x55\xaa&quot;;
+
+	# we really need a valid id
+	return undef unless $id;
+
+	substr $bootnext, 0x1b8, 4, pack(&quot;V&quot;, $id);
+
+	open $bn, &quot;&gt;$file&quot; or return undef;
+	print $bn $bootnext;
+	close $bn;
+
+	return $this;
+}
+
 1; 
diff --git a/rpm/kiwi.changes b/rpm/kiwi.changes
index 025829b..f9b4100 100644
--- a/rpm/kiwi.changes
+++ b/rpm/kiwi.changes
@@ -1,4 +1,14 @@
 -------------------------------------------------------------------
+Mon Mar 22 11:16:53 CET 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
+
+- v4.25
+- added bootnext program which implements a small boot loader
+  needed for the 'boot from hard disk' menu entry on usb media.
+  It basically loads the mbr from the first drive that is
+  not the usb stick. Thanks to Steffen Winterfeldt who
+  implemented this (bnc #583212)
+
+-------------------------------------------------------------------
 Fri Mar 19 12:09:46 CET 2010 - <A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at suse.de</A>
 
 - v4.24
diff --git a/rpm/kiwi.spec b/rpm/kiwi.spec
index 0d4d893..ab357aa 100644
--- a/rpm/kiwi.spec
+++ b/rpm/kiwi.spec
@@ -1,5 +1,5 @@
 #
-# spec file for package kiwi (Version 4.24)
+# spec file for package kiwi (Version 4.25)
 #
 # Copyright (c) 2008 SUSE LINUX Products GmbH, Nuernberg, Germany.
 # This file and all modifications and additions to the pristine
@@ -52,7 +52,7 @@ Requires:       satsolver-tools
 Requires:       clicfs
 %endif
 Summary:        OpenSuSE - KIWI Image System
-Version:        4.24
+Version:        4.25
 Release:        80
 Group:          System/Management
 License:        GPL v2 or later
diff --git a/tools/bootnext/Makefile b/tools/bootnext/Makefile
new file mode 100644
index 0000000..a0d20b0
--- /dev/null
+++ b/tools/bootnext/Makefile
@@ -0,0 +1,8 @@
+all: bootnext
+
+bootnext: bootnext.asm
+	nasm -O99 -f bin -l $@.lst -o $@ $&lt;
+
+clean:
+	rm -f *~ bootnext *.lst
+
diff --git a/tools/bootnext/README b/tools/bootnext/README
new file mode 100644
index 0000000..46cb578
--- /dev/null
+++ b/tools/bootnext/README
@@ -0,0 +1,8 @@
+A small boot loader needed for the 'boot from hard disk' menu entry on usb
+media. It basically loads the mbr from the first drive that is not the usb
+stick.
+
+There's no real need to reassemble; it is already included in
+KIWIBoot.pm::addBootNext() in binary form. The code is here mostly for
+reference.
+
diff --git a/tools/bootnext/bootnext.asm b/tools/bootnext/bootnext.asm
new file mode 100644
index 0000000..e053412
--- /dev/null
+++ b/tools/bootnext/bootnext.asm
@@ -0,0 +1,239 @@
+;
+; bootnext.asm
+;
+; A small boot program that boots the first local disk that does not have
+; the same id (4 bytes at offset 1b8h) as 'bootnext'.
+;
+; Copyright (c) 2010 Steffen Winterfeldt.
+;
+; Licensed under GPL2; for details see file LICENSE.
+;
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+			bits 16
+
+disk_buf		equ 7c00h
+mbr_start		equ 6000h
+id_ofs			equ  1b8h
+
+			section .text
+
+			org mbr_start
+
+			mov ax,cs
+			mov ss,ax
+			xor sp,sp
+			mov ds,ax
+			mov es,ax
+			cld
+			sti
+
+			; move us out of the way
+			mov si,disk_buf
+			mov di,mbr_start
+			mov cx,100h
+			rep movsw
+			jmp 0:main_10
+
+main_10:
+			; look at all drives in turn until we find one with
+			; a non-matching id
+			mov ah,8
+			xor di,di
+			mov dl,80h
+			int 13h
+			jnc main_20
+			mov dl,1		; we'll try at least one
+main_20:
+			cmp dl,1		; dto
+			mov al,80h
+			adc dl,al
+			mov [bios_drives],dl
+
+main_30:
+			mov [drive],al
+			call check
+			jnc main_60
+			mov al,[drive]
+			inc ax
+			cmp al,[bios_drives]
+			jb main_30
+
+			mov si,msg_no_os
+			jmp final_msg
+main_60:
+			cmp byte [drive],80h
+			jz main_70
+			call relocate
+main_70:			
+			; continue with MBR
+			mov dl,80h
+			jmp 0:disk_buf
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+; Copy us to top of memory and install new int 13h interrupt handler.
+;
+relocate:
+			mov ax,[413h]		; mem size in kB
+			dec ax			; reserve 1k
+			mov [413h],ax
+			shl ax,6
+			sub ax,mbr_start &gt;&gt; 4
+			mov edx,[13h*4]
+			mov [old_int13],edx
+			push ax
+			push word new_int13
+			pop dword [13h*4]
+			push ax
+			pop es
+			mov si,mbr_start
+			mov di,si
+			mov cx,100h
+			rep movsw
+			ret
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+; Swap drives 80h and [drive].
+;
+new_int13:
+			pushf
+
+			mov [cs:dl_old],dl
+			mov [cs:ah_old],ah
+
+			cmp dl,[cs:drive]
+			jnz new_int13_20
+			mov dl,80h
+			jmp new_int13_50
+new_int13_20:
+			cmp dl,80h
+			jnz new_int13_50
+			mov dl,[cs:drive]
+new_int13_50:
+			call far [cs:old_int13]
+			push ax
+			lahf
+			mov [esp+6],ah
+			pop ax
+
+			; ah = 8 changes dl; otherwise restore value
+			cmp byte [cs:ah_old],8
+			jz new_int13_90
+			mov dl,[cs:dl_old]
+new_int13_90:
+			iret
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+; Read MBR and check id (id should _not_ match).
+;
+; return:
+;   CF:		0 ok; 1 not
+;
+check:
+			call disk_read
+			jc check_90
+			mov eax,[magic_id]
+			cmp eax,[disk_buf+id_ofs]
+			stc
+			jz check_90
+			clc
+check_90:
+			ret
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+; Read MBR and verify boot signature.
+;
+; return:
+;   CF:		0 ok; 1 not
+;
+disk_read:
+			mov ax,201h
+			mov cx,1
+			mov dh,0
+			mov dl,[drive]
+			mov bx,disk_buf
+			int 13h
+			jc disk_read_90
+			; there should be proper boot code
+			cmp dword [disk_buf],0
+			stc
+			jz disk_read_90
+			cmp word [disk_buf+1feh],0aa55h
+			stc
+			jnz disk_read_90
+			clc
+disk_read_90:
+			ret
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+; Write string and let user reboot.
+;
+;  si			text
+;
+; return:
+;
+final_msg:
+			call print
+			mov si,msg_next
+			call print
+			mov ah,0
+			int 16h
+			mov si,msg_nl
+			call print
+			int 19h
+
+final_msg_10:
+			hlt
+			jmp final_msg_10
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+; Write string.
+;
+;  si			text
+;
+; return:
+;
+print:
+			lodsb
+			or al,al
+			jz print_90
+			mov bx,7
+			mov ah,14
+			int 10h
+			jmp print
+print_90:
+			ret
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+old_int13		dd 0
+bios_drives		db 0
+drive			db 0
+dl_old			db 0
+ah_old			db 0
+
+msg_no_os		db &quot;No operating system.&quot;
+msg_nl			db 13, 10
+msg_no_msg		db 0
+msg_next		db 10, &quot;Press a key to reboot.&quot;, 0
+
+
+; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
+%if ($ - $$) &gt; id_ofs
+%error &quot;mbr too big&quot;
+%endif
+
+			times id_ofs - ($ - $$) db 0
+
+magic_id		dd 0
+
+			times 1feh - ($ - $$) db 0
+			dw 0aa55h
+


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002054.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 343150163c7ce880807d0f9592a3e8a205ce97dc
</A></li>
	<LI>Next message: <A HREF="002056.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. e1ba8a20595f207e04edbb42b46ecb2207d411ce
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2055">[ date ]</a>
              <a href="thread.html#2055">[ thread ]</a>
              <a href="subject.html#2055">[ subject ]</a>
              <a href="author.html#2055">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
