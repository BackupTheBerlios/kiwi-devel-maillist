<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 10fc63733df57b0d0b145a0c34a4859d986ba412
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/kiwi-devel/2011-May/index.html" >
   <LINK REL="made" HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%2010fc63733df57b0d0b145a0c34a4859d986ba412&In-Reply-To=%3C20110503073847.2CBA84813D0%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003370.html">
   <LINK REL="Next"  HREF="003374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 10fc63733df57b0d0b145a0c34a4859d986ba412</H1>
    <B>marcus_schaefer at BerliOS</B> 
    <A HREF="mailto:kiwi-devel%40lists.berlios.de?Subject=Re%3A%20%5BKiwi-devel%5D%20%5BGit%5DProject%20kiwi%20at%20BerliOS%20branch%2C%20master%2C%0A%09updated.%2010fc63733df57b0d0b145a0c34a4859d986ba412&In-Reply-To=%3C20110503073847.2CBA84813D0%40sheep.berlios.de%3E"
       TITLE="[Kiwi-devel] [Git]Project kiwi at BerliOS branch, master,	updated. 10fc63733df57b0d0b145a0c34a4859d986ba412">marcus_schaefer at mail.berlios.de
       </A><BR>
    <I>Tue May  3 09:38:46 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003370.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-485-SuSE-11-1-SLE-SP-Devel,	updated. 406af3361a84477908cb8ed861f6ecc3e019afe0
</A></li>
        <LI>Next message: <A HREF="003374.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-485-SuSE-11-1-SLE-SP-Devel,	updated. 84d14e8e1384b050cac0c09c2b591697358a7b8a
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3371">[ date ]</a>
              <a href="thread.html#3371">[ thread ]</a>
              <a href="subject.html#3371">[ subject ]</a>
              <a href="author.html#3371">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is an automated email from the git hooks/post-receive script. It was
generated because a ref change was pushed to the repository containing
the project &quot;Project kiwi at BerliOS&quot;.

The branch, master has been updated
       via  10fc63733df57b0d0b145a0c34a4859d986ba412 (commit)
       via  646b2fd26cf3dc881398554b8e7e60243b0600f0 (commit)
      from  16504163b37d2a38b56b2757216559bf4400c3e7 (commit)

Those revisions listed above that are new to this repository have
not appeared on any other notification email; so we list those
revisions in full, below.

- Log -----------------------------------------------------------------
commit 10fc63733df57b0d0b145a0c34a4859d986ba412
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Tue May 3 09:36:14 2011 +0200

    - DB: update documentation, FORCE_KEXEC feature (bnc #691247)

commit 646b2fd26cf3dc881398554b8e7e60243b0600f0
Author: Marcus Sch&#195;&#164;fer &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/kiwi-devel">ms at novell.com</A>&gt;
Date:   Tue May 3 09:35:06 2011 +0200

    - added support for FORCE_KEXEC in kernelCheck function which
      allows to force the kexec call even if the kernel versions
      are the same (bnc #691247)

-----------------------------------------------------------------------

Summary of changes:
diff --git a/doc/docbook/kiwi-doc-pxe.xml b/doc/docbook/kiwi-doc-pxe.xml
index e38e3d2..b4313ed 100644
--- a/doc/docbook/kiwi-doc-pxe.xml
+++ b/doc/docbook/kiwi-doc-pxe.xml
@@ -466,6 +466,32 @@ RAID=1;/dev/sda;/dev/sdb
                 &gt;/dev/hda&lt;/filename&gt;. &lt;/para&gt;
           &lt;/listitem&gt;
         &lt;/varlistentry&gt;
+		&lt;varlistentry&gt;
+		  &lt;term&gt;&lt;varname&gt;REBOOT_IMAGE&lt;/varname&gt;&lt;/term&gt;
+          &lt;listitem&gt;
+            &lt;para&gt;If set to a non-empty string, this will reboot the
+			  system after the initial deployment process is done.
+              This means before the system init process is activated
+              the system is rebooted. If the machine's default boot
+              setup is to boot via PXE it will again boot from the
+			  network.
+            &lt;/para&gt;
+          &lt;/listitem&gt;
+        &lt;/varlistentry&gt;
+		&lt;varlistentry&gt;
+          &lt;term&gt;&lt;varname&gt;FORCE_KEXEC&lt;/varname&gt;&lt;/term&gt;
+          &lt;listitem&gt;
+            &lt;para&gt;During the initial deployment process kiwi checks
+              if the running kernel is the same as the kernel installed
+              via the system image. If there is a mismatch kiwi activates
+              the installed kernel by calling kexec. This is mostly the
+              same as to perform a reboot but without the need of the
+              BIOS or any bootloader. If FORCE_KEXEC is set to a non-empty
+              string kiwi will also perform kexec if the kernel versions
+              matches.
+            &lt;/para&gt;
+          &lt;/listitem&gt;
+        &lt;/varlistentry&gt;
         &lt;varlistentry&gt;
           &lt;term&gt;&lt;varname&gt;RELOAD_IMAGE&lt;/varname&gt;&lt;/term&gt;
           &lt;listitem&gt;
diff --git a/modules/KIWILinuxRC.sh b/modules/KIWILinuxRC.sh
index 7e4b1e2..862a7de 100644
--- a/modules/KIWILinuxRC.sh
+++ b/modules/KIWILinuxRC.sh
@@ -2538,10 +2538,20 @@ function kernelCheck {
 			break
 		fi
 	done
-	if [ $kreboot = 0 ];then
-		return
+	#======================================
+	# check for forced reboot
+	#--------------------------------------
+	if [ ! -z &quot;$FORCE_KEXEC&quot; ];then
+		kreboot=2
 	fi
-	Echo &quot;Kernel versions do not match...&quot;
+	#======================================
+	# evaluate kreboot condition
+	#--------------------------------------
+	case $kreboot in
+		1) Echo &quot;Kernel versions do not match...&quot; ;;
+		2) Echo &quot;kexec based reboot forced...&quot; ;;
+		0) return ;;
+	esac
 	#======================================
 	# trigger reboot if kexec doesn't exist
 	#--------------------------------------


hooks/post-receive
-- 
Project kiwi at BerliOS

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003370.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-485-SuSE-11-1-SLE-SP-Devel,	updated. 406af3361a84477908cb8ed861f6ecc3e019afe0
</A></li>
	<LI>Next message: <A HREF="003374.html">[Kiwi-devel] [Git]Project kiwi at BerliOS branch,	KIWI-485-SuSE-11-1-SLE-SP-Devel,	updated. 84d14e8e1384b050cac0c09c2b591697358a7b8a
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3371">[ date ]</a>
              <a href="thread.html#3371">[ thread ]</a>
              <a href="subject.html#3371">[ subject ]</a>
              <a href="author.html#3371">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/kiwi-devel">More information about the Kiwi-devel
mailing list</a><br>
</body></html>
